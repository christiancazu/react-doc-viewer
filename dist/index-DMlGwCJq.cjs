"use strict";var My=Object.defineProperty;var Dy=(r,t,e)=>t in r?My(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var ct=(r,t,e)=>(Dy(r,typeof t!="symbol"?t+"":t,e),e),Ff=(r,t,e)=>{if(!t.has(r))throw TypeError("Cannot "+e)};var o=(r,t,e)=>(Ff(r,t,"read from private field"),e?e.call(r):t.get(r)),m=(r,t,e)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,e)},w=(r,t,e,i)=>(Ff(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e);var Be=(r,t,e,i)=>({set _(n){w(r,t,n,e)},get _(){return o(r,t,i)}}),A=(r,t,e)=>(Ff(r,t,"access private method"),e);const I=require("react/jsx-runtime"),z=require("react"),ht=require("styled-components");var Xr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dg(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Oy(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}),e}var _o=function(r){return r&&r.Math===Math&&r},Hi=_o(typeof globalThis=="object"&&globalThis)||_o(typeof window=="object"&&window)||_o(typeof self=="object"&&self)||_o(typeof Xr=="object"&&Xr)||_o(typeof Xr=="object"&&Xr)||function(){return this}()||Function("return this")(),Og={},ds=function(r){try{return!!r()}catch{return!0}},Ny=ds,Mr=!Ny(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),By=ds,g0=!By(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),$y=g0,Ph=Function.prototype.call,Ng=$y?Ph.bind(Ph):function(){return Ph.apply(Ph,arguments)},m0={},v0={}.propertyIsEnumerable,b0=Object.getOwnPropertyDescriptor,jy=b0&&!v0.call({1:2},1);m0.f=jy?function(t){var e=b0(this,t);return!!e&&e.enumerable}:v0;var y0=function(r,t){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:t}},w0=g0,A0=Function.prototype,ap=A0.call,Uy=w0&&A0.bind.bind(ap,ap),kn=w0?Uy:function(r){return function(){return ap.apply(r,arguments)}},E0=kn,Hy=E0({}.toString),zy=E0("".slice),Gy=function(r){return zy(Hy(r),8,-1)},Vy=kn,Wy=ds,qy=Gy,Mf=Object,Xy=Vy("".split),Yy=Wy(function(){return!Mf("z").propertyIsEnumerable(0)})?function(r){return qy(r)==="String"?Xy(r,""):Mf(r)}:Mf,_0=function(r){return r==null},Ky=_0,Zy=TypeError,x0=function(r){if(Ky(r))throw new Zy("Can't call method on "+r);return r},Jy=Yy,Qy=x0,Bg=function(r){return Jy(Qy(r))},Df=typeof document=="object"&&document.all,zi=typeof Df>"u"&&Df!==void 0?function(r){return typeof r=="function"||r===Df}:function(r){return typeof r=="function"},tw=zi,gh=function(r){return typeof r=="object"?r!==null:tw(r)},Of=Hi,ew=zi,iw=function(r){return ew(r)?r:void 0},S0=function(r,t){return arguments.length<2?iw(Of[r]):Of[r]&&Of[r][t]},nw=kn,sw=nw({}.isPrototypeOf),rw=typeof navigator<"u"&&String(navigator.userAgent)||"",C0=Hi,Nf=rw,hm=C0.process,dm=C0.Deno,um=hm&&hm.versions||dm&&dm.version,fm=um&&um.v8,mi,dd;fm&&(mi=fm.split("."),dd=mi[0]>0&&mi[0]<4?1:+(mi[0]+mi[1]));!dd&&Nf&&(mi=Nf.match(/Edge\/(\d+)/),(!mi||mi[1]>=74)&&(mi=Nf.match(/Chrome\/(\d+)/),mi&&(dd=+mi[1])));var aw=dd,pm=aw,ow=ds,lw=Hi,cw=lw.String,T0=!!Object.getOwnPropertySymbols&&!ow(function(){var r=Symbol("symbol detection");return!cw(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&pm&&pm<41}),hw=T0,P0=hw&&!Symbol.sham&&typeof Symbol.iterator=="symbol",dw=S0,uw=zi,fw=sw,pw=P0,gw=Object,R0=pw?function(r){return typeof r=="symbol"}:function(r){var t=dw("Symbol");return uw(t)&&fw(t.prototype,gw(r))},mw=String,vw=function(r){try{return mw(r)}catch{return"Object"}},bw=zi,yw=vw,ww=TypeError,L0=function(r){if(bw(r))return r;throw new ww(yw(r)+" is not a function")},Aw=L0,Ew=_0,_w=function(r,t){var e=r[t];return Ew(e)?void 0:Aw(e)},Bf=Ng,$f=zi,jf=gh,xw=TypeError,Sw=function(r,t){var e,i;if(t==="string"&&$f(e=r.toString)&&!jf(i=Bf(e,r))||$f(e=r.valueOf)&&!jf(i=Bf(e,r))||t!=="string"&&$f(e=r.toString)&&!jf(i=Bf(e,r)))return i;throw new xw("Can't convert object to primitive value")},k0={exports:{}},gm=Hi,Cw=Object.defineProperty,$g=function(r,t){try{Cw(gm,r,{value:t,configurable:!0,writable:!0})}catch{gm[r]=t}return t},Tw=Hi,Pw=$g,mm="__core-js_shared__",vm=k0.exports=Tw[mm]||Pw(mm,{});(vm.versions||(vm.versions=[])).push({version:"3.37.1",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"});var jg=k0.exports,bm=jg,I0=function(r,t){return bm[r]||(bm[r]=t||{})},Rw=x0,Lw=Object,kw=function(r){return Lw(Rw(r))},Iw=kn,Fw=kw,Mw=Iw({}.hasOwnProperty),Dr=Object.hasOwn||function(t,e){return Mw(Fw(t),e)},Dw=kn,Ow=0,Nw=Math.random(),Bw=Dw(1 .toString),F0=function(r){return"Symbol("+(r===void 0?"":r)+")_"+Bw(++Ow+Nw,36)},$w=Hi,jw=I0,ym=Dr,Uw=F0,Hw=T0,zw=P0,Yr=$w.Symbol,Uf=jw("wks"),Gw=zw?Yr.for||Yr:Yr&&Yr.withoutSetter||Uw,Vw=function(r){return ym(Uf,r)||(Uf[r]=Hw&&ym(Yr,r)?Yr[r]:Gw("Symbol."+r)),Uf[r]},Ww=Ng,wm=gh,Am=R0,qw=_w,Xw=Sw,Yw=Vw,Kw=TypeError,Zw=Yw("toPrimitive"),Jw=function(r,t){if(!wm(r)||Am(r))return r;var e=qw(r,Zw),i;if(e){if(t===void 0&&(t="default"),i=Ww(e,r,t),!wm(i)||Am(i))return i;throw new Kw("Can't convert object to primitive value")}return t===void 0&&(t="number"),Xw(r,t)},Qw=Jw,tA=R0,M0=function(r){var t=Qw(r,"string");return tA(t)?t:t+""},eA=Hi,Em=gh,op=eA.document,iA=Em(op)&&Em(op.createElement),nA=function(r){return iA?op.createElement(r):{}},sA=Mr,rA=ds,aA=nA,D0=!sA&&!rA(function(){return Object.defineProperty(aA("div"),"a",{get:function(){return 7}}).a!==7}),oA=Mr,lA=Ng,cA=m0,hA=y0,dA=Bg,uA=M0,fA=Dr,pA=D0,_m=Object.getOwnPropertyDescriptor;Og.f=oA?_m:function(t,e){if(t=dA(t),e=uA(e),pA)try{return _m(t,e)}catch{}if(fA(t,e))return hA(!lA(cA.f,t,e),t[e])};var of={},gA=Mr,mA=ds,vA=gA&&mA(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),bA=gh,yA=String,wA=TypeError,O0=function(r){if(bA(r))return r;throw new wA(yA(r)+" is not an object")},AA=Mr,EA=D0,_A=vA,Rh=O0,xm=M0,xA=TypeError,Hf=Object.defineProperty,SA=Object.getOwnPropertyDescriptor,zf="enumerable",Gf="configurable",Vf="writable";of.f=AA?_A?function(t,e,i){if(Rh(t),e=xm(e),Rh(i),typeof t=="function"&&e==="prototype"&&"value"in i&&Vf in i&&!i[Vf]){var n=SA(t,e);n&&n[Vf]&&(t[e]=i.value,i={configurable:Gf in i?i[Gf]:n[Gf],enumerable:zf in i?i[zf]:n[zf],writable:!1})}return Hf(t,e,i)}:Hf:function(t,e,i){if(Rh(t),e=xm(e),Rh(i),EA)try{return Hf(t,e,i)}catch{}if("get"in i||"set"in i)throw new xA("Accessors not supported");return"value"in i&&(t[e]=i.value),t};var CA=Mr,TA=of,PA=y0,N0=CA?function(r,t,e){return TA.f(r,t,PA(1,e))}:function(r,t,e){return r[t]=e,r},B0={exports:{}},lp=Mr,RA=Dr,$0=Function.prototype,LA=lp&&Object.getOwnPropertyDescriptor,Ug=RA($0,"name"),kA=Ug&&(function(){}).name==="something",IA=Ug&&(!lp||lp&&LA($0,"name").configurable),FA={EXISTS:Ug,PROPER:kA,CONFIGURABLE:IA},MA=kn,DA=zi,cp=jg,OA=MA(Function.toString);DA(cp.inspectSource)||(cp.inspectSource=function(r){return OA(r)});var NA=cp.inspectSource,BA=Hi,$A=zi,Sm=BA.WeakMap,jA=$A(Sm)&&/native code/.test(String(Sm)),UA=I0,HA=F0,Cm=UA("keys"),zA=function(r){return Cm[r]||(Cm[r]=HA(r))},j0={},GA=jA,U0=Hi,VA=gh,WA=N0,Wf=Dr,qf=jg,qA=zA,XA=j0,Tm="Object already initialized",hp=U0.TypeError,YA=U0.WeakMap,ud,Vo,fd,KA=function(r){return fd(r)?Vo(r):ud(r,{})},ZA=function(r){return function(t){var e;if(!VA(t)||(e=Vo(t)).type!==r)throw new hp("Incompatible receiver, "+r+" required");return e}};if(GA||qf.state){var vi=qf.state||(qf.state=new YA);vi.get=vi.get,vi.has=vi.has,vi.set=vi.set,ud=function(r,t){if(vi.has(r))throw new hp(Tm);return t.facade=r,vi.set(r,t),t},Vo=function(r){return vi.get(r)||{}},fd=function(r){return vi.has(r)}}else{var jr=qA("state");XA[jr]=!0,ud=function(r,t){if(Wf(r,jr))throw new hp(Tm);return t.facade=r,WA(r,jr,t),t},Vo=function(r){return Wf(r,jr)?r[jr]:{}},fd=function(r){return Wf(r,jr)}}var JA={set:ud,get:Vo,has:fd,enforce:KA,getterFor:ZA},Hg=kn,QA=ds,t1=zi,Lh=Dr,dp=Mr,e1=FA.CONFIGURABLE,i1=NA,H0=JA,n1=H0.enforce,s1=H0.get,Pm=String,Bh=Object.defineProperty,r1=Hg("".slice),a1=Hg("".replace),o1=Hg([].join),l1=dp&&!QA(function(){return Bh(function(){},"length",{value:8}).length!==8}),c1=String(String).split("String"),h1=B0.exports=function(r,t,e){r1(Pm(t),0,7)==="Symbol("&&(t="["+a1(Pm(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),e&&e.getter&&(t="get "+t),e&&e.setter&&(t="set "+t),(!Lh(r,"name")||e1&&r.name!==t)&&(dp?Bh(r,"name",{value:t,configurable:!0}):r.name=t),l1&&e&&Lh(e,"arity")&&r.length!==e.arity&&Bh(r,"length",{value:e.arity});try{e&&Lh(e,"constructor")&&e.constructor?dp&&Bh(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var i=n1(r);return Lh(i,"source")||(i.source=o1(c1,typeof t=="string"?t:"")),r};Function.prototype.toString=h1(function(){return t1(this)&&s1(this).source||i1(this)},"toString");var d1=B0.exports,u1=zi,f1=of,p1=d1,g1=$g,m1=function(r,t,e,i){i||(i={});var n=i.enumerable,s=i.name!==void 0?i.name:t;if(u1(e)&&p1(e,s,i),i.global)n?r[t]=e:g1(t,e);else{try{i.unsafe?r[t]&&(n=!0):delete r[t]}catch{}n?r[t]=e:f1.f(r,t,{value:e,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return r},z0={},v1=Math.ceil,b1=Math.floor,y1=Math.trunc||function(t){var e=+t;return(e>0?b1:v1)(e)},w1=y1,G0=function(r){var t=+r;return t!==t||t===0?0:w1(t)},A1=G0,E1=Math.max,_1=Math.min,x1=function(r,t){var e=A1(r);return e<0?E1(e+t,0):_1(e,t)},S1=G0,C1=Math.min,T1=function(r){var t=S1(r);return t>0?C1(t,9007199254740991):0},P1=T1,R1=function(r){return P1(r.length)},L1=Bg,k1=x1,I1=R1,Rm=function(r){return function(t,e,i){var n=L1(t),s=I1(n);if(s===0)return!r&&-1;var a=k1(i,s),l;if(r&&e!==e){for(;s>a;)if(l=n[a++],l!==l)return!0}else for(;s>a;a++)if((r||a in n)&&n[a]===e)return r||a||0;return!r&&-1}},F1={includes:Rm(!0),indexOf:Rm(!1)},M1=kn,Xf=Dr,D1=Bg,O1=F1.indexOf,N1=j0,Lm=M1([].push),B1=function(r,t){var e=D1(r),i=0,n=[],s;for(s in e)!Xf(N1,s)&&Xf(e,s)&&Lm(n,s);for(;t.length>i;)Xf(e,s=t[i++])&&(~O1(n,s)||Lm(n,s));return n},$1=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],j1=B1,U1=$1,H1=U1.concat("length","prototype");z0.f=Object.getOwnPropertyNames||function(t){return j1(t,H1)};var V0={};V0.f=Object.getOwnPropertySymbols;var z1=S0,G1=kn,V1=z0,W1=V0,q1=O0,X1=G1([].concat),Y1=z1("Reflect","ownKeys")||function(t){var e=V1.f(q1(t)),i=W1.f;return i?X1(e,i(t)):e},km=Dr,K1=Y1,Z1=Og,J1=of,Q1=function(r,t,e){for(var i=K1(t),n=J1.f,s=Z1.f,a=0;a<i.length;a++){var l=i[a];!km(r,l)&&!(e&&km(e,l))&&n(r,l,s(t,l))}},tE=ds,eE=zi,iE=/#|\.prototype\./,mh=function(r,t){var e=sE[nE(r)];return e===aE?!0:e===rE?!1:eE(t)?tE(t):!!t},nE=mh.normalize=function(r){return String(r).replace(iE,".").toLowerCase()},sE=mh.data={},rE=mh.NATIVE="N",aE=mh.POLYFILL="P",oE=mh,kh=Hi,lE=Og.f,cE=N0,hE=m1,dE=$g,uE=Q1,fE=oE,pE=function(r,t){var e=r.target,i=r.global,n=r.stat,s,a,l,c,d,h;if(i?a=kh:n?a=kh[e]||dE(e,{}):a=kh[e]&&kh[e].prototype,a)for(l in t){if(d=t[l],r.dontCallGetSet?(h=lE(a,l),c=h&&h.value):c=a[l],s=fE(i?l:e+(n?".":"#")+l,r.forced),!s&&c!==void 0){if(typeof d==typeof c)continue;uE(d,c)}(r.sham||c&&c.sham)&&cE(d,"sham",!0),hE(a,l,d,r)}},W0={},Im=L0,gE=TypeError,mE=function(r){var t,e;this.promise=new r(function(i,n){if(t!==void 0||e!==void 0)throw new gE("Bad Promise constructor");t=i,e=n}),this.resolve=Im(t),this.reject=Im(e)};W0.f=function(r){return new mE(r)};var vE=pE,bE=W0;vE({target:"Promise",stat:!0},{withResolvers:function(){var t=bE.f(this);return{promise:t.promise,resolve:t.resolve,reject:t.reject}}});const yE="Document {{ currentFileNo }} of {{ allFilesCount }}",wE="No renderer for file type: {{{ fileType }}}",AE="Download file",EE="Your file is broken. Please check it on your machine.",_E="Recipients",xE="Sender",SE="Loading...",CE="Page {{ currentPage }}/{{ allPagesCount }}",TE={documentNavInfo:yE,noRendererMessage:wE,downloadButtonLabel:AE,brokenFile:EE,msgPluginRecipients:_E,msgPluginSender:xE,pdfPluginLoading:SE,pdfPluginPageNumber:CE},PE="Dokument {{ currentFileNo }} z {{ allFilesCount }}",RE="Brak funckji renderującej dla: {{{ fileType }}}",LE="Pobierz plik",kE="Twój plik jest uszkodzony. Sprawdź go na swoim komputerze.",IE="Odbiorcy",FE="Nadawca",ME="Wczytywanie...",DE="Strona {{ currentPage }}/{{ allPagesCount }}",OE={documentNavInfo:PE,noRendererMessage:RE,downloadButtonLabel:LE,brokenFile:kE,msgPluginRecipients:IE,msgPluginSender:FE,pdfPluginLoading:ME,pdfPluginPageNumber:DE},NE="Documento {{ currentFileNo }} de {{ allFilesCount }}",BE="No hay procesador para el tipo de archivo: {{{ fileType }}}",$E="Descargar archivo",jE="Tu archivo está roto. Compruébalo en tu máquina.",UE="Destinatarios",HE="Remitente",zE="Cargando...",GE="Página {{ currentPage }}/{{ allPagesCount }}",VE={documentNavInfo:NE,noRendererMessage:BE,downloadButtonLabel:$E,brokenFile:jE,msgPluginRecipients:UE,msgPluginSender:HE,pdfPluginLoading:zE,pdfPluginPageNumber:GE},WE="Dokument {{ currentFileNo }} von {{ allFilesCount }}",qE="Kein Renderer für Dateityp: {{{ fileType }}}",XE="Datei herunterladen",YE="Ihre Datei ist defekt. Bitte überprüfen Sie sie auf Ihrem Rechner.",KE="Empfänger",ZE="Absender",JE="Wird geladen...",QE="Seite {{ currentPage }}/{{ allPagesCount }}",t_={documentNavInfo:WE,noRendererMessage:qE,downloadButtonLabel:XE,brokenFile:YE,msgPluginRecipients:KE,msgPluginSender:ZE,pdfPluginLoading:JE,pdfPluginPageNumber:QE},e_="Documento {{ currentFileNo }} di {{ allFilesCount }}",i_="Nessun renderer per il tipo di file: {{{ fileType }}}",n_="Scarica file",s_="Il tuo file è danneggiato. Controllalo sul tuo computer.",r_="Destinatari",a_="Mittente",o_="Caricamento in corso...",l_="Pagina {{ currentPage }}/{{ allPagesCount }}",c_={documentNavInfo:e_,noRendererMessage:i_,downloadButtonLabel:n_,brokenFile:s_,msgPluginRecipients:r_,msgPluginSender:a_,pdfPluginLoading:o_,pdfPluginPageNumber:l_},h_="Documento {{ currentFileNo }} de {{ allFilesCount }}",d_="Nenhum renderizador para o tipo de arquivo: {{{ fileType }}}",u_="Baixar arquivo",f_="Seu arquivo está quebrado. Por favor, verifique-o em sua máquina.",p_="Destinatários",g_="Remetente",m_="Carregando...",v_="Página {{ currentPage }}/{{ allPagesCount }}",b_={documentNavInfo:h_,noRendererMessage:d_,downloadButtonLabel:u_,brokenFile:f_,msgPluginRecipients:p_,msgPluginSender:g_,pdfPluginLoading:m_,pdfPluginPageNumber:v_},y_="Document {{ currentFileNo }} de {{ allFilesCount }}",w_="Aucun moteur de rendu pour le type de fichier : {{{ fileType }}}",A_="Télécharger le fichier",E_="Votre fichier est cassé. Veuillez le vérifier sur votre machine.",__="Destinataires",x_="Expéditeur",S_="Chargement...",C_="Page {{ currentPage }}/{{ allPagesCount }}",T_={documentNavInfo:y_,noRendererMessage:w_,downloadButtonLabel:A_,brokenFile:E_,msgPluginRecipients:__,msgPluginSender:x_,pdfPluginLoading:S_,pdfPluginPageNumber:C_},P_="مستند {{ currentFileNo }} من {{ allFilesCount }}",R_="{{{ fileType }}} : لا يمكننا عرض هذا النوع من الملفات",L_="تحميل الملف",k_="الملف تالف، يرجى التحقق منه على جهازك الخاص.",I_="المستلمين",F_="المرسل",M_="تحميل ...",D_=" {{ allPagesCount }} \\ {{ currentPage }} صفحة ",O_={documentNavInfo:P_,noRendererMessage:R_,downloadButtonLabel:L_,brokenFile:k_,msgPluginRecipients:I_,msgPluginSender:F_,pdfPluginLoading:M_,pdfPluginPageNumber:D_},N_="Dokument {{ currentFileNo }} od {{ allFilesCount }}",B_="Ne postoji pregledač za tip fajla: {{ fileType }}",$_="Preuzimanje fajla",j_="Vaš fajl nije dobar. Molimo Vas da probate da ga otvorite na vašem računaru.",U_="Primaoci",H_="Pošiljalac",z_="Učitavanje...",G_="Strana {{ currentPage }}/{{ allPagesCount }}",V_={documentNavInfo:N_,noRendererMessage:B_,downloadButtonLabel:$_,brokenFile:j_,msgPluginRecipients:U_,msgPluginSender:H_,pdfPluginLoading:z_,pdfPluginPageNumber:G_},W_="Документ {{ currentFileNo }} od {{ allFilesCount }}",q_="Не постоји прегледач за тип фајла: {{ fileType }}",X_="Преузимање фајла",Y_="Ваш фајл није добар. Молимо Вас да пробате да га отворите на вашем рачунару.",K_="Примаоци",Z_="Пошиљалац",J_="Учитавање...",Q_="Страна {{ currentPage }}/{{ allPagesCount }}",tx={documentNavInfo:W_,noRendererMessage:q_,downloadButtonLabel:X_,brokenFile:Y_,msgPluginRecipients:K_,msgPluginSender:Z_,pdfPluginLoading:J_,pdfPluginPageNumber:Q_},ex="ファイル {{ currentFileNo }} / {{ allFilesCount }}",ix="ファイルタイプに対応したレンダラーはありません: {{ fileType }}",nx="ダウンロード",sx="ファイルが壊れています。あなたのマシンでファイルを確認してください。",rx="受信者",ax="送信者",ox="ローティング中...",lx="ページ {{ currentPage }}/{{ allPagesCount }}",cx={documentNavInfo:ex,noRendererMessage:ix,downloadButtonLabel:nx,brokenFile:sx,msgPluginRecipients:rx,msgPluginSender:ax,pdfPluginLoading:ox,pdfPluginPageNumber:lx},hx="Документ {{ currentFileNo }} из {{ allFilesCount }}",dx="Данный тип файла не поддерживается рендером: {{{ fileType }}}",ux="Скачать файл",fx="Ваш файл сломан. Пожалуйста, проверьте его на своём комьютере.",px="Получатели",gx="Отправитель",mx="Загрузка...",vx="Страница {{ currentPage }}/{{ allPagesCount }}",bx={documentNavInfo:hx,noRendererMessage:dx,downloadButtonLabel:ux,brokenFile:fx,msgPluginRecipients:px,msgPluginSender:gx,pdfPluginLoading:mx,pdfPluginPageNumber:vx},yx="Dokument {{ currentFileNo }} av {{ allFilesCount }}",wx="Ingen renderare för filtypen: {{{ fileType }}}",Ax="Ladda ner",Ex="Filen är trasig. Var vänlig kontrollera den på din maskin.",_x="Mottagare",xx="Avsändare",Sx="Laddar...",Cx="Sida {{ currentPage }}/{{ allPagesCount }}",Tx={documentNavInfo:yx,noRendererMessage:wx,downloadButtonLabel:Ax,brokenFile:Ex,msgPluginRecipients:_x,msgPluginSender:xx,pdfPluginLoading:Sx,pdfPluginPageNumber:Cx},pd={en:TE,pl:OE,es:VE,de:t_,it:c_,pt:b_,fr:T_,ar:O_,sr:V_,sr_cyr:tx,ja:cx,ru:bx,se:Tx},Px=Object.keys(pd),zg="en",q0="SET_ALL_DOCUMENTS",X0="SET_DOCUMENT_LOADING",Y0="NEXT_DOCUMENT",K0="PREVIOUS_DOCUMENT",Z0="UPDATE_CURRENT_DOCUMENT",J0="SET_RENDERER_RECT",Q0="SET_MAIN_CONFIG",Rx=(r,t)=>({type:q0,documents:r,initialActiveDocument:t}),Yf=r=>({type:X0,value:r}),Gg=()=>({type:Y0}),Vg=()=>({type:K0}),up=r=>({type:Z0,document:r}),Lx=r=>({type:J0,rect:r}),kx=r=>({type:Q0,config:r}),gd={currentFileNo:0,documents:[],documentLoading:!0,currentDocument:void 0,rendererRect:void 0,config:{},pluginRenderers:[],language:zg},Ix=(r=gd,t)=>{switch(t.type){case q0:{const{documents:e,initialActiveDocument:i}=t;return{...r,documents:e,currentDocument:i||e[0]||null,currentFileNo:i&&e.includes(i)?e.indexOf(i):gd.currentFileNo}}case X0:{const{value:e}=t;return{...r,documentLoading:e}}case Y0:{if(r.currentFileNo>=r.documents.length-1)return r;const e=r.currentFileNo+1;return r.onDocumentChange&&r.onDocumentChange(r.documents[e]),{...r,currentFileNo:e,currentDocument:r.documents[e],documentLoading:!0}}case K0:{if(r.currentFileNo<=0)return r;const e=r.currentFileNo-1;return r.onDocumentChange&&r.onDocumentChange(r.documents[e]),{...r,currentFileNo:r.currentFileNo-1,currentDocument:r.documents[e],documentLoading:!0}}case Z0:{const{document:e}=t;return{...r,currentDocument:e,currentFileNo:r.documents.findIndex(i=>i.uri===e.uri)}}case J0:{const{rect:e}=t;return{...r,rendererRect:e}}case Q0:{const{config:e}=t;return{...r,config:e}}default:return r}},us=z.createContext({state:gd,dispatch:()=>null}),Fx=z.forwardRef((r,t)=>{const{children:e,documents:i,config:n,pluginRenderers:s,prefetchMethod:a,requestHeaders:l,initialActiveDocument:c,language:d,activeDocument:h,onDocumentChange:p}=r,[g,v]=z.useReducer(Ix,{...gd,documents:i||[],currentDocument:i&&i.length?c||i[0]:void 0,config:n,pluginRenderers:s,prefetchMethod:a,requestHeaders:l,currentFileNo:c?i.findIndex(b=>b===c)??0:0,language:d&&pd[d]?d:zg,activeDocument:h,onDocumentChange:p});return z.useEffect(()=>{v(Rx(i,c)),n&&v(kx(n))},[i,n,c]),z.useEffect(()=>{h&&v(up(h))},[h]),z.useImperativeHandle(t,()=>({prev(){v(Vg())},next(){v(Gg())}}),[v]),I.jsx(us.Provider,{value:{state:g,dispatch:v},children:e})}),Mx=ht.css`
  background-color: ${r=>r.theme.primary};
  color: ${r=>r.theme.textPrimary};
`,Dx=ht.css`
  background-color: ${r=>r.theme.secondary};
  color: ${r=>r.theme.textSecondary};
`,lf=ht.button`
  ${Mx}
  display: flex;
  justify-content: center;
  align-items: center;
  width: 35px;
  height: 35px;
  padding: 0;
  margin: 0 0 0 5px;
  text-align: center;
  font-size: 18px;
  border: 0;
  outline: none;
  cursor: pointer;
  text-decoration: none;
  border-radius: 35px;
  opacity: ${r=>r.disabled?.4:1};
  pointer-events: ${r=>r.disabled?"none":"all"};
  box-shadow: 2px 2px 3px #00000033;

  @media (max-width: 768px) {
    width: 30px;
    height: 30px;
    font-size: 15px;
  }
`,tv=ht.a`
  display: flex;
  justify-content: center;
  align-items: center;
  border: 0;
  outline: none;
  cursor: pointer;
  text-decoration: none;
  border-radius: 35px;
  background-color: ${r=>r.theme.primary};
  color: ${r=>r.theme.textPrimary};
  box-shadow: 2px 2px 3px #00000033;

  width: 35px;
  height: 35px;
  font-size: 18px;
  @media (max-width: 768px) {
    width: 30px;
    height: 30px;
    font-size: 15px;
  }
`;ht(lf)``;const Ox=ht(lf)`
  ${Dx}
`,Nx=r=>I.jsx(ev,{...r}),Bx=r=>I.jsx(ev,{...r,reverse:!0}),ev=({color:r,size:t,reverse:e})=>I.jsx("svg",{width:t||"100%",height:t||"100%",style:{transform:`${e?"rotate(180deg)":""}`},id:"arrow_left",version:"1.1",viewBox:"0 0 32 32",xmlSpace:"preserve",children:I.jsx("path",{clipRule:"evenodd",d:"M31.106,15H3.278l8.325-8.293  c0.391-0.391,0.391-1.024,0-1.414c-0.391-0.391-1.024-0.391-1.414,0l-9.9,9.899c-0.385,0.385-0.385,1.029,0,1.414l9.9,9.9  c0.391,0.391,1.024,0.391,1.414,0c0.391-0.391,0.391-1.024,0-1.414L3.278,17h27.828c0.552,0,1-0.448,1-1  C32.106,15.448,31.658,15,31.106,15z",fill:r||"#aaa",fillRule:"evenodd",id:"Arrow_Back"})}),$x=r=>{const{color:t,size:e}=r;return I.jsx("svg",{width:e||"100%",height:e||"100%",version:"1.1",id:"Icons",viewBox:"0 0 32 32",xmlSpace:"preserve",style:{alignSelf:"center",justifySelf:"center"},children:I.jsxs("g",{children:[I.jsx("path",{fill:t||"#aaa",d:"M16,2c-0.6,0-1,0.4-1,1v5c0,0.6,0.4,1,1,1s1-0.4,1-1V3C17,2.4,16.6,2,16,2z"}),I.jsx("path",{fill:t||"#aaa",d:`M7.5,6.1c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l3.5,3.5c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.5,6.1
		z`}),I.jsx("path",{fill:t||"#aaa",d:"M9,16c0-0.6-0.4-1-1-1H3c-0.6,0-1,0.4-1,1s0.4,1,1,1h5C8.6,17,9,16.6,9,16z"}),I.jsx("path",{fill:t||"#aaa",d:`M9.6,20.9l-3.5,3.5c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l3.5-3.5c0.4-0.4,0.4-1,0-1.4
		S10,20.6,9.6,20.9z`}),I.jsx("path",{fill:t||"#aaa",d:"M16,23c-0.6,0-1,0.4-1,1v5c0,0.6,0.4,1,1,1s1-0.4,1-1v-5C17,23.4,16.6,23,16,23z"}),I.jsx("path",{fill:t||"#aaa",d:`M22.4,20.9c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l3.5,3.5c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4
		L22.4,20.9z`}),I.jsx("path",{fill:t||"#aaa",d:"M29,15h-5c-0.6,0-1,0.4-1,1s0.4,1,1,1h5c0.6,0,1-0.4,1-1S29.6,15,29,15z"}),I.jsx("path",{fill:t||"#aaa",d:`M21.7,11.3c0.3,0,0.5-0.1,0.7-0.3l3.5-3.5c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-3.5,3.5c-0.4,0.4-0.4,1,0,1.4
		C21.1,11.2,21.4,11.3,21.7,11.3z`})]})})};/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var jx=Object.prototype.toString,Ao=Array.isArray||function(t){return jx.call(t)==="[object Array]"};function Wg(r){return typeof r=="function"}function Ux(r){return Ao(r)?"array":typeof r}function Kf(r){return r.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Fm(r,t){return r!=null&&typeof r=="object"&&t in r}function Hx(r,t){return r!=null&&typeof r!="object"&&r.hasOwnProperty&&r.hasOwnProperty(t)}var zx=RegExp.prototype.test;function Gx(r,t){return zx.call(r,t)}var Vx=/\S/;function Wx(r){return!Gx(Vx,r)}var qx={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Xx(r){return String(r).replace(/[&<>"'`=\/]/g,function(e){return qx[e]})}var Yx=/\s*/,Kx=/\s+/,Mm=/\s*=/,Zx=/\s*\}/,Jx=/#|\^|\/|>|\{|&|=|!/;function Qx(r,t){if(!r)return[];var e=!1,i=[],n=[],s=[],a=!1,l=!1,c="",d=0;function h(){if(a&&!l)for(;s.length;)delete n[s.pop()];else s=[];a=!1,l=!1}var p,g,v;function b(S){if(typeof S=="string"&&(S=S.split(Kx,2)),!Ao(S)||S.length!==2)throw new Error("Invalid tags: "+S);p=new RegExp(Kf(S[0])+"\\s*"),g=new RegExp("\\s*"+Kf(S[1])),v=new RegExp("\\s*"+Kf("}"+S[1]))}b(t||Xe.tags);for(var E=new vh(r),C,_,R,L,D,O;!E.eos();){if(C=E.pos,R=E.scanUntil(p),R)for(var N=0,j=R.length;N<j;++N)L=R.charAt(N),Wx(L)?(s.push(n.length),c+=L):(l=!0,e=!0,c+=" "),n.push(["text",L,C,C+1]),C+=1,L===`
`&&(h(),c="",d=0,e=!1);if(!E.scan(p))break;if(a=!0,_=E.scan(Jx)||"name",E.scan(Yx),_==="="?(R=E.scanUntil(Mm),E.scan(Mm),E.scanUntil(g)):_==="{"?(R=E.scanUntil(v),E.scan(Zx),E.scanUntil(g),_="&"):R=E.scanUntil(g),!E.scan(g))throw new Error("Unclosed tag at "+E.pos);if(_==">"?D=[_,R,C,E.pos,c,d,e]:D=[_,R,C,E.pos],d++,n.push(D),_==="#"||_==="^")i.push(D);else if(_==="/"){if(O=i.pop(),!O)throw new Error('Unopened section "'+R+'" at '+C);if(O[1]!==R)throw new Error('Unclosed section "'+O[1]+'" at '+C)}else _==="name"||_==="{"||_==="&"?l=!0:_==="="&&b(R)}if(h(),O=i.pop(),O)throw new Error('Unclosed section "'+O[1]+'" at '+E.pos);return eS(tS(n))}function tS(r){for(var t=[],e,i,n=0,s=r.length;n<s;++n)e=r[n],e&&(e[0]==="text"&&i&&i[0]==="text"?(i[1]+=e[1],i[3]=e[3]):(t.push(e),i=e));return t}function eS(r){for(var t=[],e=t,i=[],n,s,a=0,l=r.length;a<l;++a)switch(n=r[a],n[0]){case"#":case"^":e.push(n),i.push(n),e=n[4]=[];break;case"/":s=i.pop(),s[5]=n[2],e=i.length>0?i[i.length-1][4]:t;break;default:e.push(n)}return t}function vh(r){this.string=r,this.tail=r,this.pos=0}vh.prototype.eos=function(){return this.tail===""};vh.prototype.scan=function(t){var e=this.tail.match(t);if(!e||e.index!==0)return"";var i=e[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i};vh.prototype.scanUntil=function(t){var e=this.tail.search(t),i;switch(e){case-1:i=this.tail,this.tail="";break;case 0:i="";break;default:i=this.tail.substring(0,e),this.tail=this.tail.substring(e)}return this.pos+=i.length,i};function yo(r,t){this.view=r,this.cache={".":this.view},this.parent=t}yo.prototype.push=function(t){return new yo(t,this)};yo.prototype.lookup=function(t){var e=this.cache,i;if(e.hasOwnProperty(t))i=e[t];else{for(var n=this,s,a,l,c=!1;n;){if(t.indexOf(".")>0)for(s=n.view,a=t.split("."),l=0;s!=null&&l<a.length;)l===a.length-1&&(c=Fm(s,a[l])||Hx(s,a[l])),s=s[a[l++]];else s=n.view[t],c=Fm(n.view,t);if(c){i=s;break}n=n.parent}e[t]=i}return Wg(i)&&(i=i.call(this.view)),i};function Re(){this.templateCache={_cache:{},set:function(t,e){this._cache[t]=e},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}Re.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};Re.prototype.parse=function(t,e){var i=this.templateCache,n=t+":"+(e||Xe.tags).join(":"),s=typeof i<"u",a=s?i.get(n):void 0;return a==null&&(a=Qx(t,e),s&&i.set(n,a)),a};Re.prototype.render=function(t,e,i,n){var s=this.getConfigTags(n),a=this.parse(t,s),l=e instanceof yo?e:new yo(e,void 0);return this.renderTokens(a,l,i,t,n)};Re.prototype.renderTokens=function(t,e,i,n,s){for(var a="",l,c,d,h=0,p=t.length;h<p;++h)d=void 0,l=t[h],c=l[0],c==="#"?d=this.renderSection(l,e,i,n,s):c==="^"?d=this.renderInverted(l,e,i,n,s):c===">"?d=this.renderPartial(l,e,i,s):c==="&"?d=this.unescapedValue(l,e):c==="name"?d=this.escapedValue(l,e,s):c==="text"&&(d=this.rawValue(l)),d!==void 0&&(a+=d);return a};Re.prototype.renderSection=function(t,e,i,n,s){var a=this,l="",c=e.lookup(t[1]);function d(g){return a.render(g,e,i,s)}if(c){if(Ao(c))for(var h=0,p=c.length;h<p;++h)l+=this.renderTokens(t[4],e.push(c[h]),i,n,s);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")l+=this.renderTokens(t[4],e.push(c),i,n,s);else if(Wg(c)){if(typeof n!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(e.view,n.slice(t[3],t[5]),d),c!=null&&(l+=c)}else l+=this.renderTokens(t[4],e,i,n,s);return l}};Re.prototype.renderInverted=function(t,e,i,n,s){var a=e.lookup(t[1]);if(!a||Ao(a)&&a.length===0)return this.renderTokens(t[4],e,i,n,s)};Re.prototype.indentPartial=function(t,e,i){for(var n=e.replace(/[^ \t]/g,""),s=t.split(`
`),a=0;a<s.length;a++)s[a].length&&(a>0||!i)&&(s[a]=n+s[a]);return s.join(`
`)};Re.prototype.renderPartial=function(t,e,i,n){if(i){var s=this.getConfigTags(n),a=Wg(i)?i(t[1]):i[t[1]];if(a!=null){var l=t[6],c=t[5],d=t[4],h=a;c==0&&d&&(h=this.indentPartial(a,d,l));var p=this.parse(h,s);return this.renderTokens(p,e,i,h,n)}}};Re.prototype.unescapedValue=function(t,e){var i=e.lookup(t[1]);if(i!=null)return i};Re.prototype.escapedValue=function(t,e,i){var n=this.getConfigEscape(i)||Xe.escape,s=e.lookup(t[1]);if(s!=null)return typeof s=="number"&&n===Xe.escape?String(s):n(s)};Re.prototype.rawValue=function(t){return t[1]};Re.prototype.getConfigTags=function(t){return Ao(t)?t:t&&typeof t=="object"?t.tags:void 0};Re.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!Ao(t))return t.escape};var Xe={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(r){Wo.templateCache=r},get templateCache(){return Wo.templateCache}},Wo=new Re;Xe.clearCache=function(){return Wo.clearCache()};Xe.parse=function(t,e){return Wo.parse(t,e)};Xe.render=function(t,e,i,n){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Ux(t)+'" was given as the first argument for mustache#render(template, view, partials)');return Wo.render(t,e,i,n)};Xe.escape=Xx;Xe.Scanner=vh;Xe.Context=yo;Xe.Writer=Re;const Or=()=>{const{state:{language:r}}=z.useContext(us),t=pd[zg];return{t:z.useCallback((i,n)=>{const s=pd[r];return s[i]?Xe.render(s[i],n):t[i]?Xe.render(t[i],n):i},[r,t])}},iS=()=>{const{state:{currentDocument:r,currentFileNo:t,documents:e},dispatch:i}=z.useContext(us),{t:n}=Or();if(e.length<=1||!r)return null;let s=r.uri||"";const a=s==null?void 0:s.split("/");return a.length&&(s=a[a.length-1]),I.jsxs(nS,{id:"doc-nav",children:[I.jsx("p",{id:"doc-nav-info",children:n("documentNavInfo",{currentFileNo:t+1,allFilesCount:e.length})}),I.jsx(iv,{id:"doc-nav-prev",onClick:()=>i(Vg()),disabled:t===0,children:I.jsx(Nx,{color:"#fff",size:"60%"})}),I.jsx(sS,{id:"doc-nav-next",onClick:()=>i(Gg()),disabled:t>=e.length-1,children:I.jsx(Bx,{color:"#fff",size:"60%"})})]})},nS=ht.div`
  min-width: 150px;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
  margin: 0 10px;
  color: ${r=>r.theme.textPrimary};
`,iv=ht(Ox)`
  width: 30px;
  height: 30px;
  margin: 0 5px 0 10px;

  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`,sS=ht(iv)`
  margin: 0 5px;
`,nv=(r,t)=>{var i;if(!r)return"";let e="";if(r.fileName)e=r.fileName;else{e=r.uri||"",e=decodeURI(e),t||(e=(i=e==null?void 0:e.split("?"))==null?void 0:i[0]);const n=e==null?void 0:e.split("/");n.length&&(e=n[n.length-1])}return e},rS=()=>{var i,n;const{state:{config:r,currentDocument:t}}=z.useContext(us);if(!t||(i=r==null?void 0:r.header)!=null&&i.disableFileName)return null;const e=nv(t,((n=r==null?void 0:r.header)==null?void 0:n.retainURLParams)||!1);return I.jsx(aS,{id:"file-name","data-testid":"file-name",children:e})},aS=ht.div`
  flex: 1;
  text-align: left;
  color: ${r=>r.theme.textPrimary};
  font-weight: bold;
  margin: 0 10px;
  overflow: hidden;
`,oS=()=>{var n,s,a;const{state:r,dispatch:t}=z.useContext(us),{config:e}=r;if((n=e==null?void 0:e.header)!=null&&n.disableHeader)return null;const i=(a=(s=e==null?void 0:e.header)==null?void 0:s.overrideComponent)==null?void 0:a.call(s,r,()=>t(Vg()),()=>t(Gg()));return i||I.jsxs(lS,{id:"header-bar","data-testid":"header-bar",children:[I.jsx(rS,{}),I.jsx(iS,{})]})},lS=ht.div`
  display: flex;
  justify-content: flex-end;
  align-items: center;
  z-index: 1;
  padding: 0 10px;
  background-color: ${r=>r.theme.primary};
  font-size: 16px;
  min-height: 50px;

  @media (max-width: 768px) {
    min-height: 30px;
    padding: 5px;
    font-size: 10px;
  }
`,cf=({documentURI:r,signal:t,fileLoaderComplete:e,readerTypeFunction:i,headers:n})=>fetch(r,{signal:t,headers:n}).then(async s=>{const a=await s.blob(),l=new FileReader;switch(l.addEventListener("loadend",()=>e(l)),i){case"arrayBuffer":l.readAsArrayBuffer(a);break;case"binaryString":l.readAsBinaryString(a);break;case"dataURL":l.readAsDataURL(a);break;case"text":l.readAsText(a);break}}).catch(s=>s),sv=r=>cf({...r,readerTypeFunction:"arrayBuffer"}),qg=r=>cf({...r,readerTypeFunction:"dataURL"}),Xg=r=>cf({...r,readerTypeFunction:"text"}),cS=r=>cf({...r,readerTypeFunction:"binaryString"}),rv=qg,hS=()=>{const{state:{currentDocument:r,pluginRenderers:t}}=z.useContext(us),[e,i]=z.useState();return z.useEffect(()=>{if(!r)return;if(!r.fileType){i(void 0);return}const n=[];t==null||t.forEach(a=>{r.fileType!==void 0&&a.fileTypes.indexOf(r.fileType)>=0&&n.push(a)});const[s]=n.sort((a,l)=>l.weight-a.weight);i(s&&s!==void 0?()=>s:null)},[r,t]),{CurrentRenderer:e}},dS=()=>{const{state:r,dispatch:t}=z.useContext(us),{currentFileNo:e,currentDocument:i,prefetchMethod:n}=r,{CurrentRenderer:s}=hS(),a=(i==null?void 0:i.uri)||"";return z.useEffect(()=>{if(!i||i.fileType!==void 0)return;const l=new AbortController,{signal:c}=l;return fetch(a,{method:n||a.startsWith("blob:")?"GET":"HEAD",signal:c,headers:r==null?void 0:r.requestHeaders}).then(d=>{const h=d.headers.get("content-type"),p=(h==null?void 0:h.split(";"))||[],g=p.length?p[0]:void 0;t(up({...i,fileType:g||void 0}))}).catch(d=>{if((d==null?void 0:d.name)!=="AbortError")throw d}),()=>{l.abort()}},[e,a,i]),z.useEffect(()=>{var p;if(!i||s===void 0)return;const l=new AbortController,{signal:c}=l,h={documentURI:a,signal:c,fileLoaderComplete:g=>{if(!i||!g){t(Yf(!1));return}const v={...i};g.result!==null&&(v.fileData=g.result),t(up(v)),t(Yf(!1))},headers:r==null?void 0:r.requestHeaders};return s===null?t(Yf(!1)):s.fileLoader!==void 0?(p=s.fileLoader)==null||p.call(s,h):rv(h),()=>{l.abort()}},[s,e]),{state:r,dispatch:t,CurrentRenderer:s}},uS=()=>{const[r,t]=z.useState({width:void 0,height:void 0});return z.useEffect(()=>{function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),r},Dm=({children:r})=>{var s,a;const{state:t}=z.useContext(us),{config:e}=t,[i,n]=z.useState(((s=e==null?void 0:e.loadingRenderer)==null?void 0:s.showLoadingTimeout)===!1);return z.useEffect(()=>{var l;setTimeout(()=>{n(!0)},typeof((l=e==null?void 0:e.loadingRenderer)==null?void 0:l.showLoadingTimeout)=="number"?e.loadingRenderer.showLoadingTimeout:500)},[(a=e==null?void 0:e.loadingRenderer)==null?void 0:a.showLoadingTimeout]),i?I.jsx(I.Fragment,{children:r}):null},fS=({documents:r,documentLoading:t,config:e,currentDocument:i,fileName:n,CurrentRenderer:s,state:a,t:l})=>{var c,d;if(r.length)if(t){if(e&&((c=e==null?void 0:e.loadingRenderer)!=null&&c.overrideComponent)){const h=e.loadingRenderer.overrideComponent;return I.jsx(Dm,{children:I.jsx(h,{document:i,fileName:n})})}return I.jsx(Dm,{children:I.jsx(gS,{id:"loading-renderer","data-testid":"loading-renderer",children:I.jsx(vS,{children:I.jsx($x,{color:"#444",size:40})})})})}else{if(s)return I.jsx(s,{mainState:a});if(s===void 0)return null;if(e&&((d=e==null?void 0:e.noRenderer)!=null&&d.overrideComponent)){const h=e.noRenderer.overrideComponent;return I.jsx(h,{document:i,fileName:n})}return I.jsxs("div",{id:"no-renderer","data-testid":"no-renderer",children:[l("noRendererMessage",{fileType:(i==null?void 0:i.fileType)??""}),I.jsx(bS,{id:"no-renderer-download",href:i==null?void 0:i.uri,download:i==null?void 0:i.uri,children:l("downloadButtonLabel")})]})}else return I.jsx("div",{id:"no-documents"})},pS=()=>{var p;const{state:r,dispatch:t,CurrentRenderer:e}=dS(),{documents:i,documentLoading:n,currentDocument:s,config:a}=r,l=uS(),{t:c}=Or(),d=z.useCallback(g=>{g&&t(Lx(g==null?void 0:g.getBoundingClientRect()))},[l,t]),h=nv(s,((p=a==null?void 0:a.header)==null?void 0:p.retainURLParams)||!1);return I.jsx("div",{id:"proxy-renderer","data-testid":"proxy-renderer",ref:d,children:I.jsx(fS,{state:r,documents:i,documentLoading:n,config:a,currentDocument:s,fileName:h,CurrentRenderer:e,t:c})})},gS=ht.div`
  display: flex;
  flex: 1;
  height: 75px;
  align-items: center;
  justify-content: center;
`,mS=ht.keyframes`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,vS=ht.div`
  animation-name: ${mS};
  animation-duration: 4s;
  animation-timing-function: linear;
  animation-iteration-count: infinite;
`,bS=ht(tv)`
  width: 130px;
  height: 30px;
  background-color: ${r=>r.theme.primary};
  @media (max-width: 768px) {
    width: 125px;
    height: 25px;
  }
`,Om={primary:"#fff",secondary:"#000",tertiary:"#ffffff99",textPrimary:"#000",textSecondary:"#fff",textTertiary:"#00000044",disableThemeScrollbar:!1},Ln=({mainState:{currentDocument:r},children:t,...e})=>r?I.jsx(yS,{id:"image-renderer",...e,children:t||I.jsx(wS,{id:"image-img",src:r.fileData})}):null;Ln.fileTypes=[];Ln.weight=0;const yS=ht.div`
  display: flex;
  flex: 1;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  background-color: #fff;
`,wS=ht.img`
  max-width: 95%;
  max-height: 95%;
`,hf=r=>I.jsx(Ln,{...r});hf.fileTypes=["bmp","image/bmp"];hf.weight=0;const bh=({mainState:{currentDocument:r}})=>(z.useEffect(()=>{const t=r==null?void 0:r.fileData;let e="";const i=(t==null?void 0:t.replace(/^data:text\/html;(?:charset=([^;]*);)?base64,/,(c,d)=>(e=d,"")))||"";let n=window.atob(i);if(e){const c=new Uint8Array(n.length);for(let d=0;d<n.length;d++)c[d]=n.charCodeAt(d);n=new TextDecoder(e).decode(c)}const s=document.getElementById("html-body"),a=(s==null?void 0:s.contentWindow)&&s.contentWindow;if(!a)return;const l=a.document;l.open(),l.write(`${n}`),l.close()},[r]),I.jsx(AS,{id:"html-renderer",children:I.jsx(ES,{id:"html-body",sandbox:"allow-same-origin"})}));bh.fileTypes=["htm","html","text/htm","text/html"];bh.weight=0;bh.fileLoader=qg;const AS=ht.div`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 0 30px;
`,ES=ht.iframe`
  height: 100%;
  padding: 15px;
  margin: 20px 0 20px 0;
  border: 1px solid ${r=>r.theme.secondary};
`,df=r=>I.jsx(Ln,{...r});df.fileTypes=["jpg","jpeg","image/jpg","image/jpeg"];df.weight=0;const yh=({mainState:{currentDocument:r}})=>r?I.jsx(_S,{id:"msdoc-renderer",children:I.jsx(xS,{id:"msdoc-iframe",title:"msdoc-iframe",src:`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(r.uri)}`,sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",frameBorder:"0"})}):null,ps={odt:["odt","application/vnd.oasis.opendocument.text"],doc:["doc","application/msword"],docx:["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/octet-stream"],xls:["xls","application/vnd.ms-excel"],xlsx:["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],ppt:["ppt","application/vnd.ms-powerpoint"],pptx:["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"]};yh.fileTypes=[...ps.odt,...ps.doc,...ps.docx,...ps.xls,...ps.xlsx,...ps.ppt,...ps.pptx];yh.weight=0;yh.fileLoader=({fileLoaderComplete:r})=>r();const _S=ht.div`
  width: 100%;
`,xS=ht.iframe`
  width: 100%;
  height: 100%;
  border: 0;
`;function SS(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var av={exports:{}},Yt=av.exports={},yi,wi;function fp(){throw new Error("setTimeout has not been defined")}function pp(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?yi=setTimeout:yi=fp}catch{yi=fp}try{typeof clearTimeout=="function"?wi=clearTimeout:wi=pp}catch{wi=pp}})();function ov(r){if(yi===setTimeout)return setTimeout(r,0);if((yi===fp||!yi)&&setTimeout)return yi=setTimeout,setTimeout(r,0);try{return yi(r,0)}catch{try{return yi.call(null,r,0)}catch{return yi.call(this,r,0)}}}function CS(r){if(wi===clearTimeout)return clearTimeout(r);if((wi===pp||!wi)&&clearTimeout)return wi=clearTimeout,clearTimeout(r);try{return wi(r)}catch{try{return wi.call(null,r)}catch{return wi.call(this,r)}}}var Cn=[],Zr=!1,Es,$h=-1;function TS(){!Zr||!Es||(Zr=!1,Es.length?Cn=Es.concat(Cn):$h=-1,Cn.length&&lv())}function lv(){if(!Zr){var r=ov(TS);Zr=!0;for(var t=Cn.length;t;){for(Es=Cn,Cn=[];++$h<t;)Es&&Es[$h].run();$h=-1,t=Cn.length}Es=null,Zr=!1,CS(r)}}Yt.nextTick=function(r){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];Cn.push(new cv(r,t)),Cn.length===1&&!Zr&&ov(lv)};function cv(r,t){this.fun=r,this.array=t}cv.prototype.run=function(){this.fun.apply(null,this.array)};Yt.title="browser";Yt.browser=!0;Yt.env={};Yt.argv=[];Yt.version="";Yt.versions={};function In(){}Yt.on=In;Yt.addListener=In;Yt.once=In;Yt.off=In;Yt.removeListener=In;Yt.removeAllListeners=In;Yt.emit=In;Yt.prependListener=In;Yt.prependOnceListener=In;Yt.listeners=function(r){return[]};Yt.binding=function(r){throw new Error("process.binding is not supported")};Yt.cwd=function(){return"/"};Yt.chdir=function(r){throw new Error("process.chdir is not supported")};Yt.umask=function(){return 0};var PS=av.exports;const Ki=SS(PS);var ne={},uf={};uf.byteLength=kS;uf.toByteArray=FS;uf.fromByteArray=OS;var ji=[],Ze=[],RS=typeof Uint8Array<"u"?Uint8Array:Array,Zf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ur=0,LS=Zf.length;Ur<LS;++Ur)ji[Ur]=Zf[Ur],Ze[Zf.charCodeAt(Ur)]=Ur;Ze[45]=62;Ze[95]=63;function hv(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");e===-1&&(e=t);var i=e===t?0:4-e%4;return[e,i]}function kS(r){var t=hv(r),e=t[0],i=t[1];return(e+i)*3/4-i}function IS(r,t,e){return(t+e)*3/4-e}function FS(r){var t,e=hv(r),i=e[0],n=e[1],s=new RS(IS(r,i,n)),a=0,l=n>0?i-4:i,c;for(c=0;c<l;c+=4)t=Ze[r.charCodeAt(c)]<<18|Ze[r.charCodeAt(c+1)]<<12|Ze[r.charCodeAt(c+2)]<<6|Ze[r.charCodeAt(c+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=t&255;return n===2&&(t=Ze[r.charCodeAt(c)]<<2|Ze[r.charCodeAt(c+1)]>>4,s[a++]=t&255),n===1&&(t=Ze[r.charCodeAt(c)]<<10|Ze[r.charCodeAt(c+1)]<<4|Ze[r.charCodeAt(c+2)]>>2,s[a++]=t>>8&255,s[a++]=t&255),s}function MS(r){return ji[r>>18&63]+ji[r>>12&63]+ji[r>>6&63]+ji[r&63]}function DS(r,t,e){for(var i,n=[],s=t;s<e;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),n.push(MS(i));return n.join("")}function OS(r){for(var t,e=r.length,i=e%3,n=[],s=16383,a=0,l=e-i;a<l;a+=s)n.push(DS(r,a,a+s>l?l:a+s));return i===1?(t=r[e-1],n.push(ji[t>>2]+ji[t<<4&63]+"==")):i===2&&(t=(r[e-2]<<8)+r[e-1],n.push(ji[t>>10]+ji[t>>4&63]+ji[t<<2&63]+"=")),n.join("")}var Yg={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Yg.read=function(r,t,e,i,n){var s,a,l=n*8-i-1,c=(1<<l)-1,d=c>>1,h=-7,p=e?n-1:0,g=e?-1:1,v=r[t+p];for(p+=g,s=v&(1<<-h)-1,v>>=-h,h+=l;h>0;s=s*256+r[t+p],p+=g,h-=8);for(a=s&(1<<-h)-1,s>>=-h,h+=i;h>0;a=a*256+r[t+p],p+=g,h-=8);if(s===0)s=1-d;else{if(s===c)return a?NaN:(v?-1:1)*(1/0);a=a+Math.pow(2,i),s=s-d}return(v?-1:1)*a*Math.pow(2,s-i)};Yg.write=function(r,t,e,i,n,s){var a,l,c,d=s*8-n-1,h=(1<<d)-1,p=h>>1,g=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=i?0:s-1,b=i?1:-1,E=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+p>=1?t+=g/c:t+=g*Math.pow(2,1-p),t*c>=2&&(a++,c/=2),a+p>=h?(l=0,a=h):a+p>=1?(l=(t*c-1)*Math.pow(2,n),a=a+p):(l=t*Math.pow(2,p-1)*Math.pow(2,n),a=0));n>=8;r[e+v]=l&255,v+=b,l/=256,n-=8);for(a=a<<n|l,d+=n;d>0;r[e+v]=a&255,v+=b,a/=256,d-=8);r[e+v-b]|=E*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const t=uf,e=Yg,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=h,r.SlowBuffer=O,r.INSPECT_MAX_BYTES=50;const n=2147483647;r.kMaxLength=n;const{Uint8Array:s,ArrayBuffer:a,SharedArrayBuffer:l}=globalThis;h.TYPED_ARRAY_SUPPORT=c(),!h.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const y=new s(1),u={foo:function(){return 42}};return Object.setPrototypeOf(u,s.prototype),Object.setPrototypeOf(y,u),y.foo()===42}catch{return!1}}Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}});function d(y){if(y>n)throw new RangeError('The value "'+y+'" is invalid for option "size"');const u=new s(y);return Object.setPrototypeOf(u,h.prototype),u}function h(y,u,f){if(typeof y=="number"){if(typeof u=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return b(y)}return p(y,u,f)}h.poolSize=8192;function p(y,u,f){if(typeof y=="string")return E(y,u);if(a.isView(y))return _(y);if(y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y);if(ot(y,a)||y&&ot(y.buffer,a)||typeof l<"u"&&(ot(y,l)||y&&ot(y.buffer,l)))return R(y,u,f);if(typeof y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const x=y.valueOf&&y.valueOf();if(x!=null&&x!==y)return h.from(x,u,f);const P=L(y);if(P)return P;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof y[Symbol.toPrimitive]=="function")return h.from(y[Symbol.toPrimitive]("string"),u,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y)}h.from=function(y,u,f){return p(y,u,f)},Object.setPrototypeOf(h.prototype,s.prototype),Object.setPrototypeOf(h,s);function g(y){if(typeof y!="number")throw new TypeError('"size" argument must be of type number');if(y<0)throw new RangeError('The value "'+y+'" is invalid for option "size"')}function v(y,u,f){return g(y),y<=0?d(y):u!==void 0?typeof f=="string"?d(y).fill(u,f):d(y).fill(u):d(y)}h.alloc=function(y,u,f){return v(y,u,f)};function b(y){return g(y),d(y<0?0:D(y)|0)}h.allocUnsafe=function(y){return b(y)},h.allocUnsafeSlow=function(y){return b(y)};function E(y,u){if((typeof u!="string"||u==="")&&(u="utf8"),!h.isEncoding(u))throw new TypeError("Unknown encoding: "+u);const f=N(y,u)|0;let x=d(f);const P=x.write(y,u);return P!==f&&(x=x.slice(0,P)),x}function C(y){const u=y.length<0?0:D(y.length)|0,f=d(u);for(let x=0;x<u;x+=1)f[x]=y[x]&255;return f}function _(y){if(ot(y,s)){const u=new s(y);return R(u.buffer,u.byteOffset,u.byteLength)}return C(y)}function R(y,u,f){if(u<0||y.byteLength<u)throw new RangeError('"offset" is outside of buffer bounds');if(y.byteLength<u+(f||0))throw new RangeError('"length" is outside of buffer bounds');let x;return u===void 0&&f===void 0?x=new s(y):f===void 0?x=new s(y,u):x=new s(y,u,f),Object.setPrototypeOf(x,h.prototype),x}function L(y){if(h.isBuffer(y)){const u=D(y.length)|0,f=d(u);return f.length===0||y.copy(f,0,0,u),f}if(y.length!==void 0)return typeof y.length!="number"||Ee(y.length)?d(0):C(y);if(y.type==="Buffer"&&Array.isArray(y.data))return C(y.data)}function D(y){if(y>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return y|0}function O(y){return+y!=y&&(y=0),h.alloc(+y)}h.isBuffer=function(u){return u!=null&&u._isBuffer===!0&&u!==h.prototype},h.compare=function(u,f){if(ot(u,s)&&(u=h.from(u,u.offset,u.byteLength)),ot(f,s)&&(f=h.from(f,f.offset,f.byteLength)),!h.isBuffer(u)||!h.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(u===f)return 0;let x=u.length,P=f.length;for(let M=0,$=Math.min(x,P);M<$;++M)if(u[M]!==f[M]){x=u[M],P=f[M];break}return x<P?-1:P<x?1:0},h.isEncoding=function(u){switch(String(u).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(u,f){if(!Array.isArray(u))throw new TypeError('"list" argument must be an Array of Buffers');if(u.length===0)return h.alloc(0);let x;if(f===void 0)for(f=0,x=0;x<u.length;++x)f+=u[x].length;const P=h.allocUnsafe(f);let M=0;for(x=0;x<u.length;++x){let $=u[x];if(ot($,s))M+$.length>P.length?(h.isBuffer($)||($=h.from($)),$.copy(P,M)):s.prototype.set.call(P,$,M);else if(h.isBuffer($))$.copy(P,M);else throw new TypeError('"list" argument must be an Array of Buffers');M+=$.length}return P};function N(y,u){if(h.isBuffer(y))return y.length;if(a.isView(y)||ot(y,a))return y.byteLength;if(typeof y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof y);const f=y.length,x=arguments.length>2&&arguments[2]===!0;if(!x&&f===0)return 0;let P=!1;for(;;)switch(u){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return Wt(y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f*2;case"hex":return f>>>1;case"base64":return Pt(y).length;default:if(P)return x?-1:Wt(y).length;u=(""+u).toLowerCase(),P=!0}}h.byteLength=N;function j(y,u,f){let x=!1;if((u===void 0||u<0)&&(u=0),u>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0,u>>>=0,f<=u))return"";for(y||(y="utf8");;)switch(y){case"hex":return V(this,u,f);case"utf8":case"utf-8":return B(this,u,f);case"ascii":return xt(this,u,f);case"latin1":case"binary":return vt(this,u,f);case"base64":return Z(this,u,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return it(this,u,f);default:if(x)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),x=!0}}h.prototype._isBuffer=!0;function S(y,u,f){const x=y[u];y[u]=y[f],y[f]=x}h.prototype.swap16=function(){const u=this.length;if(u%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let f=0;f<u;f+=2)S(this,f,f+1);return this},h.prototype.swap32=function(){const u=this.length;if(u%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let f=0;f<u;f+=4)S(this,f,f+3),S(this,f+1,f+2);return this},h.prototype.swap64=function(){const u=this.length;if(u%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let f=0;f<u;f+=8)S(this,f,f+7),S(this,f+1,f+6),S(this,f+2,f+5),S(this,f+3,f+4);return this},h.prototype.toString=function(){const u=this.length;return u===0?"":arguments.length===0?B(this,0,u):j.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(u){if(!h.isBuffer(u))throw new TypeError("Argument must be a Buffer");return this===u?!0:h.compare(this,u)===0},h.prototype.inspect=function(){let u="";const f=r.INSPECT_MAX_BYTES;return u=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(u+=" ... "),"<Buffer "+u+">"},i&&(h.prototype[i]=h.prototype.inspect),h.prototype.compare=function(u,f,x,P,M){if(ot(u,s)&&(u=h.from(u,u.offset,u.byteLength)),!h.isBuffer(u))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof u);if(f===void 0&&(f=0),x===void 0&&(x=u?u.length:0),P===void 0&&(P=0),M===void 0&&(M=this.length),f<0||x>u.length||P<0||M>this.length)throw new RangeError("out of range index");if(P>=M&&f>=x)return 0;if(P>=M)return-1;if(f>=x)return 1;if(f>>>=0,x>>>=0,P>>>=0,M>>>=0,this===u)return 0;let $=M-P,mt=x-f;const zt=Math.min($,mt),$t=this.slice(P,M),Gt=u.slice(f,x);for(let Ft=0;Ft<zt;++Ft)if($t[Ft]!==Gt[Ft]){$=$t[Ft],mt=Gt[Ft];break}return $<mt?-1:mt<$?1:0};function T(y,u,f,x,P){if(y.length===0)return-1;if(typeof f=="string"?(x=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,Ee(f)&&(f=P?0:y.length-1),f<0&&(f=y.length+f),f>=y.length){if(P)return-1;f=y.length-1}else if(f<0)if(P)f=0;else return-1;if(typeof u=="string"&&(u=h.from(u,x)),h.isBuffer(u))return u.length===0?-1:F(y,u,f,x,P);if(typeof u=="number")return u=u&255,typeof s.prototype.indexOf=="function"?P?s.prototype.indexOf.call(y,u,f):s.prototype.lastIndexOf.call(y,u,f):F(y,[u],f,x,P);throw new TypeError("val must be string, number or Buffer")}function F(y,u,f,x,P){let M=1,$=y.length,mt=u.length;if(x!==void 0&&(x=String(x).toLowerCase(),x==="ucs2"||x==="ucs-2"||x==="utf16le"||x==="utf-16le")){if(y.length<2||u.length<2)return-1;M=2,$/=2,mt/=2,f/=2}function zt(Gt,Ft){return M===1?Gt[Ft]:Gt.readUInt16BE(Ft*M)}let $t;if(P){let Gt=-1;for($t=f;$t<$;$t++)if(zt(y,$t)===zt(u,Gt===-1?0:$t-Gt)){if(Gt===-1&&(Gt=$t),$t-Gt+1===mt)return Gt*M}else Gt!==-1&&($t-=$t-Gt),Gt=-1}else for(f+mt>$&&(f=$-mt),$t=f;$t>=0;$t--){let Gt=!0;for(let Ft=0;Ft<mt;Ft++)if(zt(y,$t+Ft)!==zt(u,Ft)){Gt=!1;break}if(Gt)return $t}return-1}h.prototype.includes=function(u,f,x){return this.indexOf(u,f,x)!==-1},h.prototype.indexOf=function(u,f,x){return T(this,u,f,x,!0)},h.prototype.lastIndexOf=function(u,f,x){return T(this,u,f,x,!1)};function k(y,u,f,x){f=Number(f)||0;const P=y.length-f;x?(x=Number(x),x>P&&(x=P)):x=P;const M=u.length;x>M/2&&(x=M/2);let $;for($=0;$<x;++$){const mt=parseInt(u.substr($*2,2),16);if(Ee(mt))return $;y[f+$]=mt}return $}function U(y,u,f,x){return Ht(Wt(u,y.length-f),y,f,x)}function H(y,u,f,x){return Ht(Ut(u),y,f,x)}function G(y,u,f,x){return Ht(Pt(u),y,f,x)}function K(y,u,f,x){return Ht(Tt(u,y.length-f),y,f,x)}h.prototype.write=function(u,f,x,P){if(f===void 0)P="utf8",x=this.length,f=0;else if(x===void 0&&typeof f=="string")P=f,x=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(x)?(x=x>>>0,P===void 0&&(P="utf8")):(P=x,x=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const M=this.length-f;if((x===void 0||x>M)&&(x=M),u.length>0&&(x<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");P||(P="utf8");let $=!1;for(;;)switch(P){case"hex":return k(this,u,f,x);case"utf8":case"utf-8":return U(this,u,f,x);case"ascii":case"latin1":case"binary":return H(this,u,f,x);case"base64":return G(this,u,f,x);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,u,f,x);default:if($)throw new TypeError("Unknown encoding: "+P);P=(""+P).toLowerCase(),$=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Z(y,u,f){return u===0&&f===y.length?t.fromByteArray(y):t.fromByteArray(y.slice(u,f))}function B(y,u,f){f=Math.min(y.length,f);const x=[];let P=u;for(;P<f;){const M=y[P];let $=null,mt=M>239?4:M>223?3:M>191?2:1;if(P+mt<=f){let zt,$t,Gt,Ft;switch(mt){case 1:M<128&&($=M);break;case 2:zt=y[P+1],(zt&192)===128&&(Ft=(M&31)<<6|zt&63,Ft>127&&($=Ft));break;case 3:zt=y[P+1],$t=y[P+2],(zt&192)===128&&($t&192)===128&&(Ft=(M&15)<<12|(zt&63)<<6|$t&63,Ft>2047&&(Ft<55296||Ft>57343)&&($=Ft));break;case 4:zt=y[P+1],$t=y[P+2],Gt=y[P+3],(zt&192)===128&&($t&192)===128&&(Gt&192)===128&&(Ft=(M&15)<<18|(zt&63)<<12|($t&63)<<6|Gt&63,Ft>65535&&Ft<1114112&&($=Ft))}}$===null?($=65533,mt=1):$>65535&&($-=65536,x.push($>>>10&1023|55296),$=56320|$&1023),x.push($),P+=mt}return q(x)}const W=4096;function q(y){const u=y.length;if(u<=W)return String.fromCharCode.apply(String,y);let f="",x=0;for(;x<u;)f+=String.fromCharCode.apply(String,y.slice(x,x+=W));return f}function xt(y,u,f){let x="";f=Math.min(y.length,f);for(let P=u;P<f;++P)x+=String.fromCharCode(y[P]&127);return x}function vt(y,u,f){let x="";f=Math.min(y.length,f);for(let P=u;P<f;++P)x+=String.fromCharCode(y[P]);return x}function V(y,u,f){const x=y.length;(!u||u<0)&&(u=0),(!f||f<0||f>x)&&(f=x);let P="";for(let M=u;M<f;++M)P+=_e[y[M]];return P}function it(y,u,f){const x=y.slice(u,f);let P="";for(let M=0;M<x.length-1;M+=2)P+=String.fromCharCode(x[M]+x[M+1]*256);return P}h.prototype.slice=function(u,f){const x=this.length;u=~~u,f=f===void 0?x:~~f,u<0?(u+=x,u<0&&(u=0)):u>x&&(u=x),f<0?(f+=x,f<0&&(f=0)):f>x&&(f=x),f<u&&(f=u);const P=this.subarray(u,f);return Object.setPrototypeOf(P,h.prototype),P};function et(y,u,f){if(y%1!==0||y<0)throw new RangeError("offset is not uint");if(y+u>f)throw new RangeError("Trying to access beyond buffer length")}h.prototype.readUintLE=h.prototype.readUIntLE=function(u,f,x){u=u>>>0,f=f>>>0,x||et(u,f,this.length);let P=this[u],M=1,$=0;for(;++$<f&&(M*=256);)P+=this[u+$]*M;return P},h.prototype.readUintBE=h.prototype.readUIntBE=function(u,f,x){u=u>>>0,f=f>>>0,x||et(u,f,this.length);let P=this[u+--f],M=1;for(;f>0&&(M*=256);)P+=this[u+--f]*M;return P},h.prototype.readUint8=h.prototype.readUInt8=function(u,f){return u=u>>>0,f||et(u,1,this.length),this[u]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(u,f){return u=u>>>0,f||et(u,2,this.length),this[u]|this[u+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(u,f){return u=u>>>0,f||et(u,2,this.length),this[u]<<8|this[u+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(u,f){return u=u>>>0,f||et(u,4,this.length),(this[u]|this[u+1]<<8|this[u+2]<<16)+this[u+3]*16777216},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(u,f){return u=u>>>0,f||et(u,4,this.length),this[u]*16777216+(this[u+1]<<16|this[u+2]<<8|this[u+3])},h.prototype.readBigUInt64LE=se(function(u){u=u>>>0,X(u,"offset");const f=this[u],x=this[u+7];(f===void 0||x===void 0)&&ft(u,this.length-8);const P=f+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24,M=this[++u]+this[++u]*2**8+this[++u]*2**16+x*2**24;return BigInt(P)+(BigInt(M)<<BigInt(32))}),h.prototype.readBigUInt64BE=se(function(u){u=u>>>0,X(u,"offset");const f=this[u],x=this[u+7];(f===void 0||x===void 0)&&ft(u,this.length-8);const P=f*2**24+this[++u]*2**16+this[++u]*2**8+this[++u],M=this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+x;return(BigInt(P)<<BigInt(32))+BigInt(M)}),h.prototype.readIntLE=function(u,f,x){u=u>>>0,f=f>>>0,x||et(u,f,this.length);let P=this[u],M=1,$=0;for(;++$<f&&(M*=256);)P+=this[u+$]*M;return M*=128,P>=M&&(P-=Math.pow(2,8*f)),P},h.prototype.readIntBE=function(u,f,x){u=u>>>0,f=f>>>0,x||et(u,f,this.length);let P=f,M=1,$=this[u+--P];for(;P>0&&(M*=256);)$+=this[u+--P]*M;return M*=128,$>=M&&($-=Math.pow(2,8*f)),$},h.prototype.readInt8=function(u,f){return u=u>>>0,f||et(u,1,this.length),this[u]&128?(255-this[u]+1)*-1:this[u]},h.prototype.readInt16LE=function(u,f){u=u>>>0,f||et(u,2,this.length);const x=this[u]|this[u+1]<<8;return x&32768?x|4294901760:x},h.prototype.readInt16BE=function(u,f){u=u>>>0,f||et(u,2,this.length);const x=this[u+1]|this[u]<<8;return x&32768?x|4294901760:x},h.prototype.readInt32LE=function(u,f){return u=u>>>0,f||et(u,4,this.length),this[u]|this[u+1]<<8|this[u+2]<<16|this[u+3]<<24},h.prototype.readInt32BE=function(u,f){return u=u>>>0,f||et(u,4,this.length),this[u]<<24|this[u+1]<<16|this[u+2]<<8|this[u+3]},h.prototype.readBigInt64LE=se(function(u){u=u>>>0,X(u,"offset");const f=this[u],x=this[u+7];(f===void 0||x===void 0)&&ft(u,this.length-8);const P=this[u+4]+this[u+5]*2**8+this[u+6]*2**16+(x<<24);return(BigInt(P)<<BigInt(32))+BigInt(f+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24)}),h.prototype.readBigInt64BE=se(function(u){u=u>>>0,X(u,"offset");const f=this[u],x=this[u+7];(f===void 0||x===void 0)&&ft(u,this.length-8);const P=(f<<24)+this[++u]*2**16+this[++u]*2**8+this[++u];return(BigInt(P)<<BigInt(32))+BigInt(this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+x)}),h.prototype.readFloatLE=function(u,f){return u=u>>>0,f||et(u,4,this.length),e.read(this,u,!0,23,4)},h.prototype.readFloatBE=function(u,f){return u=u>>>0,f||et(u,4,this.length),e.read(this,u,!1,23,4)},h.prototype.readDoubleLE=function(u,f){return u=u>>>0,f||et(u,8,this.length),e.read(this,u,!0,52,8)},h.prototype.readDoubleBE=function(u,f){return u=u>>>0,f||et(u,8,this.length),e.read(this,u,!1,52,8)};function nt(y,u,f,x,P,M){if(!h.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(u>P||u<M)throw new RangeError('"value" argument is out of bounds');if(f+x>y.length)throw new RangeError("Index out of range")}h.prototype.writeUintLE=h.prototype.writeUIntLE=function(u,f,x,P){if(u=+u,f=f>>>0,x=x>>>0,!P){const mt=Math.pow(2,8*x)-1;nt(this,u,f,x,mt,0)}let M=1,$=0;for(this[f]=u&255;++$<x&&(M*=256);)this[f+$]=u/M&255;return f+x},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(u,f,x,P){if(u=+u,f=f>>>0,x=x>>>0,!P){const mt=Math.pow(2,8*x)-1;nt(this,u,f,x,mt,0)}let M=x-1,$=1;for(this[f+M]=u&255;--M>=0&&($*=256);)this[f+M]=u/$&255;return f+x},h.prototype.writeUint8=h.prototype.writeUInt8=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,1,255,0),this[f]=u&255,f+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,2,65535,0),this[f]=u&255,this[f+1]=u>>>8,f+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,2,65535,0),this[f]=u>>>8,this[f+1]=u&255,f+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,4,4294967295,0),this[f+3]=u>>>24,this[f+2]=u>>>16,this[f+1]=u>>>8,this[f]=u&255,f+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,4,4294967295,0),this[f]=u>>>24,this[f+1]=u>>>16,this[f+2]=u>>>8,this[f+3]=u&255,f+4};function dt(y,u,f,x,P){gt(u,x,P,y,f,7);let M=Number(u&BigInt(4294967295));y[f++]=M,M=M>>8,y[f++]=M,M=M>>8,y[f++]=M,M=M>>8,y[f++]=M;let $=Number(u>>BigInt(32)&BigInt(4294967295));return y[f++]=$,$=$>>8,y[f++]=$,$=$>>8,y[f++]=$,$=$>>8,y[f++]=$,f}function Q(y,u,f,x,P){gt(u,x,P,y,f,7);let M=Number(u&BigInt(4294967295));y[f+7]=M,M=M>>8,y[f+6]=M,M=M>>8,y[f+5]=M,M=M>>8,y[f+4]=M;let $=Number(u>>BigInt(32)&BigInt(4294967295));return y[f+3]=$,$=$>>8,y[f+2]=$,$=$>>8,y[f+1]=$,$=$>>8,y[f]=$,f+8}h.prototype.writeBigUInt64LE=se(function(u,f=0){return dt(this,u,f,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeBigUInt64BE=se(function(u,f=0){return Q(this,u,f,BigInt(0),BigInt("0xffffffffffffffff"))}),h.prototype.writeIntLE=function(u,f,x,P){if(u=+u,f=f>>>0,!P){const zt=Math.pow(2,8*x-1);nt(this,u,f,x,zt-1,-zt)}let M=0,$=1,mt=0;for(this[f]=u&255;++M<x&&($*=256);)u<0&&mt===0&&this[f+M-1]!==0&&(mt=1),this[f+M]=(u/$>>0)-mt&255;return f+x},h.prototype.writeIntBE=function(u,f,x,P){if(u=+u,f=f>>>0,!P){const zt=Math.pow(2,8*x-1);nt(this,u,f,x,zt-1,-zt)}let M=x-1,$=1,mt=0;for(this[f+M]=u&255;--M>=0&&($*=256);)u<0&&mt===0&&this[f+M+1]!==0&&(mt=1),this[f+M]=(u/$>>0)-mt&255;return f+x},h.prototype.writeInt8=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,1,127,-128),u<0&&(u=255+u+1),this[f]=u&255,f+1},h.prototype.writeInt16LE=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,2,32767,-32768),this[f]=u&255,this[f+1]=u>>>8,f+2},h.prototype.writeInt16BE=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,2,32767,-32768),this[f]=u>>>8,this[f+1]=u&255,f+2},h.prototype.writeInt32LE=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,4,2147483647,-2147483648),this[f]=u&255,this[f+1]=u>>>8,this[f+2]=u>>>16,this[f+3]=u>>>24,f+4},h.prototype.writeInt32BE=function(u,f,x){return u=+u,f=f>>>0,x||nt(this,u,f,4,2147483647,-2147483648),u<0&&(u=4294967295+u+1),this[f]=u>>>24,this[f+1]=u>>>16,this[f+2]=u>>>8,this[f+3]=u&255,f+4},h.prototype.writeBigInt64LE=se(function(u,f=0){return dt(this,u,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),h.prototype.writeBigInt64BE=se(function(u,f=0){return Q(this,u,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function _t(y,u,f,x,P,M){if(f+x>y.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function Y(y,u,f,x,P){return u=+u,f=f>>>0,P||_t(y,u,f,4),e.write(y,u,f,x,23,4),f+4}h.prototype.writeFloatLE=function(u,f,x){return Y(this,u,f,!0,x)},h.prototype.writeFloatBE=function(u,f,x){return Y(this,u,f,!1,x)};function tt(y,u,f,x,P){return u=+u,f=f>>>0,P||_t(y,u,f,8),e.write(y,u,f,x,52,8),f+8}h.prototype.writeDoubleLE=function(u,f,x){return tt(this,u,f,!0,x)},h.prototype.writeDoubleBE=function(u,f,x){return tt(this,u,f,!1,x)},h.prototype.copy=function(u,f,x,P){if(!h.isBuffer(u))throw new TypeError("argument should be a Buffer");if(x||(x=0),!P&&P!==0&&(P=this.length),f>=u.length&&(f=u.length),f||(f=0),P>0&&P<x&&(P=x),P===x||u.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(x<0||x>=this.length)throw new RangeError("Index out of range");if(P<0)throw new RangeError("sourceEnd out of bounds");P>this.length&&(P=this.length),u.length-f<P-x&&(P=u.length-f+x);const M=P-x;return this===u&&typeof s.prototype.copyWithin=="function"?this.copyWithin(f,x,P):s.prototype.set.call(u,this.subarray(x,P),f),M},h.prototype.fill=function(u,f,x,P){if(typeof u=="string"){if(typeof f=="string"?(P=f,f=0,x=this.length):typeof x=="string"&&(P=x,x=this.length),P!==void 0&&typeof P!="string")throw new TypeError("encoding must be a string");if(typeof P=="string"&&!h.isEncoding(P))throw new TypeError("Unknown encoding: "+P);if(u.length===1){const $=u.charCodeAt(0);(P==="utf8"&&$<128||P==="latin1")&&(u=$)}}else typeof u=="number"?u=u&255:typeof u=="boolean"&&(u=Number(u));if(f<0||this.length<f||this.length<x)throw new RangeError("Out of range index");if(x<=f)return this;f=f>>>0,x=x===void 0?this.length:x>>>0,u||(u=0);let M;if(typeof u=="number")for(M=f;M<x;++M)this[M]=u;else{const $=h.isBuffer(u)?u:h.from(u,P),mt=$.length;if(mt===0)throw new TypeError('The value "'+u+'" is invalid for argument "value"');for(M=0;M<x-f;++M)this[M+f]=$[M%mt]}return this};const ut={};function St(y,u,f){ut[y]=class extends f{constructor(){super(),Object.defineProperty(this,"message",{value:u.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${y}]`,this.stack,delete this.name}get code(){return y}set code(P){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:P,writable:!0})}toString(){return`${this.name} [${y}]: ${this.message}`}}}St("ERR_BUFFER_OUT_OF_BOUNDS",function(y){return y?`${y} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),St("ERR_INVALID_ARG_TYPE",function(y,u){return`The "${y}" argument must be of type number. Received type ${typeof u}`},TypeError),St("ERR_OUT_OF_RANGE",function(y,u,f){let x=`The value of "${y}" is out of range.`,P=f;return Number.isInteger(f)&&Math.abs(f)>2**32?P=at(String(f)):typeof f=="bigint"&&(P=String(f),(f>BigInt(2)**BigInt(32)||f<-(BigInt(2)**BigInt(32)))&&(P=at(P)),P+="n"),x+=` It must be ${u}. Received ${P}`,x},RangeError);function at(y){let u="",f=y.length;const x=y[0]==="-"?1:0;for(;f>=x+4;f-=3)u=`_${y.slice(f-3,f)}${u}`;return`${y.slice(0,f)}${u}`}function wt(y,u,f){X(u,"offset"),(y[u]===void 0||y[u+f]===void 0)&&ft(u,y.length-(f+1))}function gt(y,u,f,x,P,M){if(y>f||y<u){const $=typeof u=="bigint"?"n":"";let mt;throw u===0||u===BigInt(0)?mt=`>= 0${$} and < 2${$} ** ${(M+1)*8}${$}`:mt=`>= -(2${$} ** ${(M+1)*8-1}${$}) and < 2 ** ${(M+1)*8-1}${$}`,new ut.ERR_OUT_OF_RANGE("value",mt,y)}wt(x,P,M)}function X(y,u){if(typeof y!="number")throw new ut.ERR_INVALID_ARG_TYPE(u,"number",y)}function ft(y,u,f){throw Math.floor(y)!==y?(X(y,f),new ut.ERR_OUT_OF_RANGE("offset","an integer",y)):u<0?new ut.ERR_BUFFER_OUT_OF_BOUNDS:new ut.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${u}`,y)}const Ct=/[^+/0-9A-Za-z-_]/g;function Nt(y){if(y=y.split("=")[0],y=y.trim().replace(Ct,""),y.length<2)return"";for(;y.length%4!==0;)y=y+"=";return y}function Wt(y,u){u=u||1/0;let f;const x=y.length;let P=null;const M=[];for(let $=0;$<x;++$){if(f=y.charCodeAt($),f>55295&&f<57344){if(!P){if(f>56319){(u-=3)>-1&&M.push(239,191,189);continue}else if($+1===x){(u-=3)>-1&&M.push(239,191,189);continue}P=f;continue}if(f<56320){(u-=3)>-1&&M.push(239,191,189),P=f;continue}f=(P-55296<<10|f-56320)+65536}else P&&(u-=3)>-1&&M.push(239,191,189);if(P=null,f<128){if((u-=1)<0)break;M.push(f)}else if(f<2048){if((u-=2)<0)break;M.push(f>>6|192,f&63|128)}else if(f<65536){if((u-=3)<0)break;M.push(f>>12|224,f>>6&63|128,f&63|128)}else if(f<1114112){if((u-=4)<0)break;M.push(f>>18|240,f>>12&63|128,f>>6&63|128,f&63|128)}else throw new Error("Invalid code point")}return M}function Ut(y){const u=[];for(let f=0;f<y.length;++f)u.push(y.charCodeAt(f)&255);return u}function Tt(y,u){let f,x,P;const M=[];for(let $=0;$<y.length&&!((u-=2)<0);++$)f=y.charCodeAt($),x=f>>8,P=f%256,M.push(P),M.push(x);return M}function Pt(y){return t.toByteArray(Nt(y))}function Ht(y,u,f,x){let P;for(P=0;P<x&&!(P+f>=u.length||P>=y.length);++P)u[P+f]=y[P];return P}function ot(y,u){return y instanceof u||y!=null&&y.constructor!=null&&y.constructor.name!=null&&y.constructor.name===u.name}function Ee(y){return y!==y}const _e=function(){const y="0123456789abcdef",u=new Array(256);for(let f=0;f<16;++f){const x=f*16;for(let P=0;P<16;++P)u[x+P]=y[f]+y[P]}return u}();function se(y){return typeof BigInt>"u"?Ye:y}function Ye(){throw new Error("BigInt not supported")}})(ne);const md=ne.Buffer,NS=ne.Blob,BS=ne.BlobOptions,$S=ne.Buffer,jS=ne.File,US=ne.FileOptions,HS=ne.INSPECT_MAX_BYTES,zS=ne.SlowBuffer,GS=ne.TranscodeEncoding,VS=ne.atob,WS=ne.btoa,qS=ne.constants,XS=ne.isAscii,YS=ne.isUtf8,KS=ne.kMaxLength,ZS=ne.kStringMaxLength,JS=ne.resolveObjectURL,QS=ne.transcode,tC=Object.freeze(Object.defineProperty({__proto__:null,Blob:NS,BlobOptions:BS,Buffer:$S,File:jS,FileOptions:US,INSPECT_MAX_BYTES:HS,SlowBuffer:zS,TranscodeEncoding:GS,atob:VS,btoa:WS,constants:qS,default:md,isAscii:XS,isUtf8:YS,kMaxLength:KS,kStringMaxLength:ZS,resolveObjectURL:JS,transcode:QS},Symbol.toStringTag,{value:"Module"}));var Ho={};Ho.d=(r,t)=>{for(var e in t)Ho.o(t,e)&&!Ho.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:t[e]})};Ho.o=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);var rt=globalThis.pdfjsLib={};Ho.d(rt,{AbortException:()=>Br,AnnotationEditorLayer:()=>Cg,AnnotationEditorParamsType:()=>lt,AnnotationEditorType:()=>yt,AnnotationEditorUIManager:()=>kr,AnnotationLayer:()=>JT,AnnotationMode:()=>On,CMapCompressionType:()=>mp,ColorPicker:()=>Ed,DOMSVGFactory:()=>Jg,DrawLayer:()=>Lg,FeatureTest:()=>Oe,GlobalWorkerOptions:()=>Pn,ImageKind:()=>jh,InvalidPDFException:()=>uv,MissingPDFException:()=>Nr,OPS:()=>si,Outliner:()=>og,PDFDataRangeTransport:()=>sb,PDFDateString:()=>yv,PDFWorker:()=>Qr,PasswordResponses:()=>sC,PermissionFlag:()=>nC,PixelsPerInch:()=>hs,RenderingCancelledException:()=>Qg,TextLayer:()=>wd,UnexpectedResponseException:()=>mf,Util:()=>J,VerbosityLevel:()=>ff,XfaLayer:()=>ab,build:()=>IT,createValidAbsoluteUrl:()=>lC,fetchData:()=>Ef,getDocument:()=>_T,getFilenameFromUrl:()=>bC,getPdfFilenameFromUrl:()=>yC,getXfaPageViewport:()=>wC,isDataScheme:()=>tm,isPdfFile:()=>em,noContextMenu:()=>Ne,normalizeUnicode:()=>pC,renderTextLayer:()=>pT,setLayerDimensions:()=>Lr,shadow:()=>Et,updateTextLayer:()=>gT,version:()=>kT});const Ae=typeof Ki=="object"&&Ki+""=="[object process]"&&!Ki.versions.nw&&!(Ki.versions.electron&&Ki.type&&Ki.type!=="browser"),dv=[1,0,0,1,0,0],gp=[.001,0,0,.001,0,0],eC=1e7,Jf=1.35,ii={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},On={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},iC="pdfjs_internal_editor_",yt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},lt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},nC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},ve={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},jh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Zt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},xo={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ff={ERRORS:0,WARNINGS:1,INFOS:5},mp={NONE:0,BINARY:1},si={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},sC={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let pf=ff.WARNINGS;function rC(r){Number.isInteger(r)&&(pf=r)}function aC(){return pf}function gf(r){pf>=ff.INFOS&&console.log(`Info: ${r}`)}function pt(r){pf>=ff.WARNINGS&&console.log(`Warning: ${r}`)}function It(r){throw new Error(r)}function ie(r,t){r||It(t)}function oC(r){switch(r==null?void 0:r.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function lC(r,t=null,e=null){if(!r)return null;try{if(e&&typeof r=="string"){if(e.addDefaultProtocol&&r.startsWith("www.")){const n=r.match(/\./g);(n==null?void 0:n.length)>=2&&(r=`http://${r}`)}if(e.tryConvertEncoding)try{r=fC(r)}catch{}}const i=t?new URL(r,t):new URL(r);if(oC(i))return i}catch{}return null}function Et(r,t,e,i=!1){return Object.defineProperty(r,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const fs=function(){function t(e,i){this.constructor===t&&It("Cannot initialize BaseException."),this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t}();class vp extends fs{constructor(t,e){super(t,"PasswordException"),this.code=e}}class bp extends fs{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class uv extends fs{constructor(t){super(t,"InvalidPDFException")}}class Nr extends fs{constructor(t){super(t,"MissingPDFException")}}class mf extends fs{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class cC extends fs{constructor(t){super(t,"FormatError")}}class Br extends fs{constructor(t){super(t,"AbortException")}}function fv(r){(typeof r!="object"||(r==null?void 0:r.length)===void 0)&&It("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const i=[];for(let n=0;n<t;n+=e){const s=Math.min(n+e,t),a=r.subarray(n,s);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function vf(r){typeof r!="string"&&It("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=r.charCodeAt(i)&255;return e}function hC(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function Kg(r){const t=Object.create(null);for(const[e,i]of r)t[e]=i;return t}function dC(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function uC(){try{return new Function(""),!0}catch{return!1}}class Oe{static get isLittleEndian(){return Et(this,"isLittleEndian",dC())}static get isEvalSupported(){return Et(this,"isEvalSupported",uC())}static get isOffscreenCanvasSupported(){return Et(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Et(this,"platform",{isMac:navigator.platform.includes("Mac")}):Et(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var t,e;return Et(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const Qf=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));var ia,Uh,Xo,yp;class J{static makeHexColor(t,e,i){return`#${Qf[t]}${Qf[e]}${Qf[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const i=t[0]*e[0]+t[1]*e[2]+e[4],n=t[0]*e[1]+t[1]*e[3]+e[5];return[i,n]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2],n=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,s=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i;return[n,s]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),n=this.applyTransform(t.slice(2,4),e),s=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],n[0],s[0],a[0]),Math.min(i[1],n[1],s[1],a[1]),Math.max(i[0],n[0],s[0],a[0]),Math.max(i[1],n[1],s[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],n=t[0]*e[1]+t[1]*e[3],s=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],l=(i+a)/2,c=Math.sqrt((i+a)**2-4*(i*a-s*n))/2,d=l+c||1,h=l-c||1;return[Math.sqrt(d),Math.sqrt(h)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>n)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>a?null:[i,s,n,a]}static bezierBoundingBox(t,e,i,n,s,a,l,c,d){return d?(d[0]=Math.min(d[0],t,l),d[1]=Math.min(d[1],e,c),d[2]=Math.max(d[2],t,l),d[3]=Math.max(d[3],e,c)):d=[Math.min(t,l),Math.min(e,c),Math.max(t,l),Math.max(e,c)],A(this,Xo,yp).call(this,t,i,s,l,e,n,a,c,3*(-t+3*(i-s)+l),6*(t-2*i+s),3*(i-t),d),A(this,Xo,yp).call(this,t,i,s,l,e,n,a,c,3*(-e+3*(n-a)+c),6*(e-2*n+a),3*(n-e),d),d}}ia=new WeakSet,Uh=function(t,e,i,n,s,a,l,c,d,h){if(d<=0||d>=1)return;const p=1-d,g=d*d,v=g*d,b=p*(p*(p*t+3*d*e)+3*g*i)+v*n,E=p*(p*(p*s+3*d*a)+3*g*l)+v*c;h[0]=Math.min(h[0],b),h[1]=Math.min(h[1],E),h[2]=Math.max(h[2],b),h[3]=Math.max(h[3],E)},Xo=new WeakSet,yp=function(t,e,i,n,s,a,l,c,d,h,p,g){if(Math.abs(d)<1e-12){Math.abs(h)>=1e-12&&A(this,ia,Uh).call(this,t,e,i,n,s,a,l,c,-p/h,g);return}const v=h**2-4*p*d;if(v<0)return;const b=Math.sqrt(v),E=2*d;A(this,ia,Uh).call(this,t,e,i,n,s,a,l,c,(-h+b)/E,g),A(this,ia,Uh).call(this,t,e,i,n,s,a,l,c,(-h-b)/E,g)},m(J,ia),m(J,Xo);function fC(r){return decodeURIComponent(escape(r))}let tp=null,Nm=null;function pC(r){return tp||(tp=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Nm=new Map([["ﬅ","ſt"]])),r.replaceAll(tp,(t,e,i)=>e?e.normalize("NFKC"):Nm.get(i))}function gC(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const r=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(r);else for(let t=0;t<32;t++)r[t]=Math.floor(Math.random()*255);return fv(r)}const pv="pdfjs_internal_id_",Gi={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};class bf{constructor(){this.constructor===bf&&It("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,n,s){return"none"}destroy(t=!1){}}class yf{constructor(){this.constructor===yf&&It("Cannot initialize BaseCanvasFactory.")}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d")}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){It("Abstract method `_createCanvas` called.")}}class wf{constructor({baseUrl:t=null,isCompressed:e=!0}){this.constructor===wf&&It("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":""),i=this.isCompressed?mp.BINARY:mp.NONE;return this._fetchData(e,i).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}_fetchData(t,e){It("Abstract method `_fetchData` called.")}}class Af{constructor({baseUrl:t=null}){this.constructor===Af&&It("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetchData(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}_fetchData(t){It("Abstract method `_fetchData` called.")}}class Zg{constructor(){this.constructor===Zg&&It("Cannot initialize BaseSVGFactory.")}create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),i||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){It("Abstract method `_createSVG` called.")}}const Wi="http://www.w3.org/2000/svg",ws=class ws{};ct(ws,"CSS",96),ct(ws,"PDF",72),ct(ws,"PDF_TO_CSS_UNITS",ws.CSS/ws.PDF);let hs=ws;var _s,Ai,Ji,ke,Sd,xs,ae,be,Bn,Hr,$n,zr,na,Hh,Cd,gv,Yo,wp,jn,Gr,Ss,To,Cs,Po,Ko,Ap,Ts,Ro;class mC extends bf{constructor({docId:e,ownerDocument:i=globalThis.document}={}){super();m(this,ae);m(this,Bn);m(this,$n);m(this,na);m(this,Cd);m(this,Yo);m(this,jn);m(this,Ss);m(this,Cs);m(this,Ko);m(this,Ts);m(this,_s,void 0);m(this,Ai,void 0);m(this,Ji,void 0);m(this,ke,void 0);m(this,Sd,void 0);m(this,xs,0);w(this,Ji,e),w(this,ke,i)}addFilter(e){if(!e)return"none";let i=o(this,ae,be).get(e);if(i)return i;const[n,s,a]=A(this,na,Hh).call(this,e),l=e.length===1?n:`${n}${s}${a}`;if(i=o(this,ae,be).get(l),i)return o(this,ae,be).set(e,i),i;const c=`g_${o(this,Ji)}_transfer_map_${Be(this,xs)._++}`,d=`url(#${c})`;o(this,ae,be).set(e,d),o(this,ae,be).set(l,d);const h=A(this,jn,Gr).call(this,c);return A(this,Cs,Po).call(this,n,s,a,h),d}addHCMFilter(e,i){var b;const n=`${e}-${i}`,s="base";let a=o(this,Bn,Hr).get(s);if((a==null?void 0:a.key)===n||(a?((b=a.filter)==null||b.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},o(this,Bn,Hr).set(s,a)),!e||!i))return a.url;const l=A(this,Ts,Ro).call(this,e);e=J.makeHexColor(...l);const c=A(this,Ts,Ro).call(this,i);if(i=J.makeHexColor(...c),o(this,$n,zr).style.color="",e==="#000000"&&i==="#ffffff"||e===i)return a.url;const d=new Array(256);for(let E=0;E<=255;E++){const C=E/255;d[E]=C<=.03928?C/12.92:((C+.055)/1.055)**2.4}const h=d.join(","),p=`g_${o(this,Ji)}_hcm_filter`,g=a.filter=A(this,jn,Gr).call(this,p);A(this,Cs,Po).call(this,h,h,h,g),A(this,Yo,wp).call(this,g);const v=(E,C)=>{const _=l[E]/255,R=c[E]/255,L=new Array(C+1);for(let D=0;D<=C;D++)L[D]=_+D/C*(R-_);return L.join(",")};return A(this,Cs,Po).call(this,v(0,5),v(1,5),v(2,5),g),a.url=`url(#${p})`,a.url}addAlphaFilter(e){let i=o(this,ae,be).get(e);if(i)return i;const[n]=A(this,na,Hh).call(this,[e]),s=`alpha_${n}`;if(i=o(this,ae,be).get(s),i)return o(this,ae,be).set(e,i),i;const a=`g_${o(this,Ji)}_alpha_map_${Be(this,xs)._++}`,l=`url(#${a})`;o(this,ae,be).set(e,l),o(this,ae,be).set(s,l);const c=A(this,jn,Gr).call(this,a);return A(this,Ko,Ap).call(this,n,c),l}addLuminosityFilter(e){let i=o(this,ae,be).get(e||"luminosity");if(i)return i;let n,s;if(e?([n]=A(this,na,Hh).call(this,[e]),s=`luminosity_${n}`):s="luminosity",i=o(this,ae,be).get(s),i)return o(this,ae,be).set(e,i),i;const a=`g_${o(this,Ji)}_luminosity_map_${Be(this,xs)._++}`,l=`url(#${a})`;o(this,ae,be).set(e,l),o(this,ae,be).set(s,l);const c=A(this,jn,Gr).call(this,a);return A(this,Cd,gv).call(this,c),e&&A(this,Ko,Ap).call(this,n,c),l}addHighlightHCMFilter(e,i,n,s,a){var R;const l=`${i}-${n}-${s}-${a}`;let c=o(this,Bn,Hr).get(e);if((c==null?void 0:c.key)===l||(c?((R=c.filter)==null||R.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},o(this,Bn,Hr).set(e,c)),!i||!n))return c.url;const[d,h]=[i,n].map(A(this,Ts,Ro).bind(this));let p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[v,b]=[s,a].map(A(this,Ts,Ro).bind(this));g<p&&([p,g,v,b]=[g,p,b,v]),o(this,$n,zr).style.color="";const E=(L,D,O)=>{const N=new Array(256),j=(g-p)/O,S=L/255,T=(D-L)/(255*O);let F=0;for(let k=0;k<=O;k++){const U=Math.round(p+k*j),H=S+k*T;for(let G=F;G<=U;G++)N[G]=H;F=U+1}for(let k=F;k<256;k++)N[k]=N[F-1];return N.join(",")},C=`g_${o(this,Ji)}_hcm_${e}_filter`,_=c.filter=A(this,jn,Gr).call(this,C);return A(this,Yo,wp).call(this,_),A(this,Cs,Po).call(this,E(v[0],b[0],5),E(v[1],b[1],5),E(v[2],b[2],5),_),c.url=`url(#${C})`,c.url}destroy(e=!1){e&&o(this,Bn,Hr).size!==0||(o(this,Ai)&&(o(this,Ai).parentNode.parentNode.remove(),w(this,Ai,null)),o(this,_s)&&(o(this,_s).clear(),w(this,_s,null)),w(this,xs,0))}}_s=new WeakMap,Ai=new WeakMap,Ji=new WeakMap,ke=new WeakMap,Sd=new WeakMap,xs=new WeakMap,ae=new WeakSet,be=function(){return o(this,_s)||w(this,_s,new Map)},Bn=new WeakSet,Hr=function(){return o(this,Sd)||w(this,Sd,new Map)},$n=new WeakSet,zr=function(){if(!o(this,Ai)){const e=o(this,ke).createElement("div"),{style:i}=e;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const n=o(this,ke).createElementNS(Wi,"svg");n.setAttribute("width",0),n.setAttribute("height",0),w(this,Ai,o(this,ke).createElementNS(Wi,"defs")),e.append(n),n.append(o(this,Ai)),o(this,ke).body.append(e)}return o(this,Ai)},na=new WeakSet,Hh=function(e){if(e.length===1){const d=e[0],h=new Array(256);for(let g=0;g<256;g++)h[g]=d[g]/255;const p=h.join(",");return[p,p,p]}const[i,n,s]=e,a=new Array(256),l=new Array(256),c=new Array(256);for(let d=0;d<256;d++)a[d]=i[d]/255,l[d]=n[d]/255,c[d]=s[d]/255;return[a.join(","),l.join(","),c.join(",")]},Cd=new WeakSet,gv=function(e){const i=o(this,ke).createElementNS(Wi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(i)},Yo=new WeakSet,wp=function(e){const i=o(this,ke).createElementNS(Wi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(i)},jn=new WeakSet,Gr=function(e){const i=o(this,ke).createElementNS(Wi,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",e),o(this,$n,zr).append(i),i},Ss=new WeakSet,To=function(e,i,n){const s=o(this,ke).createElementNS(Wi,i);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)},Cs=new WeakSet,Po=function(e,i,n,s){const a=o(this,ke).createElementNS(Wi,"feComponentTransfer");s.append(a),A(this,Ss,To).call(this,a,"feFuncR",e),A(this,Ss,To).call(this,a,"feFuncG",i),A(this,Ss,To).call(this,a,"feFuncB",n)},Ko=new WeakSet,Ap=function(e,i){const n=o(this,ke).createElementNS(Wi,"feComponentTransfer");i.append(n),A(this,Ss,To).call(this,n,"feFuncA",e)},Ts=new WeakSet,Ro=function(e){return o(this,$n,zr).style.color=e,im(getComputedStyle(o(this,$n,zr)).getPropertyValue("color"))};class vC extends yf{constructor({ownerDocument:t=globalThis.document}={}){super(),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}async function Ef(r,t="text"){if(Lo(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const n=new XMLHttpRequest;n.open("GET",r,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(n.response);return}e(n.responseText);return}i(new Error(n.statusText))}},n.send(null)})}class mv extends wf{_fetchData(t,e){return Ef(t,this.isCompressed?"arraybuffer":"text").then(i=>({cMapData:i instanceof ArrayBuffer?new Uint8Array(i):vf(i),compressionType:e}))}}class vv extends Af{_fetchData(t){return Ef(t,"arraybuffer").then(e=>new Uint8Array(e))}}class Jg extends Zg{_createSVG(t){return document.createElementNS(Wi,t)}}class wh{constructor({viewBox:t,scale:e,rotation:i,offsetX:n=0,offsetY:s=0,dontFlip:a=!1}){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=n,this.offsetY=s;const l=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let d,h,p,g;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,h=0,p=0,g=1;break;case 90:d=0,h=1,p=1,g=0;break;case 270:d=0,h=-1,p=-1,g=0;break;case 0:d=1,h=0,p=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(p=-p,g=-g);let v,b,E,C;d===0?(v=Math.abs(c-t[1])*e+n,b=Math.abs(l-t[0])*e+s,E=(t[3]-t[1])*e,C=(t[2]-t[0])*e):(v=Math.abs(l-t[0])*e+n,b=Math.abs(c-t[1])*e+s,E=(t[2]-t[0])*e,C=(t[3]-t[1])*e),this.transform=[d*e,h*e,p*e,g*e,v-d*e*l-p*e*c,b-h*e*l-g*e*c],this.width=E,this.height=C}get rawDims(){const{viewBox:t}=this;return Et(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:n=this.offsetY,dontFlip:s=!1}={}){return new wh({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}convertToViewportPoint(t,e){return J.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=J.applyTransform([t[0],t[1]],this.transform),i=J.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return J.applyInverseTransform([t,e],this.transform)}}class Qg extends fs{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function tm(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function em(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function bC(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function yC(r,t="document.pdf"){if(typeof r!="string")return t;if(tm(r))return pt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=e.exec(r);let s=i.exec(n[1])||i.exec(n[2])||i.exec(n[3]);if(s&&(s=s[0],s.includes("%")))try{s=i.exec(decodeURIComponent(s))[0]}catch{}return s||t}class Bm{constructor(){ct(this,"started",Object.create(null));ct(this,"times",[])}time(t){t in this.started&&pt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||pt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:n,end:s}of this.times)t.push(`${i.padEnd(e)} ${s-n}ms
`);return t.join("")}}function Lo(r,t){try{const{protocol:e}=t?new URL(r,t):new URL(r);return e==="http:"||e==="https:"}catch{return!1}}function Ne(r){r.preventDefault()}function bv(r){console.log("Deprecated API usage: "+r)}let $m;class yv{static toDateObject(t){if(!t||typeof t!="string")return null;$m||($m=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=$m.exec(t);if(!e)return null;const i=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(e[6],10);c=c>=0&&c<=59?c:0;const d=e[7]||"Z";let h=parseInt(e[8],10);h=h>=0&&h<=23?h:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,d==="-"?(a+=h,l+=p):d==="+"&&(a-=h,l-=p),new Date(Date.UTC(i,n,s,a,l,c))}}function wC(r,{scale:t=1,rotation:e=0}){const{width:i,height:n}=r.attributes.style,s=[0,0,parseInt(i),parseInt(n)];return new wh({viewBox:s,scale:t,rotation:e})}function im(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(pt(`Not a valid color format: "${r}"`),[0,0,0])}function AC(r){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of r.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;r.set(e,im(i))}t.remove()}function jt(r){const{a:t,b:e,c:i,d:n,e:s,f:a}=r.getTransform();return[t,e,i,n,s,a]}function Vi(r){const{a:t,b:e,c:i,d:n,e:s,f:a}=r.getTransform().invertSelf();return[t,e,i,n,s,a]}function Lr(r,t,e=!1,i=!0){if(t instanceof wh){const{pageWidth:n,pageHeight:s}=t.rawDims,{style:a}=r,l=Oe.isCSSRoundSupported,c=`var(--scale-factor) * ${n}px`,d=`var(--scale-factor) * ${s}px`,h=l?`round(${c}, 1px)`:`calc(${c})`,p=l?`round(${d}, 1px)`:`calc(${d})`;!e||t.rotation%180===0?(a.width=h,a.height=p):(a.width=p,a.height=h)}i&&r.setAttribute("data-main-rotation",t.rotation)}var Ps,Rs,Ei,Ls,Td,wv,Pd,Av,Rd,Ev,sa,zh,Ld,_v,Zo,_p;const kd=class kd{constructor(t){m(this,Pd);m(this,Rd);m(this,sa);m(this,Ld);m(this,Zo);m(this,Ps,null);m(this,Rs,null);m(this,Ei,void 0);m(this,Ls,null);w(this,Ei,t)}render(){const t=w(this,Ps,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ne),t.addEventListener("pointerdown",A(kd,Td,wv));const e=w(this,Ls,document.createElement("div"));e.className="buttons",t.append(e);const i=o(this,Ei).toolbarPosition;if(i){const{style:n}=t,s=o(this,Ei)._uiManager.direction==="ltr"?1-i[0]:i[0];n.insetInlineEnd=`${100*s}%`,n.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return A(this,Ld,_v).call(this),t}hide(){var t;o(this,Ps).classList.add("hidden"),(t=o(this,Rs))==null||t.hideDropdown()}show(){o(this,Ps).classList.remove("hidden")}addAltTextButton(t){A(this,sa,zh).call(this,t),o(this,Ls).prepend(t,o(this,Zo,_p))}addColorPicker(t){w(this,Rs,t);const e=t.renderButton();A(this,sa,zh).call(this,e),o(this,Ls).prepend(e,o(this,Zo,_p))}remove(){var t;o(this,Ps).remove(),(t=o(this,Rs))==null||t.destroy(),w(this,Rs,null)}};Ps=new WeakMap,Rs=new WeakMap,Ei=new WeakMap,Ls=new WeakMap,Td=new WeakSet,wv=function(t){t.stopPropagation()},Pd=new WeakSet,Av=function(t){o(this,Ei)._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()},Rd=new WeakSet,Ev=function(t){o(this,Ei)._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()},sa=new WeakSet,zh=function(t){t.addEventListener("focusin",A(this,Pd,Av).bind(this),{capture:!0}),t.addEventListener("focusout",A(this,Rd,Ev).bind(this),{capture:!0}),t.addEventListener("contextmenu",Ne)},Ld=new WeakSet,_v=function(){const t=document.createElement("button");t.className="delete",t.tabIndex=0,t.setAttribute("data-l10n-id",`pdfjs-editor-remove-${o(this,Ei).editorType}-button`),A(this,sa,zh).call(this,t),t.addEventListener("click",e=>{o(this,Ei)._uiManager.delete()}),o(this,Ls).append(t)},Zo=new WeakSet,_p=function(){const t=document.createElement("div");return t.className="divider",t},m(kd,Td);let Ep=kd;var Jo,ks,Qo,Id,xv,Fd,Sv,Md,Cv;class EC{constructor(t){m(this,Id);m(this,Fd);m(this,Md);m(this,Jo,null);m(this,ks,null);m(this,Qo,void 0);w(this,Qo,t)}show(t,e,i){const[n,s]=A(this,Fd,Sv).call(this,e,i),{style:a}=o(this,ks)||w(this,ks,A(this,Id,xv).call(this));t.append(o(this,ks)),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){o(this,ks).remove()}}Jo=new WeakMap,ks=new WeakMap,Qo=new WeakMap,Id=new WeakSet,xv=function(){const t=w(this,ks,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ne);const e=w(this,Jo,document.createElement("div"));return e.className="buttons",t.append(e),A(this,Md,Cv).call(this),t},Fd=new WeakSet,Sv=function(t,e){let i=0,n=0;for(const s of t){const a=s.y+s.height;if(a<i)continue;const l=s.x+(e?s.width:0);if(a>i){n=l,i=a;continue}e?l>n&&(n=l):l<n&&(n=l)}return[e?1-n:n,i]},Md=new WeakSet,Cv=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),t.addEventListener("contextmenu",Ne),t.addEventListener("click",()=>{o(this,Qo).highlightSelection("floating_button")}),o(this,Jo).append(t)};function vd(r,t,e){for(const i of e)t.addEventListener(i,r[i].bind(r))}function _C(r){return Math.round(Math.min(255,Math.max(1,255*r))).toString(16).padStart(2,"0")}var Dd;class xC{constructor(){m(this,Dd,0)}get id(){return`${iC}${Be(this,Dd)._++}`}}Dd=new WeakMap;var tl,Od,Je,el,Sp;const om=class om{constructor(){m(this,el);m(this,tl,gC());m(this,Od,0);m(this,Je,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d"),n=new Image;n.src=t;const s=n.decode().then(()=>(i.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Et(this,"_isSVGFittingCanvas",s)}async getFromFile(t){const{lastModified:e,name:i,size:n,type:s}=t;return A(this,el,Sp).call(this,`${e}_${i}_${n}_${s}`,t)}async getFromUrl(t){return A(this,el,Sp).call(this,t,t)}async getFromId(t){o(this,Je)||w(this,Je,new Map);const e=o(this,Je).get(t);return e?e.bitmap?(e.refCounter+=1,e):e.file?this.getFromFile(e.file):this.getFromUrl(e.url):null}getSvgUrl(t){const e=o(this,Je).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){o(this,Je)||w(this,Je,new Map);const e=o(this,Je).get(t);e&&(e.refCounter-=1,e.refCounter===0&&(e.bitmap=null))}isValidId(t){return t.startsWith(`image_${o(this,tl)}_`)}};tl=new WeakMap,Od=new WeakMap,Je=new WeakMap,el=new WeakSet,Sp=async function(t,e){o(this,Je)||w(this,Je,new Map);let i=o(this,Je).get(t);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${o(this,tl)}_${Be(this,Od)._++}`,refCounter:0,isSvg:!1});let n;if(typeof e=="string"?(i.url=e,n=await Ef(e,"blob")):n=i.file=e,n.type==="image/svg+xml"){const s=om._isSVGFittingCanvas,a=new FileReader,l=new Image,c=new Promise((d,h)=>{l.onload=()=>{i.bitmap=l,i.isSvg=!0,d()},a.onload=async()=>{const p=i.svgUrl=a.result;l.src=await s?`${p}#svgView(preserveAspectRatio(none))`:p},l.onerror=a.onerror=h});a.readAsDataURL(n),await c}else i.bitmap=await createImageBitmap(n);i.refCounter=1}catch(n){console.error(n),i=null}return o(this,Je).set(t,i),i&&o(this,Je).set(i.id,i),i};let xp=om;var oe,Un,il,le;class SC{constructor(t=128){m(this,oe,[]);m(this,Un,!1);m(this,il,void 0);m(this,le,-1);w(this,il,t)}add({cmd:t,undo:e,post:i,mustExec:n,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(n&&t(),o(this,Un))return;const c={cmd:t,undo:e,post:i,type:s};if(o(this,le)===-1){o(this,oe).length>0&&(o(this,oe).length=0),w(this,le,0),o(this,oe).push(c);return}if(a&&o(this,oe)[o(this,le)].type===s){l&&(c.undo=o(this,oe)[o(this,le)].undo),o(this,oe)[o(this,le)]=c;return}const d=o(this,le)+1;d===o(this,il)?o(this,oe).splice(0,1):(w(this,le,d),d<o(this,oe).length&&o(this,oe).splice(d)),o(this,oe).push(c)}undo(){if(o(this,le)===-1)return;w(this,Un,!0);const{undo:t,post:e}=o(this,oe)[o(this,le)];t(),e==null||e(),w(this,Un,!1),w(this,le,o(this,le)-1)}redo(){if(o(this,le)<o(this,oe).length-1){w(this,le,o(this,le)+1),w(this,Un,!0);const{cmd:t,post:e}=o(this,oe)[o(this,le)];t(),e==null||e(),w(this,Un,!1)}}hasSomethingToUndo(){return o(this,le)!==-1}hasSomethingToRedo(){return o(this,le)<o(this,oe).length-1}destroy(){w(this,oe,null)}}oe=new WeakMap,Un=new WeakMap,il=new WeakMap,le=new WeakMap;var Nd,Tv;class Ah{constructor(t){m(this,Nd);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Oe.platform;for(const[i,n,s={}]of t)for(const a of i){const l=a.startsWith("mac+");e&&l?(this.callbacks.set(a.slice(4),{callback:n,options:s}),this.allKeys.add(a.split("+").at(-1))):!e&&!l&&(this.callbacks.set(a,{callback:n,options:s}),this.allKeys.add(a.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(A(this,Nd,Tv).call(this,e));if(!i)return;const{callback:n,options:{bubbles:s=!1,args:a=[],checker:l=null}}=i;l&&!l(t,e)||(n.bind(t,...a,e)(),s||(e.stopPropagation(),e.preventDefault()))}}Nd=new WeakSet,Tv=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const Bd=class Bd{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return AC(t),Et(this,"_colors",t)}convert(t){const e=im(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,n]of this._colors)if(n.every((s,a)=>s===e[a]))return Bd._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?J.makeHexColor(...e):t}};ct(Bd,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Cp=Bd;var Ue,Jt,he,ra,Qi,aa,ri,oa,Is,_i,tn,Fs,nl,sl,xi,la,Hn,Si,$d,zn,rl,Ms,al,ca,de,Rt,en,Ds,ol,ll,cl,hl,dl,ul,fl,pl,gl,ml,vl,bl,yl,wl,Gn,Ci,nn,Al,ha,Gh,jd,Pv,Ud,Rv,da,Vh,Hd,Lv,zd,kv,Gd,Iv,El,Tp,_l,Pp,xl,Rp,Sl,Lp,Cl,kp,ue,xe,Ti,Fn,Vd,Fv,Wd,Mv,Tl,Ip,qd,Dv,Os,ko,Pl,Fp;const Kr=class Kr{constructor(t,e,i,n,s,a,l,c,d){m(this,ha);m(this,jd);m(this,Ud);m(this,da);m(this,Hd);m(this,zd);m(this,Gd);m(this,El);m(this,_l);m(this,xl);m(this,Sl);m(this,Cl);m(this,ue);m(this,Ti);m(this,Vd);m(this,Wd);m(this,Tl);m(this,qd);m(this,Os);m(this,Pl);m(this,Ue,null);m(this,Jt,new Map);m(this,he,new Map);m(this,ra,null);m(this,Qi,null);m(this,aa,null);m(this,ri,new SC);m(this,oa,0);m(this,Is,new Set);m(this,_i,null);m(this,tn,null);m(this,Fs,new Set);m(this,nl,!1);m(this,sl,null);m(this,xi,null);m(this,la,null);m(this,Hn,!1);m(this,Si,null);m(this,$d,new xC);m(this,zn,!1);m(this,rl,!1);m(this,Ms,null);m(this,al,null);m(this,ca,null);m(this,de,yt.NONE);m(this,Rt,new Set);m(this,en,null);m(this,Ds,null);m(this,ol,null);m(this,ll,this.blur.bind(this));m(this,cl,this.focus.bind(this));m(this,hl,this.copy.bind(this));m(this,dl,this.cut.bind(this));m(this,ul,this.paste.bind(this));m(this,fl,this.keydown.bind(this));m(this,pl,this.keyup.bind(this));m(this,gl,this.onEditingAction.bind(this));m(this,ml,this.onPageChanging.bind(this));m(this,vl,this.onScaleChanging.bind(this));m(this,bl,A(this,Ud,Rv).bind(this));m(this,yl,this.onRotationChanging.bind(this));m(this,wl,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});m(this,Gn,[0,0]);m(this,Ci,null);m(this,nn,null);m(this,Al,null);w(this,nn,t),w(this,Al,e),w(this,ra,i),this._eventBus=n,this._eventBus._on("editingaction",o(this,gl)),this._eventBus._on("pagechanging",o(this,ml)),this._eventBus._on("scalechanging",o(this,vl)),this._eventBus._on("rotationchanging",o(this,yl)),A(this,Hd,Lv).call(this),A(this,_l,Pp).call(this),w(this,Qi,s.annotationStorage),w(this,sl,s.filterFactory),w(this,Ds,a),w(this,la,l||null),w(this,nl,c),w(this,ca,d||null),this.viewParameters={realScale:hs.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const t=Kr.prototype,e=a=>o(a,nn).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},n=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Et(this,"_keyboardManager",new Ah([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&o(a,nn).contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&o(a,nn).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}destroy(){var t,e;A(this,xl,Rp).call(this),A(this,El,Tp).call(this),this._eventBus._off("editingaction",o(this,gl)),this._eventBus._off("pagechanging",o(this,ml)),this._eventBus._off("scalechanging",o(this,vl)),this._eventBus._off("rotationchanging",o(this,yl));for(const i of o(this,he).values())i.destroy();o(this,he).clear(),o(this,Jt).clear(),o(this,Fs).clear(),w(this,Ue,null),o(this,Rt).clear(),o(this,ri).destroy(),(t=o(this,ra))==null||t.destroy(),(e=o(this,Si))==null||e.hide(),w(this,Si,null),o(this,xi)&&(clearTimeout(o(this,xi)),w(this,xi,null)),o(this,Ci)&&(clearTimeout(o(this,Ci)),w(this,Ci,null)),A(this,zd,kv).call(this)}async mlGuess(t){var e;return((e=o(this,ca))==null?void 0:e.guess(t))||null}get hasMLManager(){return!!o(this,ca)}get hcmFilter(){return Et(this,"hcmFilter",o(this,Ds)?o(this,sl).addHCMFilter(o(this,Ds).foreground,o(this,Ds).background):"none")}get direction(){return Et(this,"direction",getComputedStyle(o(this,nn)).direction)}get highlightColors(){return Et(this,"highlightColors",o(this,la)?new Map(o(this,la).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Et(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){w(this,al,t)}editAltText(t){var e;(e=o(this,ra))==null||e.editAltText(this,t)}onPageChanging({pageNumber:t}){w(this,oa,t-1)}focusMainContainer(){o(this,nn).focus()}findParent(t,e){for(const i of o(this,he).values()){const{x:n,y:s,width:a,height:l}=i.div.getBoundingClientRect();if(t>=n&&t<=n+a&&e>=s&&e<=s+l)return i}return null}disableUserSelect(t=!1){o(this,Al).classList.toggle("noUserSelect",t)}addShouldRescale(t){o(this,Fs).add(t)}removeShouldRescale(t){o(this,Fs).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*hs.PDF_TO_CSS_UNITS;for(const e of o(this,Fs))e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:a}=e,l=e.toString(),d=A(this,ha,Gh).call(this,e).closest(".textLayer"),h=this.getSelectionBoxes(d);if(h){e.empty(),o(this,de)===yt.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:yt.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const p of o(this,he).values())if(p.hasTextLayer(d)){p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:h,anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:a,text:l});break}}}addToAnnotationStorage(t){!t.isEmpty()&&o(this,Qi)&&!o(this,Qi).has(t.id)&&o(this,Qi).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,o(this,Hn)&&(w(this,Hn,!1),A(this,da,Vh).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of o(this,Rt))if(e.div.contains(t)){w(this,Ms,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!o(this,Ms))return;const[t,e]=o(this,Ms);w(this,Ms,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0}),e.focus()}addEditListeners(){A(this,_l,Pp).call(this),A(this,Sl,Lp).call(this)}removeEditListeners(){A(this,xl,Rp).call(this),A(this,Cl,kp).call(this)}copy(t){var i;if(t.preventDefault(),(i=o(this,Ue))==null||i.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of o(this,Rt)){const s=n.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const a of o(this,tn))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){pt(`paste: "${s.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const n=this.currentLayer;try{const s=[];for(const c of i){const d=n.deserialize(c);if(!d)return;s.push(d)}const a=()=>{for(const c of s)A(this,Tl,Ip).call(this,c);A(this,Pl,Fp).call(this,s)},l=()=>{for(const c of s)c.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(s){pt(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),o(this,de)!==yt.NONE&&!this.isEditorHandlingKeyboard&&Kr._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,o(this,Hn)&&(w(this,Hn,!1),A(this,da,Vh).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(A(this,Gd,Iv).call(this),A(this,Sl,Lp).call(this),A(this,ue,xe).call(this,{isEditing:o(this,de)!==yt.NONE,isEmpty:A(this,Os,ko).call(this),hasSomethingToUndo:o(this,ri).hasSomethingToUndo(),hasSomethingToRedo:o(this,ri).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,El,Tp).call(this),A(this,Cl,kp).call(this),A(this,ue,xe).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!o(this,tn)){w(this,tn,t);for(const e of o(this,tn))A(this,Ti,Fn).call(this,e.defaultPropertiesToUpdate)}}getId(){return o(this,$d).id}get currentLayer(){return o(this,he).get(o(this,oa))}getLayer(t){return o(this,he).get(t)}get currentPageIndex(){return o(this,oa)}addLayer(t){o(this,he).set(t.pageIndex,t),o(this,zn)?t.enable():t.disable()}removeLayer(t){o(this,he).delete(t.pageIndex)}updateMode(t,e=null,i=!1){if(o(this,de)!==t){if(w(this,de,t),t===yt.NONE){this.setEditingState(!1),A(this,Wd,Mv).call(this);return}this.setEditingState(!0),A(this,Vd,Fv).call(this),this.unselectAll();for(const n of o(this,he).values())n.updateMode(t);if(!e&&i){this.addNewEditorFromKeyboard();return}if(e){for(const n of o(this,Jt).values())if(n.annotationElementId===e){this.setSelected(n),n.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==o(this,de)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var i;if(o(this,tn)){switch(t){case lt.CREATE:this.currentLayer.addNewEditor();return;case lt.HIGHLIGHT_DEFAULT_COLOR:(i=o(this,al))==null||i.updateColor(e);break;case lt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(o(this,ol)||w(this,ol,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const n of o(this,Rt))n.updateParams(t,e);for(const n of o(this,tn))n.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){var s;for(const a of o(this,Jt).values())a.editorType===t&&a.show(e);(((s=o(this,ol))==null?void 0:s.get(lt.HIGHLIGHT_SHOW_ALL))??!0)!==e&&A(this,Ti,Fn).call(this,[[lt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(o(this,rl)!==t){w(this,rl,t);for(const e of o(this,he).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const i of o(this,Jt).values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return o(this,Jt).get(t)}addEditor(t){o(this,Jt).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(o(this,xi)&&clearTimeout(o(this,xi)),w(this,xi,setTimeout(()=>{this.focusMainContainer(),w(this,xi,null)},0))),o(this,Jt).delete(t.id),this.unselect(t),(!t.annotationElementId||!o(this,Is).has(t.annotationElementId))&&((e=o(this,Qi))==null||e.remove(t.id))}addDeletedAnnotationElement(t){o(this,Is).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return o(this,Is).has(t)}removeDeletedAnnotationElement(t){o(this,Is).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){o(this,Ue)!==t&&(w(this,Ue,t),t&&A(this,Ti,Fn).call(this,t.propertiesToUpdate))}updateUI(t){o(this,qd,Dv)===t&&A(this,Ti,Fn).call(this,t.propertiesToUpdate)}toggleSelected(t){if(o(this,Rt).has(t)){o(this,Rt).delete(t),t.unselect(),A(this,ue,xe).call(this,{hasSelectedEditor:this.hasSelection});return}o(this,Rt).add(t),t.select(),A(this,Ti,Fn).call(this,t.propertiesToUpdate),A(this,ue,xe).call(this,{hasSelectedEditor:!0})}setSelected(t){for(const e of o(this,Rt))e!==t&&e.unselect();o(this,Rt).clear(),o(this,Rt).add(t),t.select(),A(this,Ti,Fn).call(this,t.propertiesToUpdate),A(this,ue,xe).call(this,{hasSelectedEditor:!0})}isSelected(t){return o(this,Rt).has(t)}get firstSelectedEditor(){return o(this,Rt).values().next().value}unselect(t){t.unselect(),o(this,Rt).delete(t),A(this,ue,xe).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return o(this,Rt).size!==0}get isEnterHandled(){return o(this,Rt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){o(this,ri).undo(),A(this,ue,xe).call(this,{hasSomethingToUndo:o(this,ri).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,Os,ko).call(this)})}redo(){o(this,ri).redo(),A(this,ue,xe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:o(this,ri).hasSomethingToRedo(),isEmpty:A(this,Os,ko).call(this)})}addCommands(t){o(this,ri).add(t),A(this,ue,xe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,Os,ko).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...o(this,Rt)],e=()=>{for(const n of t)n.remove()},i=()=>{for(const n of t)A(this,Tl,Ip).call(this,n)};this.addCommands({cmd:e,undo:i,mustExec:!0})}commitOrRemove(){var t;(t=o(this,Ue))==null||t.commitOrRemove()}hasSomethingToControl(){return o(this,Ue)||this.hasSelection}selectAll(){for(const t of o(this,Rt))t.commit();A(this,Pl,Fp).call(this,o(this,Jt).values())}unselectAll(){if(!(o(this,Ue)&&(o(this,Ue).commitOrRemove(),o(this,de)!==yt.NONE))&&this.hasSelection){for(const t of o(this,Rt))t.unselect();o(this,Rt).clear(),A(this,ue,xe).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;o(this,Gn)[0]+=t,o(this,Gn)[1]+=e;const[n,s]=o(this,Gn),a=[...o(this,Rt)],l=1e3;o(this,Ci)&&clearTimeout(o(this,Ci)),w(this,Ci,setTimeout(()=>{w(this,Ci,null),o(this,Gn)[0]=o(this,Gn)[1]=0,this.addCommands({cmd:()=>{for(const c of a)o(this,Jt).has(c.id)&&c.translateInPage(n,s)},undo:()=>{for(const c of a)o(this,Jt).has(c.id)&&c.translateInPage(-n,-s)},mustExec:!1})},l));for(const c of a)c.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),w(this,_i,new Map);for(const t of o(this,Rt))o(this,_i).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!o(this,_i))return!1;this.disableUserSelect(!1);const t=o(this,_i);w(this,_i,null);let e=!1;for(const[{x:n,y:s,pageIndex:a},l]of t)l.newX=n,l.newY=s,l.newPageIndex=a,e||(e=n!==l.savedX||s!==l.savedY||a!==l.savedPageIndex);if(!e)return!1;const i=(n,s,a,l)=>{if(o(this,Jt).has(n.id)){const c=o(this,he).get(l);c?n._setParentAndPosition(c,s,a):(n.pageIndex=l,n.x=s,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:s,newY:a,newPageIndex:l}]of t)i(n,s,a,l)},undo:()=>{for(const[n,{savedX:s,savedY:a,savedPageIndex:l}]of t)i(n,s,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(o(this,_i))for(const i of o(this,_i).keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||o(this,Rt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return o(this,Ue)===t}getActive(){return o(this,Ue)}getMode(){return o(this,de)}get imageManager(){return Et(this,"imageManager",new xp)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let d=0,h=e.rangeCount;d<h;d++)if(!t.contains(e.getRangeAt(d).commonAncestorContainer))return null;const{x:i,y:n,width:s,height:a}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(d,h,p,g)=>({x:(h-n)/a,y:1-(d+p-i)/s,width:g/a,height:p/s});break;case"180":l=(d,h,p,g)=>({x:1-(d+p-i)/s,y:1-(h+g-n)/a,width:p/s,height:g/a});break;case"270":l=(d,h,p,g)=>({x:1-(h+g-n)/a,y:(d-i)/s,width:g/a,height:p/s});break;default:l=(d,h,p,g)=>({x:(d-i)/s,y:(h-n)/a,width:p/s,height:g/a});break}const c=[];for(let d=0,h=e.rangeCount;d<h;d++){const p=e.getRangeAt(d);if(!p.collapsed)for(const{x:g,y:v,width:b,height:E}of p.getClientRects())b===0||E===0||c.push(l(g,v,b,E))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:e}){(o(this,aa)||w(this,aa,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=o(this,aa))==null||e.delete(t)}renderAnnotationElement(t){var n;const e=(n=o(this,aa))==null?void 0:n.get(t.data.id);if(!e)return;const i=o(this,Qi).getRawValue(e);i&&(o(this,de)===yt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}};Ue=new WeakMap,Jt=new WeakMap,he=new WeakMap,ra=new WeakMap,Qi=new WeakMap,aa=new WeakMap,ri=new WeakMap,oa=new WeakMap,Is=new WeakMap,_i=new WeakMap,tn=new WeakMap,Fs=new WeakMap,nl=new WeakMap,sl=new WeakMap,xi=new WeakMap,la=new WeakMap,Hn=new WeakMap,Si=new WeakMap,$d=new WeakMap,zn=new WeakMap,rl=new WeakMap,Ms=new WeakMap,al=new WeakMap,ca=new WeakMap,de=new WeakMap,Rt=new WeakMap,en=new WeakMap,Ds=new WeakMap,ol=new WeakMap,ll=new WeakMap,cl=new WeakMap,hl=new WeakMap,dl=new WeakMap,ul=new WeakMap,fl=new WeakMap,pl=new WeakMap,gl=new WeakMap,ml=new WeakMap,vl=new WeakMap,bl=new WeakMap,yl=new WeakMap,wl=new WeakMap,Gn=new WeakMap,Ci=new WeakMap,nn=new WeakMap,Al=new WeakMap,ha=new WeakSet,Gh=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},jd=new WeakSet,Pv=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=A(this,ha,Gh).call(this,t).closest(".textLayer"),n=this.getSelectionBoxes(i);n&&(o(this,Si)||w(this,Si,new EC(this)),o(this,Si).show(i,n,this.direction==="ltr"))},Ud=new WeakSet,Rv=function(){var s,a,l;const t=document.getSelection();if(!t||t.isCollapsed){o(this,en)&&((s=o(this,Si))==null||s.hide(),w(this,en,null),A(this,ue,xe).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===o(this,en))return;if(!A(this,ha,Gh).call(this,t).closest(".textLayer")){o(this,en)&&((a=o(this,Si))==null||a.hide(),w(this,en,null),A(this,ue,xe).call(this,{hasSelectedText:!1}));return}if((l=o(this,Si))==null||l.hide(),w(this,en,e),A(this,ue,xe).call(this,{hasSelectedText:!0}),!(o(this,de)!==yt.HIGHLIGHT&&o(this,de)!==yt.NONE)&&(o(this,de)===yt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),w(this,Hn,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=d=>{d.type==="pointerup"&&d.button!==0||(window.removeEventListener("pointerup",c),window.removeEventListener("blur",c),d.type==="pointerup"&&A(this,da,Vh).call(this,"main_toolbar"))};window.addEventListener("pointerup",c),window.addEventListener("blur",c)}},da=new WeakSet,Vh=function(t=""){o(this,de)===yt.HIGHLIGHT?this.highlightSelection(t):o(this,nl)&&A(this,jd,Pv).call(this)},Hd=new WeakSet,Lv=function(){document.addEventListener("selectionchange",o(this,bl))},zd=new WeakSet,kv=function(){document.removeEventListener("selectionchange",o(this,bl))},Gd=new WeakSet,Iv=function(){window.addEventListener("focus",o(this,cl)),window.addEventListener("blur",o(this,ll))},El=new WeakSet,Tp=function(){window.removeEventListener("focus",o(this,cl)),window.removeEventListener("blur",o(this,ll))},_l=new WeakSet,Pp=function(){window.addEventListener("keydown",o(this,fl)),window.addEventListener("keyup",o(this,pl))},xl=new WeakSet,Rp=function(){window.removeEventListener("keydown",o(this,fl)),window.removeEventListener("keyup",o(this,pl))},Sl=new WeakSet,Lp=function(){document.addEventListener("copy",o(this,hl)),document.addEventListener("cut",o(this,dl)),document.addEventListener("paste",o(this,ul))},Cl=new WeakSet,kp=function(){document.removeEventListener("copy",o(this,hl)),document.removeEventListener("cut",o(this,dl)),document.removeEventListener("paste",o(this,ul))},ue=new WeakSet,xe=function(t){Object.entries(t).some(([i,n])=>o(this,wl)[i]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(o(this,wl),t)}),o(this,de)===yt.HIGHLIGHT&&t.hasSelectedEditor===!1&&A(this,Ti,Fn).call(this,[[lt.HIGHLIGHT_FREE,!0]]))},Ti=new WeakSet,Fn=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},Vd=new WeakSet,Fv=function(){if(!o(this,zn)){w(this,zn,!0);for(const t of o(this,he).values())t.enable();for(const t of o(this,Jt).values())t.enable()}},Wd=new WeakSet,Mv=function(){if(this.unselectAll(),o(this,zn)){w(this,zn,!1);for(const t of o(this,he).values())t.disable();for(const t of o(this,Jt).values())t.disable()}},Tl=new WeakSet,Ip=function(t){const e=o(this,he).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},qd=new WeakSet,Dv=function(){let t=null;for(t of o(this,Rt));return t},Os=new WeakSet,ko=function(){if(o(this,Jt).size===0)return!0;if(o(this,Jt).size===1)for(const t of o(this,Jt).values())return t.isEmpty();return!1},Pl=new WeakSet,Fp=function(t){for(const e of o(this,Rt))e.unselect();o(this,Rt).clear();for(const e of t)e.isEmpty()||(o(this,Rt).add(e),e.select());A(this,ue,xe).call(this,{hasSelectedEditor:this.hasSelection})},ct(Kr,"TRANSLATE_SMALL",1),ct(Kr,"TRANSLATE_BIG",10);let kr=Kr;var sn,rn,ai,an,oi,ua,on,Rl,Mp;const qi=class qi{constructor(t){m(this,Rl);m(this,sn,"");m(this,rn,!1);m(this,ai,null);m(this,an,null);m(this,oi,null);m(this,ua,!1);m(this,on,null);w(this,on,t)}static initialize(t){qi._l10nPromise||(qi._l10nPromise=t)}async render(){const t=w(this,ai,document.createElement("button"));t.className="altText";const e=await qi._l10nPromise.get("pdfjs-editor-alt-text-button-label");t.textContent=e,t.setAttribute("aria-label",e),t.tabIndex="0",t.addEventListener("contextmenu",Ne),t.addEventListener("pointerdown",n=>n.stopPropagation());const i=n=>{n.preventDefault(),o(this,on)._uiManager.editAltText(o(this,on))};return t.addEventListener("click",i,{capture:!0}),t.addEventListener("keydown",n=>{n.target===t&&n.key==="Enter"&&(w(this,ua,!0),i(n))}),await A(this,Rl,Mp).call(this),t}finish(){o(this,ai)&&(o(this,ai).focus({focusVisible:o(this,ua)}),w(this,ua,!1))}isEmpty(){return!o(this,sn)&&!o(this,rn)}get data(){return{altText:o(this,sn),decorative:o(this,rn)}}set data({altText:t,decorative:e}){o(this,sn)===t&&o(this,rn)===e||(w(this,sn,t),w(this,rn,e),A(this,Rl,Mp).call(this))}toggle(t=!1){o(this,ai)&&(!t&&o(this,oi)&&(clearTimeout(o(this,oi)),w(this,oi,null)),o(this,ai).disabled=!t)}destroy(){var t;(t=o(this,ai))==null||t.remove(),w(this,ai,null),w(this,an,null)}};sn=new WeakMap,rn=new WeakMap,ai=new WeakMap,an=new WeakMap,oi=new WeakMap,ua=new WeakMap,on=new WeakMap,Rl=new WeakSet,Mp=async function(){var n;const t=o(this,ai);if(!t)return;if(!o(this,sn)&&!o(this,rn)){t.classList.remove("done"),(n=o(this,an))==null||n.remove();return}t.classList.add("done"),qi._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(s=>{t.setAttribute("aria-label",s)});let e=o(this,an);if(!e){w(this,an,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip");const s=e.id=`alt-text-tooltip-${o(this,on).id}`;t.setAttribute("aria-describedby",s);const a=100;t.addEventListener("mouseenter",()=>{w(this,oi,setTimeout(()=>{w(this,oi,null),o(this,an).classList.add("show"),o(this,on)._reportTelemetry({action:"alt_text_tooltip"})},a))}),t.addEventListener("mouseleave",()=>{var l;o(this,oi)&&(clearTimeout(o(this,oi)),w(this,oi,null)),(l=o(this,an))==null||l.classList.remove("show")})}e.innerText=o(this,rn)?await qi._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):o(this,sn),e.parentNode||t.append(e);const i=o(this,on).getImageForAltText();i==null||i.setAttribute("aria-describedby",e.id)},ct(qi,"_l10nPromise",null);let bd=qi;var li,Se,fa,Ns,fe,Bs,pa,ga,ye,Ll,$s,Vn,kl,js,ln,Pi,ma,va,Qe,Il,Xd,Fl,Dp,Ml,Op,Dl,Np,Yd,Ov,Kd,Nv,Ol,Bp,Nl,$p,Bl,jp,Zd,Bv,Jd,$v,Qd,jv,tu,Uv,$l,Up,Us,Io;const Mt=class Mt{constructor(t){m(this,Fl);m(this,Dl);m(this,Yd);m(this,Kd);m(this,Ol);m(this,Nl);m(this,Bl);m(this,Zd);m(this,Jd);m(this,Qd);m(this,tu);m(this,$l);m(this,Us);m(this,li,null);m(this,Se,null);m(this,fa,!1);m(this,Ns,!1);m(this,fe,null);m(this,Bs,null);m(this,pa,this.focusin.bind(this));m(this,ga,this.focusout.bind(this));m(this,ye,null);m(this,Ll,"");m(this,$s,!1);m(this,Vn,null);m(this,kl,!1);m(this,js,!1);m(this,ln,!1);m(this,Pi,null);m(this,ma,0);m(this,va,0);m(this,Qe,null);ct(this,"_initialOptions",Object.create(null));ct(this,"_isVisible",!0);ct(this,"_uiManager",null);ct(this,"_focusEventsAllowed",!0);ct(this,"_l10nPromise",null);m(this,Il,!1);m(this,Xd,Mt._zIndex++);this.constructor===Mt&&It("Cannot initialize AnnotationEditor."),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:n,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,n],this.pageTranslation=[s,a];const[l,c]=this.parentDimensions;this.x=t.x/l,this.y=t.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=Mt.prototype._resizeWithKeyboard,e=kr.TRANSLATE_SMALL,i=kr.TRANSLATE_BIG;return Et(this,"_resizerKeyboardManager",new Ah([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Mt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Et(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new CC({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e,i){if(Mt._l10nPromise||(Mt._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(s=>[s,t.get(s.replaceAll(/([A-Z])/g,a=>`-${a.toLowerCase()}`))]))),i!=null&&i.strings)for(const s of i.strings)Mt._l10nPromise.set(s,t.get(s));if(Mt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Mt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){It("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return o(this,Il)}set _isDraggable(t){var e;w(this,Il,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=o(this,Xd)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):A(this,Us,Io).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(o(this,$s)?w(this,$s,!1):this.parent.setSelected(this))}focusout(t){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,n){const[s,a]=this.parentDimensions;[i,n]=this.screenToPageTranslation(i,n),this.x=(t+i)/s,this.y=(e+n)/a,this.fixAndSetPosition()}translate(t,e){A(this,Fl,Dp).call(this,this.parentDimensions,t,e)}translateInPage(t,e){o(this,Vn)||w(this,Vn,[this.x,this.y]),A(this,Fl,Dp).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){o(this,Vn)||w(this,Vn,[this.x,this.y]);const[i,n]=this.parentDimensions;if(this.x+=t/i,this.y+=e/n,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:h}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,h)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:a}=this;const[l,c]=this.getBaseTranslation();s+=l,a+=c,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*a).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!o(this,Vn)&&(o(this,Vn)[0]!==this.x||o(this,Vn)[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Mt,n=i/t,s=i/e;switch(this.rotation){case 90:return[-n,s];case 180:return[n,s];case 270:return[n,-s];default:return[-n,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,i]=this.pageDimensions;let{x:n,y:s,width:a,height:l}=this;if(a*=e,l*=i,n*=e,s*=i,this._mustFixPosition)switch(t){case 0:n=Math.max(0,Math.min(e-a,n)),s=Math.max(0,Math.min(i-l,s));break;case 90:n=Math.max(0,Math.min(e-l,n)),s=Math.min(i,Math.max(a,s));break;case 180:n=Math.min(e,Math.max(a,n)),s=Math.min(i,Math.max(l,s));break;case 270:n=Math.min(e,Math.max(l,n)),s=Math.max(0,Math.min(i-a,s));break}this.x=n/=e,this.y=s/=i;const[c,d]=this.getBaseTranslation();n+=c,s+=d;const{style:h}=this.div;h.left=`${(100*n).toFixed(2)}%`,h.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var i;return A(i=Mt,Ml,Op).call(i,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var i;return A(i=Mt,Ml,Op).call(i,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this,n=e*t,s=i*t;return Oe.isCSSRoundSupported?[Math.round(n),Math.round(s)]:[n,s]}setDims(t,e){const[i,n]=this.parentDimensions;this.div.style.width=`${(100*t/i).toFixed(2)}%`,o(this,Ns)||(this.div.style.height=`${(100*e/n).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,n=i.endsWith("%"),s=!o(this,Ns)&&e.endsWith("%");if(n&&s)return;const[a,l]=this.parentDimensions;n||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!o(this,Ns)&&!s&&(t.height=`${(100*parseFloat(e)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var t;(t=o(this,Se))==null||t.finish()}async addEditToolbar(){return o(this,ye)||o(this,js)?o(this,ye):(w(this,ye,new Ep(this)),this.div.append(o(this,ye).render()),o(this,Se)&&o(this,ye).addAltTextButton(await o(this,Se).render()),o(this,ye))}removeEditToolbar(){var t;o(this,ye)&&(o(this,ye).remove(),w(this,ye,null),(t=o(this,Se))==null||t.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){o(this,Se)||(bd.initialize(Mt._l10nPromise),w(this,Se,new bd(this)),await this.addEditToolbar())}get altTextData(){var t;return(t=o(this,Se))==null?void 0:t.data}set altTextData(t){o(this,Se)&&(o(this,Se).data=t)}hasAltText(){var t;return!((t=o(this,Se))!=null&&t.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=o(this,fa)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",o(this,pa)),this.div.addEventListener("focusout",o(this,ga));const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[i,n]=this.getInitialTranslation();return this.translate(i,n),vd(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=Oe.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(w(this,$s,!0),this._isDraggable){A(this,Zd,Bv).call(this,t);return}A(this,Bl,jp).call(this,t)}moveInDOM(){o(this,Pi)&&clearTimeout(o(this,Pi)),w(this,Pi,setTimeout(()=>{var t;w(this,Pi,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition()}getRect(t,e,i=this.rotation){const n=this.parentScale,[s,a]=this.pageDimensions,[l,c]=this.pageTranslation,d=t/n,h=e/n,p=this.x*s,g=this.y*a,v=this.width*s,b=this.height*a;switch(i){case 0:return[p+d+l,a-g-h-b+c,p+d+v+l,a-g-h+c];case 90:return[p+h+l,a-g+d+c,p+h+b+l,a-g+d+v+c];case 180:return[p-d-v+l,a-g+h+c,p-d+l,a-g+h+b+c];case 270:return[p-h-b+l,a-g-d-v+c,p-h+l,a-g-d+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,n,s,a]=t,l=s-i,c=a-n;switch(this.rotation){case 0:return[i,e-a,l,c];case 90:return[i,e-n,c,l];case 180:return[s,e-n,l,c];case 270:return[s,e-a,c,l];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){w(this,js,!0)}disableEditMode(){w(this,js,!1)}isInEditMode(){return o(this,js)}shouldGetKeyboardEvents(){return o(this,ln)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var t,e;(t=this.div)==null||t.addEventListener("focusin",o(this,pa)),(e=this.div)==null||e.addEventListener("focusout",o(this,ga))}rotate(t){}serialize(t=!1,e=null){It("An editor must be serializable")}static deserialize(t,e,i){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});n.rotation=t.rotation;const[s,a]=n.pageDimensions,[l,c,d,h]=n.getRectInCurrentCoords(t.rect,a);return n.x=l/s,n.y=c/a,n.width=d/s,n.height=h/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",o(this,pa)),this.div.removeEventListener("focusout",o(this,ga)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),o(this,Pi)&&(clearTimeout(o(this,Pi)),w(this,Pi,null)),A(this,Us,Io).call(this),this.removeEditToolbar(),o(this,Qe)){for(const t of o(this,Qe).values())clearTimeout(t);w(this,Qe,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,Yd,Ov).call(this),o(this,fe).classList.remove("hidden"),vd(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),w(this,Bs,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=o(this,fe).children;if(!o(this,li)){w(this,li,Array.from(e));const a=A(this,Jd,$v).bind(this),l=A(this,Qd,jv).bind(this);for(const c of o(this,li)){const d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a),c.addEventListener("blur",l),c.addEventListener("focus",A(this,tu,Uv).bind(this,d)),Mt._l10nPromise.get(`pdfjs-editor-resizer-label-${d}`).then(h=>c.setAttribute("aria-label",h))}}const i=o(this,li)[0];let n=0;for(const a of e){if(a===i)break;n++}const s=(360-this.rotation+this.parentRotation)%360/90*(o(this,li).length/4);if(s!==n){if(s<n)for(let l=0;l<n-s;l++)o(this,fe).append(o(this,fe).firstChild);else if(s>n)for(let l=0;l<s-n;l++)o(this,fe).firstChild.before(o(this,fe).lastChild);let a=0;for(const l of e){const d=o(this,li)[a++].getAttribute("data-resizer-name");Mt._l10nPromise.get(`pdfjs-editor-resizer-label-${d}`).then(h=>l.setAttribute("aria-label",h))}}A(this,$l,Up).call(this,0),w(this,ln,!0),o(this,fe).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){o(this,ln)&&A(this,Nl,$p).call(this,o(this,Ll),{movementX:t,movementY:e})}_stopResizingWithKeyboard(){A(this,Us,Io).call(this),this.div.focus()}select(){var t,e;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!o(this,ye)){this.addEditToolbar().then(()=>{var i,n;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((n=o(this,ye))==null||n.show())});return}(e=o(this,ye))==null||e.show()}unselect(){var t,e,i,n;(t=o(this,fe))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(n=o(this,ye))==null||n.hide()}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return o(this,kl)}set isEditing(t){w(this,kl,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){w(this,Ns,!0);const i=t/e,{style:n}=this.div;n.aspectRatio=i,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){o(this,Qe)||w(this,Qe,new Map);const{action:i}=t;let n=o(this,Qe).get(i);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),o(this,Qe).delete(i),o(this,Qe).size===0&&w(this,Qe,null)},Mt._telemetryTimeout),o(this,Qe).set(i,n);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),w(this,fa,!1)}disable(){this.div&&(this.div.tabIndex=-1),w(this,fa,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};li=new WeakMap,Se=new WeakMap,fa=new WeakMap,Ns=new WeakMap,fe=new WeakMap,Bs=new WeakMap,pa=new WeakMap,ga=new WeakMap,ye=new WeakMap,Ll=new WeakMap,$s=new WeakMap,Vn=new WeakMap,kl=new WeakMap,js=new WeakMap,ln=new WeakMap,Pi=new WeakMap,ma=new WeakMap,va=new WeakMap,Qe=new WeakMap,Il=new WeakMap,Xd=new WeakMap,Fl=new WeakSet,Dp=function([t,e],i,n){[i,n]=this.screenToPageTranslation(i,n),this.x+=i/t,this.y+=n/e,this.fixAndSetPosition()},Ml=new WeakSet,Op=function(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},Dl=new WeakSet,Np=function(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}},Yd=new WeakSet,Ov=function(){if(o(this,fe))return;w(this,fe,document.createElement("div")),o(this,fe).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const e of t){const i=document.createElement("div");o(this,fe).append(i),i.classList.add("resizer",e),i.setAttribute("data-resizer-name",e),i.addEventListener("pointerdown",A(this,Kd,Nv).bind(this,e)),i.addEventListener("contextmenu",Ne),i.tabIndex=-1}this.div.prepend(o(this,fe))},Kd=new WeakSet,Nv=function(t,e){var b;e.preventDefault();const{isMac:i}=Oe.platform;if(e.button!==0||e.ctrlKey&&i)return;(b=o(this,Se))==null||b.toggle(!1);const n=A(this,Nl,$p).bind(this,t),s=this._isDraggable;this._isDraggable=!1;const a={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",n,a),window.addEventListener("contextmenu",Ne);const l=this.x,c=this.y,d=this.width,h=this.height,p=this.parent.div.style.cursor,g=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const v=()=>{var E;this.parent.togglePointerEvents(!0),(E=o(this,Se))==null||E.toggle(!0),this._isDraggable=s,window.removeEventListener("pointerup",v),window.removeEventListener("blur",v),window.removeEventListener("pointermove",n,a),window.removeEventListener("contextmenu",Ne),this.parent.div.style.cursor=p,this.div.style.cursor=g,A(this,Ol,Bp).call(this,l,c,d,h)};window.addEventListener("pointerup",v),window.addEventListener("blur",v)},Ol=new WeakSet,Bp=function(t,e,i,n){const s=this.x,a=this.y,l=this.width,c=this.height;s===t&&a===e&&l===i&&c===n||this.addCommands({cmd:()=>{this.width=l,this.height=c,this.x=s,this.y=a;const[d,h]=this.parentDimensions;this.setDims(d*l,h*c),this.fixAndSetPosition()},undo:()=>{this.width=i,this.height=n,this.x=t,this.y=e;const[d,h]=this.parentDimensions;this.setDims(d*i,h*n),this.fixAndSetPosition()},mustExec:!0})},Nl=new WeakSet,$p=function(t,e){const[i,n]=this.parentDimensions,s=this.x,a=this.y,l=this.width,c=this.height,d=Mt.MIN_SIZE/i,h=Mt.MIN_SIZE/n,p=B=>Math.round(B*1e4)/1e4,g=A(this,Dl,Np).call(this,this.rotation),v=(B,W)=>[g[0]*B+g[2]*W,g[1]*B+g[3]*W],b=A(this,Dl,Np).call(this,360-this.rotation),E=(B,W)=>[b[0]*B+b[2]*W,b[1]*B+b[3]*W];let C,_,R=!1,L=!1;switch(t){case"topLeft":R=!0,C=(B,W)=>[0,0],_=(B,W)=>[B,W];break;case"topMiddle":C=(B,W)=>[B/2,0],_=(B,W)=>[B/2,W];break;case"topRight":R=!0,C=(B,W)=>[B,0],_=(B,W)=>[0,W];break;case"middleRight":L=!0,C=(B,W)=>[B,W/2],_=(B,W)=>[0,W/2];break;case"bottomRight":R=!0,C=(B,W)=>[B,W],_=(B,W)=>[0,0];break;case"bottomMiddle":C=(B,W)=>[B/2,W],_=(B,W)=>[B/2,0];break;case"bottomLeft":R=!0,C=(B,W)=>[0,W],_=(B,W)=>[B,0];break;case"middleLeft":L=!0,C=(B,W)=>[0,W/2],_=(B,W)=>[B,W/2];break}const D=C(l,c),O=_(l,c);let N=v(...O);const j=p(s+N[0]),S=p(a+N[1]);let T=1,F=1,[k,U]=this.screenToPageTranslation(e.movementX,e.movementY);if([k,U]=E(k/i,U/n),R){const B=Math.hypot(l,c);T=F=Math.max(Math.min(Math.hypot(O[0]-D[0]-k,O[1]-D[1]-U)/B,1/l,1/c),d/l,h/c)}else L?T=Math.max(d,Math.min(1,Math.abs(O[0]-D[0]-k)))/l:F=Math.max(h,Math.min(1,Math.abs(O[1]-D[1]-U)))/c;const H=p(l*T),G=p(c*F);N=v(..._(H,G));const K=j-N[0],Z=S-N[1];this.width=H,this.height=G,this.x=K,this.y=Z,this.setDims(i*H,n*G),this.fixAndSetPosition()},Bl=new WeakSet,jp=function(t){const{isMac:e}=Oe.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},Zd=new WeakSet,Bv=function(t){const e=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let i,n;e&&(this.div.classList.add("moving"),i={passive:!0,capture:!0},w(this,ma,t.clientX),w(this,va,t.clientY),n=a=>{const{clientX:l,clientY:c}=a,[d,h]=this.screenToPageTranslation(l-o(this,ma),c-o(this,va));w(this,ma,l),w(this,va,c),this._uiManager.dragSelectedEditors(d,h)},window.addEventListener("pointermove",n,i));const s=()=>{window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),e&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",n,i)),w(this,$s,!1),this._uiManager.endDragSession()||A(this,Bl,jp).call(this,t)};window.addEventListener("pointerup",s),window.addEventListener("blur",s)},Jd=new WeakSet,$v=function(t){Mt._resizerKeyboardManager.exec(this,t)},Qd=new WeakSet,jv=function(t){var e;o(this,ln)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==o(this,fe)&&A(this,Us,Io).call(this)},tu=new WeakSet,Uv=function(t){w(this,Ll,o(this,ln)?t:"")},$l=new WeakSet,Up=function(t){if(o(this,li))for(const e of o(this,li))e.tabIndex=t},Us=new WeakSet,Io=function(){if(w(this,ln,!1),A(this,$l,Up).call(this,-1),o(this,Bs)){const{savedX:t,savedY:e,savedWidth:i,savedHeight:n}=o(this,Bs);A(this,Ol,Bp).call(this,t,e,i,n),w(this,Bs,null)}},m(Mt,Ml),ct(Mt,"_borderLineWidth",-1),ct(Mt,"_colorManager",new Cp),ct(Mt,"_zIndex",1),ct(Mt,"_telemetryTimeout",1e3);let Lt=Mt;class CC extends Lt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}const jm=3285377520,Ke=4294901760,bi=65535;class Hv{constructor(t){this.h1=t?t&4294967295:jm,this.h2=t?t&4294967295:jm}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let E=0,C=t.length;E<C;E++){const _=t.charCodeAt(E);_<=255?e[i++]=_:(e[i++]=_>>>8,e[i++]=_&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=i>>2,s=i-n*4,a=new Uint32Array(e.buffer,0,n);let l=0,c=0,d=this.h1,h=this.h2;const p=3432918353,g=461845907,v=p&bi,b=g&bi;for(let E=0;E<n;E++)E&1?(l=a[E],l=l*p&Ke|l*v&bi,l=l<<15|l>>>17,l=l*g&Ke|l*b&bi,d^=l,d=d<<13|d>>>19,d=d*5+3864292196):(c=a[E],c=c*p&Ke|c*v&bi,c=c<<15|c>>>17,c=c*g&Ke|c*b&bi,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(l=0,s){case 3:l^=e[n*4+2]<<16;case 2:l^=e[n*4+1]<<8;case 1:l^=e[n*4],l=l*p&Ke|l*v&bi,l=l<<15|l>>>17,l=l*g&Ke|l*b&bi,n&1?d^=l:h^=l}this.h1=d,this.h2=h}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Ke|t*36045&bi,e=e*4283543511&Ke|((e<<16|t>>>16)*2950163797&Ke)>>>16,t^=e>>>1,t=t*444984403&Ke|t*60499&bi,e=e*3301882366&Ke|((e<<16|t>>>16)*3120437893&Ke)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Hp=Object.freeze({map:null,hash:"",transfer:void 0});var Hs,pe,eu,zv;class nm{constructor(){m(this,eu);m(this,Hs,!1);m(this,pe,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=o(this,pe).get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return o(this,pe).get(t)}remove(t){if(o(this,pe).delete(t),o(this,pe).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of o(this,pe).values())if(e instanceof Lt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=o(this,pe).get(t);let n=!1;if(i!==void 0)for(const[s,a]of Object.entries(e))i[s]!==a&&(n=!0,i[s]=a);else n=!0,o(this,pe).set(t,e);n&&A(this,eu,zv).call(this),e instanceof Lt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return o(this,pe).has(t)}getAll(){return o(this,pe).size>0?Kg(o(this,pe)):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return o(this,pe).size}resetModified(){o(this,Hs)&&(w(this,Hs,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Gv(this)}get serializable(){if(o(this,pe).size===0)return Hp;const t=new Map,e=new Hv,i=[],n=Object.create(null);let s=!1;for(const[a,l]of o(this,pe)){const c=l instanceof Lt?l.serialize(!1,n):l;c&&(t.set(a,c),e.update(`${a}:${JSON.stringify(c)}`),s||(s=!!c.bitmap))}if(s)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:Hp}get editorStats(){let t=null;const e=new Map;for(const i of o(this,pe).values()){if(!(i instanceof Lt))continue;const n=i.telemetryFinalData;if(!n)continue;const{type:s}=n;e.has(s)||e.set(s,Object.getPrototypeOf(i).constructor),t||(t=Object.create(null));const a=t[s]||(t[s]=new Map);for(const[l,c]of Object.entries(n)){if(l==="type")continue;let d=a.get(l);d||(d=new Map,a.set(l,d));const h=d.get(c)??0;d.set(c,h+1)}}for(const[i,n]of e)t[i]=n.computeTelemetryFinalData(t[i]);return t}}Hs=new WeakMap,pe=new WeakMap,eu=new WeakSet,zv=function(){o(this,Hs)||(w(this,Hs,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var jl;class Gv extends nm{constructor(e){super();m(this,jl,void 0);const{map:i,hash:n,transfer:s}=e.serializable,a=structuredClone(i,s?{transfer:s}:null);w(this,jl,{map:a,hash:n,transfer:s})}get print(){It("Should not call PrintAnnotationStorage.print")}get serializable(){return o(this,jl)}}jl=new WeakMap;var ba;class TC{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){m(this,ba,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),o(this,ba).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||o(this,ba).has(t.loadedName))){if(ie(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:n,style:s}=t,a=new FontFace(i,n,s);this.addNativeFontFace(a);try{await a.load(),o(this,ba).add(i),e==null||e(t)}catch{pt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}It("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(n){throw pt(`Failed to load font '${i.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const n=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return Et(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Ae||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Et(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(ie(!n.done,"completeRequest() cannot be called twice."),n.done=!0;i.length>0&&i[0].done;){const s=i.shift();setTimeout(s.callback,0)}}const{loadingRequests:i}=this,n={done:!1,complete:e,callback:t};return i.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Et(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(D,O){return D.charCodeAt(O)<<24|D.charCodeAt(O+1)<<16|D.charCodeAt(O+2)<<8|D.charCodeAt(O+3)&255}function n(D,O,N,j){const S=D.substring(0,O),T=D.substring(O+N);return S+j+T}let s,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let d=0;function h(D,O){if(++d>30){pt("Load test font never loaded."),O();return}if(c.font="30px "+D,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(h.bind(null,D,O))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let g=this._loadTestFont;g=n(g,976,p.length,p);const b=16,E=1482184792;let C=i(g,b);for(s=0,a=p.length-3;s<a;s+=4)C=C-E+i(p,s)|0;s<p.length&&(C=C-E+i(p+"XXX",s)|0),g=n(g,b,4,hC(C));const _=`url(data:font/opentype;base64,${btoa(g)});`,R=`@font-face {font-family:"${p}";src:${_}}`;this.insertRule(R);const L=this._document.createElement("div");L.style.visibility="hidden",L.style.width=L.style.height="10px",L.style.position="absolute",L.style.top=L.style.left="0px";for(const D of[t.loadedName,p]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=D,L.append(O)}this._document.body.append(L),h(p,()=>{L.remove(),e.complete()})}}ba=new WeakMap;class PC{constructor(t,{disableFontFace:e=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this.disableFontFace=e===!0,this._inspectFont=i}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=fv(this.data),e=`url(data:${this.mimetype};base64,${btoa(t)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),i}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];let i;try{i=t.get(this.loadedName+"_path_"+e)}catch(s){pt(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(i)||i.length===0)return this.compiledGlyphs[e]=function(s,a){};const n=[];for(let s=0,a=i.length;s<a;)switch(i[s++]){case Gi.BEZIER_CURVE_TO:{const[l,c,d,h,p,g]=i.slice(s,s+6);n.push(v=>v.bezierCurveTo(l,c,d,h,p,g)),s+=6}break;case Gi.MOVE_TO:{const[l,c]=i.slice(s,s+2);n.push(d=>d.moveTo(l,c)),s+=2}break;case Gi.LINE_TO:{const[l,c]=i.slice(s,s+2);n.push(d=>d.lineTo(l,c)),s+=2}break;case Gi.QUADRATIC_CURVE_TO:{const[l,c,d,h]=i.slice(s,s+4);n.push(p=>p.quadraticCurveTo(l,c,d,h)),s+=4}break;case Gi.RESTORE:n.push(l=>l.restore());break;case Gi.SAVE:n.push(l=>l.save());break;case Gi.SCALE:ie(n.length===2,"Scale command is only valid at the third position.");break;case Gi.TRANSFORM:{const[l,c,d,h,p,g]=i.slice(s,s+6);n.push(v=>v.transform(l,c,d,h,p,g)),s+=6}break;case Gi.TRANSLATE:{const[l,c]=i.slice(s,s+2);n.push(d=>d.translate(l,c)),s+=2}break}return this.compiledGlyphs[e]=function(a,l){n[0](a),n[1](a),a.scale(l,-l);for(let c=2,d=n.length;c<d;c++)n[c](a)}}}if(Ae){var zp=Promise.withResolvers(),zo=null;(async()=>{const t=await Promise.resolve().then(()=>require("./empty-DBAFSQIv.cjs")),e=await Promise.resolve().then(()=>require("./index-Dbv33sjN.cjs")).then(l=>l.index),i=await Promise.resolve().then(()=>require("./index-DAUD_hvb.cjs")).then(l=>l.index),n=await Promise.resolve().then(()=>require("./url-BgS6Onmk.cjs")).then(l=>l.url);let s,a;return new Map(Object.entries({fs:t,http:e,https:i,url:n,canvas:s,path2d:a}))})().then(t=>{zo=t,zp.resolve()},t=>{pt(`loadPackages: ${t}`),zo=new Map,zp.resolve()})}class Ui{static get promise(){return zp.promise}static get(t){return zo==null?void 0:zo.get(t)}}const Vv=function(r){return Ui.get("fs").promises.readFile(r).then(e=>new Uint8Array(e))};class RC extends bf{}class LC extends yf{_createCanvas(t,e){return Ui.get("canvas").createCanvas(t,e)}}class kC extends wf{_fetchData(t,e){return Vv(t).then(i=>({cMapData:i,compressionType:e}))}}class IC extends Af{_fetchData(t){return Vv(t)}}const Pe={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Gp(r,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],e,i),r.clip(n)}class Eh{constructor(){this.constructor===Eh&&It("Cannot initialize BaseShadingPattern.")}getPattern(){It("Abstract method `getPattern` called.")}}class FC extends Eh{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,n){let s;if(n===Pe.STROKE||n===Pe.FILL){const a=e.current.getClippedPathBoundingBox(n,jt(t))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,d=e.cachedCanvases.getCanvas("pattern",l,c,!0),h=d.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),i=J.transform(i,[1,0,0,1,a[0],a[1]]),h.transform(...e.baseTransform),this.matrix&&h.transform(...this.matrix),Gp(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),s=t.createPattern(d.canvas,"no-repeat");const p=new DOMMatrix(i);s.setTransform(p)}else Gp(t,this._bbox),s=this._createGradient(t);return s}}function ep(r,t,e,i,n,s,a,l){const c=t.coords,d=t.colors,h=r.data,p=r.width*4;let g;c[e+1]>c[i+1]&&(g=e,e=i,i=g,g=s,s=a,a=g),c[i+1]>c[n+1]&&(g=i,i=n,n=g,g=a,a=l,l=g),c[e+1]>c[i+1]&&(g=e,e=i,i=g,g=s,s=a,a=g);const v=(c[e]+t.offsetX)*t.scaleX,b=(c[e+1]+t.offsetY)*t.scaleY,E=(c[i]+t.offsetX)*t.scaleX,C=(c[i+1]+t.offsetY)*t.scaleY,_=(c[n]+t.offsetX)*t.scaleX,R=(c[n+1]+t.offsetY)*t.scaleY;if(b>=R)return;const L=d[s],D=d[s+1],O=d[s+2],N=d[a],j=d[a+1],S=d[a+2],T=d[l],F=d[l+1],k=d[l+2],U=Math.round(b),H=Math.round(R);let G,K,Z,B,W,q,xt,vt;for(let V=U;V<=H;V++){if(V<C){const Q=V<b?0:(b-V)/(b-C);G=v-(v-E)*Q,K=L-(L-N)*Q,Z=D-(D-j)*Q,B=O-(O-S)*Q}else{let Q;V>R?Q=1:C===R?Q=0:Q=(C-V)/(C-R),G=E-(E-_)*Q,K=N-(N-T)*Q,Z=j-(j-F)*Q,B=S-(S-k)*Q}let it;V<b?it=0:V>R?it=1:it=(b-V)/(b-R),W=v-(v-_)*it,q=L-(L-T)*it,xt=D-(D-F)*it,vt=O-(O-k)*it;const et=Math.round(Math.min(G,W)),nt=Math.round(Math.max(G,W));let dt=p*V+et*4;for(let Q=et;Q<=nt;Q++)it=(G-Q)/(G-W),it<0?it=0:it>1&&(it=1),h[dt++]=K-(K-q)*it|0,h[dt++]=Z-(Z-xt)*it|0,h[dt++]=B-(B-vt)*it|0,h[dt++]=255}}function MC(r,t,e){const i=t.coords,n=t.colors;let s,a;switch(t.type){case"lattice":const l=t.verticesPerRow,c=Math.floor(i.length/l)-1,d=l-1;for(s=0;s<c;s++){let h=s*l;for(let p=0;p<d;p++,h++)ep(r,e,i[h],i[h+1],i[h+l],n[h],n[h+1],n[h+l]),ep(r,e,i[h+l+1],i[h+1],i[h+l],n[h+l+1],n[h+1],n[h+l])}break;case"triangles":for(s=0,a=i.length;s<a;s+=3)ep(r,e,i[s],i[s+1],i[s+2],n[s],n[s+1],n[s+2]);break;default:throw new Error("illegal figure")}}class DC extends Eh{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,i){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-l,h=Math.ceil(this._bounds[3])-c,p=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),g=Math.min(Math.ceil(Math.abs(h*t[1]*1.1)),3e3),v=d/p,b=h/g,E={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/v,scaleY:1/b},C=p+2*2,_=g+2*2,R=i.getCanvas("mesh",C,_,!1),L=R.context,D=L.createImageData(p,g);if(e){const N=D.data;for(let j=0,S=N.length;j<S;j+=4)N[j]=e[0],N[j+1]=e[1],N[j+2]=e[2],N[j+3]=255}for(const N of this._figures)MC(D,N,E);return L.putImageData(D,2,2),{canvas:R.canvas,offsetX:l-2*v,offsetY:c-2*b,scaleX:v,scaleY:b}}getPattern(t,e,i,n){Gp(t,this._bbox);let s;if(n===Pe.SHADING)s=J.singularValueDecompose2dScale(jt(t));else if(s=J.singularValueDecompose2dScale(e.baseTransform),this.matrix){const l=J.singularValueDecompose2dScale(this.matrix);s=[s[0]*l[0],s[1]*l[1]]}const a=this._createMeshCanvas(s,n===Pe.SHADING?null:this._background,e.cachedCanvases);return n!==Pe.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class OC extends Eh{getPattern(){return"hotpink"}}function NC(r){switch(r[0]){case"RadialAxial":return new FC(r);case"Mesh":return new DC(r);case"Dummy":return new OC}throw new Error(`Unknown IR type: ${r[0]}`)}const Um={COLORED:1,UNCOLORED:2},iu=class iu{constructor(t,e,i,n,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(t){const e=this.operatorList,i=this.bbox,n=this.xstep,s=this.ystep,a=this.paintType,l=this.tilingType,c=this.color,d=this.canvasGraphicsFactory;gf("TilingType: "+l);const h=i[0],p=i[1],g=i[2],v=i[3],b=J.singularValueDecompose2dScale(this.matrix),E=J.singularValueDecompose2dScale(this.baseTransform),C=[b[0]*E[0],b[1]*E[1]],_=this.getSizeAndScale(n,this.ctx.canvas.width,C[0]),R=this.getSizeAndScale(s,this.ctx.canvas.height,C[1]),L=t.cachedCanvases.getCanvas("pattern",_.size,R.size,!0),D=L.context,O=d.createCanvasGraphics(D);O.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(O,a,c);let N=h,j=p,S=g,T=v;return h<0&&(N=0,S+=Math.abs(h)),p<0&&(j=0,T+=Math.abs(p)),D.translate(-(_.scale*N),-(R.scale*j)),O.transform(_.scale,0,0,R.scale,0,0),D.save(),this.clipBbox(O,N,j,S,T),O.baseTransform=jt(O.ctx),O.executeOperatorList(e),O.endDrawing(),{canvas:L.canvas,scaleX:_.scale,scaleY:R.scale,offsetX:N,offsetY:j}}getSizeAndScale(t,e,i){t=Math.abs(t);const n=Math.max(iu.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*i);return s>=n?s=n:i=s/t,{scale:i,size:s}}clipBbox(t,e,i,n,s){const a=n-e,l=s-i;t.ctx.rect(e,i,a,l),t.current.updateRectMinMax(jt(t.ctx),[e,i,n,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const n=t.ctx,s=t.current;switch(e){case Um.COLORED:const a=this.ctx;n.fillStyle=a.fillStyle,n.strokeStyle=a.strokeStyle,s.fillColor=a.fillStyle,s.strokeColor=a.strokeStyle;break;case Um.UNCOLORED:const l=J.makeHexColor(i[0],i[1],i[2]);n.fillStyle=l,n.strokeStyle=l,s.fillColor=l,s.strokeColor=l;break;default:throw new cC(`Unsupported paint type: ${e}`)}}getPattern(t,e,i,n){let s=i;n!==Pe.SHADING&&(s=J.transform(s,e.baseTransform),this.matrix&&(s=J.transform(s,this.matrix)));const a=this.createPatternCanvas(e);let l=new DOMMatrix(s);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);const c=t.createPattern(a.canvas,"repeat");return c.setTransform(l),c}};ct(iu,"MAX_PATTERN_SIZE",3e3);let Vp=iu;function BC({src:r,srcPos:t=0,dest:e,width:i,height:n,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const l=Oe.isLittleEndian?4278190080:255,[c,d]=a?[s,l]:[l,s],h=i>>3,p=i&7,g=r.length;e=new Uint32Array(e.buffer);let v=0;for(let b=0;b<n;b++){for(const C=t+h;t<C;t++){const _=t<g?r[t]:255;e[v++]=_&128?d:c,e[v++]=_&64?d:c,e[v++]=_&32?d:c,e[v++]=_&16?d:c,e[v++]=_&8?d:c,e[v++]=_&4?d:c,e[v++]=_&2?d:c,e[v++]=_&1?d:c}if(p===0)continue;const E=t<g?r[t++]:255;for(let C=0;C<p;C++)e[v++]=E&1<<7-C?d:c}return{srcPos:t,destPos:v}}const Hm=16,zm=100,$C=15,Gm=10,Vm=1e3,Fe=16;function jC(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(i,n){t.translate(i,n),this.__originalTranslate(i,n)},r.scale=function(i,n){t.scale(i,n),this.__originalScale(i,n)},r.transform=function(i,n,s,a,l,c){t.transform(i,n,s,a,l,c),this.__originalTransform(i,n,s,a,l,c)},r.setTransform=function(i,n,s,a,l,c){t.setTransform(i,n,s,a,l,c),this.__originalSetTransform(i,n,s,a,l,c)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(i){t.rotate(i),this.__originalRotate(i)},r.clip=function(i){t.clip(i),this.__originalClip(i)},r.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},r.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},r.bezierCurveTo=function(e,i,n,s,a,l){t.bezierCurveTo(e,i,n,s,a,l),this.__originalBezierCurveTo(e,i,n,s,a,l)},r.rect=function(e,i,n,s){t.rect(e,i,n,s),this.__originalRect(e,i,n,s)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class UC{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,e,i)):(n=this.canvasFactory.create(e,i),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Ih(r,t,e,i,n,s,a,l,c,d){const[h,p,g,v,b,E]=jt(r);if(p===0&&g===0){const R=a*h+b,L=Math.round(R),D=l*v+E,O=Math.round(D),N=(a+c)*h+b,j=Math.abs(Math.round(N)-L)||1,S=(l+d)*v+E,T=Math.abs(Math.round(S)-O)||1;return r.setTransform(Math.sign(h),0,0,Math.sign(v),L,O),r.drawImage(t,e,i,n,s,0,0,j,T),r.setTransform(h,p,g,v,b,E),[j,T]}if(h===0&&v===0){const R=l*g+b,L=Math.round(R),D=a*p+E,O=Math.round(D),N=(l+d)*g+b,j=Math.abs(Math.round(N)-L)||1,S=(a+c)*p+E,T=Math.abs(Math.round(S)-O)||1;return r.setTransform(0,Math.sign(p),Math.sign(g),0,L,O),r.drawImage(t,e,i,n,s,0,0,T,j),r.setTransform(h,p,g,v,b,E),[T,j]}r.drawImage(t,e,i,n,s,a,l,c,d);const C=Math.hypot(h,p),_=Math.hypot(g,v);return[C*c,_*d]}function HC(r){const{width:t,height:e}=r;if(t>Vm||e>Vm)return null;const i=1e3,n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=t+1;let a=new Uint8Array(s*(e+1)),l,c,d;const h=t+7&-8;let p=new Uint8Array(h*e),g=0;for(const _ of r.data){let R=128;for(;R>0;)p[g++]=_&R?0:255,R>>=1}let v=0;for(g=0,p[g]!==0&&(a[0]=1,++v),c=1;c<t;c++)p[g]!==p[g+1]&&(a[c]=p[g]?2:1,++v),g++;for(p[g]!==0&&(a[c]=2,++v),l=1;l<e;l++){g=l*h,d=l*s,p[g-h]!==p[g]&&(a[d]=p[g]?1:8,++v);let _=(p[g]?4:0)+(p[g-h]?8:0);for(c=1;c<t;c++)_=(_>>2)+(p[g+1]?4:0)+(p[g-h+1]?8:0),n[_]&&(a[d+c]=n[_],++v),g++;if(p[g-h]!==p[g]&&(a[d+c]=p[g]?2:4,++v),v>i)return null}for(g=h*(e-1),d=l*s,p[g]!==0&&(a[d]=8,++v),c=1;c<t;c++)p[g]!==p[g+1]&&(a[d+c]=p[g]?4:8,++v),g++;if(p[g]!==0&&(a[d+c]=4,++v),v>i)return null;const b=new Int32Array([0,s,-1,0,-s,0,0,0,1]),E=new Path2D;for(l=0;v&&l<=e;l++){let _=l*s;const R=_+t;for(;_<R&&!a[_];)_++;if(_===R)continue;E.moveTo(_%s,l);const L=_;let D=a[_];do{const O=b[D];do _+=O;while(!a[_]);const N=a[_];N!==5&&N!==10?(D=N,a[_]=0):(D=N&51*D>>4,a[_]&=D>>2|D<<2),E.lineTo(_%s,_/s|0),a[_]||--v}while(L!==_);--l}return p=null,a=null,function(_){_.save(),_.scale(1/t,-1/e),_.translate(0,-e),_.fill(E),_.beginPath(),_.restore()}}class Wm{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=dv,this.textMatrixScale=1,this.fontMatrix=gp,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=ve.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,i){[e,i]=J.applyTransform([e,i],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,e){const i=J.applyTransform(e,t),n=J.applyTransform(e.slice(2),t),s=J.applyTransform([e[0],e[3]],t),a=J.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],n[0],s[0],a[0]),this.minY=Math.min(this.minY,i[1],n[1],s[1],a[1]),this.maxX=Math.max(this.maxX,i[0],n[0],s[0],a[0]),this.maxY=Math.max(this.maxY,i[1],n[1],s[1],a[1])}updateScalingPathMinMax(t,e){J.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,i,n,s,a,l,c,d,h){const p=J.bezierBoundingBox(e,i,n,s,a,l,c,d,h);h||this.updateRectMinMax(t,p)}getPathBoundingBox(t=Pe.FILL,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===Pe.STROKE){e||It("Stroke bounding box must include transform.");const n=J.singularValueDecompose2dScale(e),s=n[0]*this.lineWidth/2,a=n[1]*this.lineWidth/2;i[0]-=s,i[1]-=a,i[2]+=s,i[3]+=a}return i}updateClipFromPath(){const t=J.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Pe.FILL,e=null){return J.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function qm(r,t){if(typeof ImageData<"u"&&t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,i=t.width,n=e%Fe,s=(e-n)/Fe,a=n===0?s:s+1,l=r.createImageData(i,Fe);let c=0,d;const h=t.data,p=l.data;let g,v,b,E;if(t.kind===jh.GRAYSCALE_1BPP){const C=h.byteLength,_=new Uint32Array(p.buffer,0,p.byteLength>>2),R=_.length,L=i+7>>3,D=4294967295,O=Oe.isLittleEndian?4278190080:255;for(g=0;g<a;g++){for(b=g<s?Fe:n,d=0,v=0;v<b;v++){const N=C-c;let j=0;const S=N>L?i:N*8-7,T=S&-8;let F=0,k=0;for(;j<T;j+=8)k=h[c++],_[d++]=k&128?D:O,_[d++]=k&64?D:O,_[d++]=k&32?D:O,_[d++]=k&16?D:O,_[d++]=k&8?D:O,_[d++]=k&4?D:O,_[d++]=k&2?D:O,_[d++]=k&1?D:O;for(;j<S;j++)F===0&&(k=h[c++],F=128),_[d++]=k&F?D:O,F>>=1}for(;d<R;)_[d++]=0;r.putImageData(l,0,g*Fe)}}else if(t.kind===jh.RGBA_32BPP){for(v=0,E=i*Fe*4,g=0;g<s;g++)p.set(h.subarray(c,c+E)),c+=E,r.putImageData(l,0,v),v+=Fe;g<a&&(E=i*n*4,p.set(h.subarray(c,c+E)),r.putImageData(l,0,v))}else if(t.kind===jh.RGB_24BPP)for(b=Fe,E=i*b,g=0;g<a;g++){for(g>=s&&(b=n,E=i*b),d=0,v=E;v--;)p[d++]=h[c++],p[d++]=h[c++],p[d++]=h[c++],p[d++]=255;r.putImageData(l,0,g*Fe)}else throw new Error(`bad image kind: ${t.kind}`)}function Xm(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,n=e%Fe,s=(e-n)/Fe,a=n===0?s:s+1,l=r.createImageData(i,Fe);let c=0;const d=t.data,h=l.data;for(let p=0;p<a;p++){const g=p<s?Fe:n;({srcPos:c}=BC({src:d,srcPos:c,dest:h,width:i,height:g,nonBlackColor:0})),r.putImageData(l,0,p*Fe)}}function So(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)r[i]!==void 0&&(t[i]=r[i]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function Fh(r){if(r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0),!Ae){const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}}function Ym(r,t){if(t)return!0;const e=J.singularValueDecompose2dScale(r);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*hs.PDF_TO_CSS_UNITS);return e[0]<=i&&e[1]<=i}const zC=["butt","round","square"],GC=["miter","round","bevel"],VC={},Km={};var Ul,Wp,Hl,qp;const lm=class lm{constructor(t,e,i,n,s,{optionalContentConfig:a,markedContentStack:l=null},c,d){m(this,Ul);m(this,Hl);this.ctx=t,this.current=new Wm(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=n,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new UC(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:n=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=l,i){const c=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...jt(this.compositeCtx))}this.ctx.save(),Fh(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=jt(this.ctx)}executeOperatorList(t,e,i,n){const s=t.argsArray,a=t.fnArray;let l=e||0;const c=s.length;if(c===l)return l;const d=c-l>Gm&&typeof i=="function",h=d?Date.now()+$C:0;let p=0;const g=this.commonObjs,v=this.objs;let b;for(;;){if(n!==void 0&&l===n.nextBreakPoint)return n.breakIt(l,i),l;if(b=a[l],b!==si.dependency)this[b].apply(this,s[l]);else for(const E of s[l]){const C=E.startsWith("g_")?g:v;if(!C.has(E))return C.get(E,i),l}if(l++,l===c)return l;if(d&&++p>Gm){if(Date.now()>h)return i(),l;p=0}}}endDrawing(){A(this,Ul,Wp).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),A(this,Hl,qp).call(this)}_scaleImage(t,e){const i=t.width,n=t.height;let s=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),l=i,c=n,d="prescale1",h,p;for(;s>2&&l>1||a>2&&c>1;){let g=l,v=c;s>2&&l>1&&(g=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/g),a>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/v),h=this.cachedCanvases.getCanvas(d,g,v),p=h.context,p.clearRect(0,0,g,v),p.drawImage(t,0,0,l,c,0,0,g,v),t=h.canvas,l=g,c=v,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:c}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:n}=t,s=this.current.fillColor,a=this.current.patternFill,l=jt(e);let c,d,h,p;if((t.bitmap||t.data)&&t.count>1){const S=t.bitmap||t.data.buffer;d=JSON.stringify(a?l:[l.slice(0,4),s]),c=this._cachedBitmapsMap.get(S),c||(c=new Map,this._cachedBitmapsMap.set(S,c));const T=c.get(d);if(T&&!a){const F=Math.round(Math.min(l[0],l[2])+l[4]),k=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:T,offsetX:F,offsetY:k}}h=T}h||(p=this.cachedCanvases.getCanvas("maskCanvas",i,n),Xm(p.context,t));let g=J.transform(l,[1/i,0,0,-1/n,0,0]);g=J.transform(g,[1,0,0,1,0,-n]);const[v,b,E,C]=J.getAxialAlignedBoundingBox([0,0,i,n],g),_=Math.round(E-v)||1,R=Math.round(C-b)||1,L=this.cachedCanvases.getCanvas("fillCanvas",_,R),D=L.context,O=v,N=b;D.translate(-O,-N),D.transform(...g),h||(h=this._scaleImage(p.canvas,Vi(D)),h=h.img,c&&a&&c.set(d,h)),D.imageSmoothingEnabled=Ym(jt(D),t.interpolate),Ih(D,h,0,0,h.width,h.height,0,0,i,n),D.globalCompositeOperation="source-in";const j=J.transform(Vi(D),[1,0,0,1,-O,-N]);return D.fillStyle=a?s.getPattern(e,this,j,Pe.FILL):s,D.fillRect(0,0,i,n),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(d,L.canvas)),{canvas:L.canvas,offsetX:Math.round(O),offsetY:Math.round(N)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=zC[t]}setLineJoin(t){this.ctx.lineJoin=GC[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx,this.ctx=n.context;const s=this.ctx;s.setTransform(...jt(this.suspendedCtx)),So(this.suspendedCtx,s),jC(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),So(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,n){const s=n[0],a=n[1],l=n[2]-s,c=n[3]-a;l===0||c===0||(this.genericComposeSMask(e.context,i,l,c,e.subtype,e.backdrop,e.transferMap,s,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,n,s,a,l,c,d,h,p){let g=t.canvas,v=c-h,b=d-p;if(a){if(v<0||b<0||v+i>g.width||b+n>g.height){const C=this.cachedCanvases.getCanvas("maskExtension",i,n),_=C.context;_.drawImage(g,-v,-b),a.some(R=>R!==0)&&(_.globalCompositeOperation="destination-atop",_.fillStyle=J.makeHexColor(...a),_.fillRect(0,0,i,n),_.globalCompositeOperation="source-over"),g=C.canvas,v=b=0}else if(a.some(C=>C!==0)){t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(v,b,i,n),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=J.makeHexColor(...a),t.fillRect(v,b,i,n),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const E=new Path2D;E.rect(c,d,i,n),e.clip(E),e.globalCompositeOperation="destination-in",e.drawImage(g,v,b,i,n,c,d,i,n),e.restore()}save(){this.inSMaskMode?(So(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),So(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,i,n,s,a){this.ctx.transform(t,e,i,n,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){const n=this.ctx,s=this.current;let a=s.x,l=s.y,c,d;const h=jt(n),p=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,g=p?i.slice(0):null;for(let v=0,b=0,E=t.length;v<E;v++)switch(t[v]|0){case si.rectangle:a=e[b++],l=e[b++];const C=e[b++],_=e[b++],R=a+C,L=l+_;n.moveTo(a,l),C===0||_===0?n.lineTo(R,L):(n.lineTo(R,l),n.lineTo(R,L),n.lineTo(a,L)),p||s.updateRectMinMax(h,[a,l,R,L]),n.closePath();break;case si.moveTo:a=e[b++],l=e[b++],n.moveTo(a,l),p||s.updatePathMinMax(h,a,l);break;case si.lineTo:a=e[b++],l=e[b++],n.lineTo(a,l),p||s.updatePathMinMax(h,a,l);break;case si.curveTo:c=a,d=l,a=e[b+4],l=e[b+5],n.bezierCurveTo(e[b],e[b+1],e[b+2],e[b+3],a,l),s.updateCurvePathMinMax(h,c,d,e[b],e[b+1],e[b+2],e[b+3],a,l,g),b+=6;break;case si.curveTo2:c=a,d=l,n.bezierCurveTo(a,l,e[b],e[b+1],e[b+2],e[b+3]),s.updateCurvePathMinMax(h,c,d,a,l,e[b],e[b+1],e[b+2],e[b+3],g),a=e[b+2],l=e[b+3],b+=4;break;case si.curveTo3:c=a,d=l,a=e[b+2],l=e[b+3],n.bezierCurveTo(e[b],e[b+1],a,l,a,l),s.updateCurvePathMinMax(h,c,d,e[b],e[b+1],a,l,a,l,g),b+=4;break;case si.closePath:n.closePath();break}p&&s.updateScalingPathMinMax(h,g),s.setCurrentPoint(a,l)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(e.save(),e.strokeStyle=i.getPattern(e,this,Vi(e),Pe.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,i=this.current.fillColor,n=this.current.patternFill;let s=!1;n&&(e.save(),e.fillStyle=i.getPattern(e,this,Vi(e),Pe.FILL),s=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),s&&e.restore(),t&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=VC}eoClip(){this.pendingClip=Km}beginText(){this.current.textMatrix=dv,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}e.save(),e.beginPath();for(const i of t)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var h;const i=this.commonObjs.get(t),n=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(n.fontMatrix=i.fontMatrix||gp,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&pt("Invalid font matrix for font "+t),e<0?(e=-e,n.fontDirection=-1):n.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const s=i.loadedName||"sans-serif",a=((h=i.systemFontInfo)==null?void 0:h.css)||`"${s}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const c=i.italic?"italic":"normal";let d=e;e<Hm?d=Hm:e>zm&&(d=zm),this.current.fontSizeScale=e/d,this.ctx.font=`${c} ${l} ${d}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,n,s,a){this.current.textMatrix=[t,e,i,n,s,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,n){const s=this.ctx,a=this.current,l=a.font,c=a.textRenderingMode,d=a.fontSize/a.fontSizeScale,h=c&ve.FILL_STROKE_MASK,p=!!(c&ve.ADD_TO_PATH_FLAG),g=a.patternFill&&!l.missingFile;let v;(l.disableFontFace||p||g)&&(v=l.getPathGenerator(this.commonObjs,t)),l.disableFontFace||g?(s.save(),s.translate(e,i),s.beginPath(),v(s,d),n&&s.setTransform(...n),(h===ve.FILL||h===ve.FILL_STROKE)&&s.fill(),(h===ve.STROKE||h===ve.FILL_STROKE)&&s.stroke(),s.restore()):((h===ve.FILL||h===ve.FILL_STROKE)&&s.fillText(t,e,i),(h===ve.STROKE||h===ve.FILL_STROKE)&&s.strokeText(t,e,i)),p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:jt(s),x:e,y:i,fontSize:d,addToPath:v})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){i=!0;break}return Et(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const n=e.fontSize;if(n===0)return;const s=this.ctx,a=e.fontSizeScale,l=e.charSpacing,c=e.wordSpacing,d=e.fontDirection,h=e.textHScale*d,p=t.length,g=i.vertical,v=g?1:-1,b=i.defaultVMetrics,E=n*e.fontMatrix[0],C=e.textRenderingMode===ve.FILL&&!i.disableFontFace&&!e.patternFill;s.save(),s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),d>0?s.scale(h,-1):s.scale(h,1);let _;if(e.patternFill){s.save();const N=e.fillColor.getPattern(s,this,Vi(s),Pe.FILL);_=jt(s),s.restore(),s.fillStyle=N}let R=e.lineWidth;const L=e.textMatrixScale;if(L===0||R===0){const N=e.textRenderingMode&ve.FILL_STROKE_MASK;(N===ve.STROKE||N===ve.FILL_STROKE)&&(R=this.getSinglePixelWidth())}else R/=L;if(a!==1&&(s.scale(a,a),R/=a),s.lineWidth=R,i.isInvalidPDFjsFont){const N=[];let j=0;for(const S of t)N.push(S.unicode),j+=S.width;s.fillText(N.join(""),0,0),e.x+=j*E*h,s.restore(),this.compose();return}let D=0,O;for(O=0;O<p;++O){const N=t[O];if(typeof N=="number"){D+=v*N*n/1e3;continue}let j=!1;const S=(N.isSpace?c:0)+l,T=N.fontChar,F=N.accent;let k,U,H=N.width;if(g){const K=N.vmetric||b,Z=-(N.vmetric?K[1]:H*.5)*E,B=K[2]*E;H=K?-K[0]:H,k=Z/a,U=(D+B)/a}else k=D/a,U=0;if(i.remeasure&&H>0){const K=s.measureText(T).width*1e3/n*a;if(H<K&&this.isFontSubpixelAAEnabled){const Z=H/K;j=!0,s.save(),s.scale(Z,1),k/=Z}else H!==K&&(k+=(H-K)/2e3*n/a)}if(this.contentVisible&&(N.isInFont||i.missingFile)){if(C&&!F)s.fillText(T,k,U);else if(this.paintChar(T,k,U,_),F){const K=k+n*F.offset.x/a,Z=U-n*F.offset.y/a;this.paintChar(F.fontChar,K,Z,_)}}const G=g?H*E-S*d:H*E+S*d;D+=G,j&&s.restore()}g?e.y-=D:e.x+=D*h,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,n=i.font,s=i.fontSize,a=i.fontDirection,l=n.vertical?1:-1,c=i.charSpacing,d=i.wordSpacing,h=i.textHScale*a,p=i.fontMatrix||gp,g=t.length,v=i.textRenderingMode===ve.INVISIBLE;let b,E,C,_;if(!(v||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(h,a),b=0;b<g;++b){if(E=t[b],typeof E=="number"){_=l*E*s/1e3,this.ctx.translate(_,0),i.x+=_*h;continue}const R=(E.isSpace?d:0)+c,L=n.charProcOperatorList[E.operatorListId];if(!L){pt(`Type3 character "${E.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=E,this.save(),e.scale(s,s),e.transform(...p),this.executeOperatorList(L),this.restore()),C=J.applyTransform([E.width,0],p)[0]*s+R,e.translate(C,0),i.x+=C*h}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,n,s,a){this.ctx.rect(i,n,s-i,a-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const i=t[1],n=this.baseTransform||jt(this.ctx),s={createCanvasGraphics:a=>new lm(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Vp(t,i,this.ctx,s,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){const n=J.makeHexColor(t,e,i);this.ctx.strokeStyle=n,this.current.strokeColor=n}setFillRGBColor(t,e,i){const n=J.makeHexColor(t,e,i);this.ctx.fillStyle=n,this.current.fillColor=n,this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=NC(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,Vi(e),Pe.SHADING);const n=Vi(e);if(n){const{width:s,height:a}=e.canvas,[l,c,d,h]=J.getAxialAlignedBoundingBox([0,0,s,a],n);this.ctx.fillRect(l,c,d-l,h-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){It("Should not call beginInlineImage")}beginImageData(){It("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=jt(this.ctx),e)){const i=e[2]-e[0],n=e[3]-e[1];this.ctx.rect(e[0],e[1],i,n),this.current.updateRectMinMax(jt(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||gf("TODO: Support non-isolated groups."),t.knockout&&pt("Knockout groups not supported.");const i=jt(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let n=J.getAxialAlignedBoundingBox(t.bbox,jt(e));const s=[0,0,e.canvas.width,e.canvas.height];n=J.intersect(n,s)||[0,0,0,0];const a=Math.floor(n[0]),l=Math.floor(n[1]),c=Math.max(Math.ceil(n[2])-a,1),d=Math.max(Math.ceil(n[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,d]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(h,c,d),g=p.context;g.translate(-a,-l),g.transform(...i),t.smask?this.smaskStack.push({canvas:p.canvas,context:g,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,l),e.save()),So(e,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const n=jt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...n);const s=J.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],n);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,i,n,s){if(A(this,Ul,Wp).call(this),Fh(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],l=e[3]-e[1];if(s&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=l;const[c,d]=J.singularValueDecompose2dScale(jt(this.ctx)),{viewportScale:h}=this,p=Math.ceil(a*this.outputScaleX*h),g=Math.ceil(l*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(p,g);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(t,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(c,0,0,-d,0,l*d),Fh(this.ctx)}else Fh(this.ctx),this.ctx.rect(e[0],e[1],a,l),this.ctx.clip(),this.endPath()}this.current=new Wm(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),A(this,Hl,qp).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,n=this.processingType3;if(n&&(n.compiled===void 0&&(n.compiled=HC(t)),n.compiled)){n.compiled(i);return}const s=this._createMaskCanvas(t),a=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,s.offsetX,s.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,n=0,s,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const c=jt(l);l.transform(e,i,n,s,0,0);const d=this._createMaskCanvas(t);l.setTransform(1,0,0,1,d.offsetX-c[4],d.offsetY-c[5]);for(let h=0,p=a.length;h<p;h+=2){const g=J.transform(c,[e,i,n,s,a[h],a[h+1]]),[v,b]=J.applyTransform([0,0],g);l.drawImage(d.canvas,v,b)}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,n=this.current.patternFill;for(const s of t){const{data:a,width:l,height:c,transform:d}=s,h=this.cachedCanvases.getCanvas("maskCanvas",l,c),p=h.context;p.save();const g=this.getObject(a,s);Xm(p,g),p.globalCompositeOperation="source-in",p.fillStyle=n?i.getPattern(p,this,Vi(e),Pe.FILL):i,p.fillRect(0,0,l,c),p.restore(),e.save(),e.transform(...d),e.scale(1,-1),Ih(e,h.canvas,0,0,l,c,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){pt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,i,n){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){pt("Dependent image isn't ready yet");return}const a=s.width,l=s.height,c=[];for(let d=0,h=n.length;d<h;d+=2)c.push({transform:[e,0,0,i,n[d],n[d+1]],x:0,y:0,w:a,h:l});this.paintInlineImageXObjectGroup(s,c)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:n}=t,s=this.cachedCanvases.getCanvas("inlineImage",i,n),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,n=this.ctx;if(this.save(),!Ae){const{filter:l}=n;l!=="none"&&l!==""&&(n.filter="none")}n.scale(1/e,-1/i);let s;if(t.bitmap)s=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)s=t;else{const c=this.cachedCanvases.getCanvas("inlineImage",e,i).context;qm(c,t),s=this.applyTransferMapsToCanvas(c)}const a=this._scaleImage(s,Vi(n));n.imageSmoothingEnabled=Ym(jt(n),t.interpolate),Ih(n,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let n;if(t.bitmap)n=t.bitmap;else{const s=t.width,a=t.height,c=this.cachedCanvases.getCanvas("inlineImage",s,a).context;qm(c,t),n=this.applyTransferMapsToCanvas(c)}for(const s of e)i.save(),i.transform(...s.transform),i.scale(1,-1),Ih(i,n,s.x,s.y,s.w,s.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===Km?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=jt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:n,d:s}=this.ctx.getTransform();let a,l;if(i===0&&n===0){const c=Math.abs(e),d=Math.abs(s);if(c===d)if(t===0)a=l=1/c;else{const h=c*t;a=l=h<1?1/h:1}else if(t===0)a=1/c,l=1/d;else{const h=c*t,p=d*t;a=h<1?1/h:1,l=p<1?1/p:1}}else{const c=Math.abs(e*s-i*n),d=Math.hypot(e,i),h=Math.hypot(n,s);if(t===0)a=h/c,l=d/c;else{const p=t*c;a=h>p?h/p:1,l=d>p?d/p:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:i}=this.current,[n,s]=this.getScaleForStroking();if(e.lineWidth=i||1,n===1&&s===1){e.stroke();return}const a=e.getLineDash();if(t&&e.save(),e.scale(n,s),a.length>0){const l=Math.max(n,s);e.setLineDash(a.map(c=>c/l)),e.lineDashOffset/=l}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};Ul=new WeakSet,Wp=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Hl=new WeakSet,qp=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}};let Jr=lm;for(const r in si)Jr.prototype[r]!==void 0&&(Jr.prototype[si[r]]=Jr.prototype[r]);var zl,Gl;class Pn{static get workerPort(){return o(this,zl)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");w(this,zl,t)}static get workerSrc(){return o(this,Gl)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");w(this,Gl,t)}}zl=new WeakMap,Gl=new WeakMap,m(Pn,zl,null),m(Pn,Gl,"");const Mh={UNKNOWN:0,DATA:1,ERROR:2},Kt={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function $e(r){switch(r instanceof Error||typeof r=="object"&&r!==null||It('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new Br(r.message);case"MissingPDFException":return new Nr(r.message);case"PasswordException":return new vp(r.message,r.code);case"UnexpectedResponseException":return new mf(r.message,r.status);case"UnknownErrorException":return new bp(r.message,r.details);default:return new bp(r.message,r.toString())}}var nu,Wv,su,qv,ya,Wh;class Fo{constructor(t,e,i){m(this,nu);m(this,su);m(this,ya);this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=n=>{const s=n.data;if(s.targetName!==this.sourceName)return;if(s.stream){A(this,su,qv).call(this,s);return}if(s.callback){const l=s.callbackId,c=this.callbackCapabilities[l];if(!c)throw new Error(`Cannot resolve callback ${l}`);if(delete this.callbackCapabilities[l],s.callback===Mh.DATA)c.resolve(s.data);else if(s.callback===Mh.ERROR)c.reject($e(s.reason));else throw new Error("Unexpected callback case");return}const a=this.actionHandler[s.action];if(!a)throw new Error(`Unknown action from worker: ${s.action}`);if(s.callbackId){const l=this.sourceName,c=s.sourceName;new Promise(function(d){d(a(s.data))}).then(function(d){i.postMessage({sourceName:l,targetName:c,callback:Mh.DATA,callbackId:s.callbackId,data:d})},function(d){i.postMessage({sourceName:l,targetName:c,callback:Mh.ERROR,callbackId:s.callbackId,reason:$e(d)})});return}if(s.streamId){A(this,nu,Wv).call(this,s);return}a(s.data)},i.addEventListener("message",this._onComObjOnMessage)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const n=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[n]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},i)}catch(a){s.reject(a)}return s.promise}sendWithStream(t,e,i,n){const s=this.streamId++,a=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:d=>{const h=Promise.withResolvers();return this.streamControllers[s]={controller:d,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:l,action:t,streamId:s,data:e,desiredSize:d.desiredSize},n),h.promise},pull:d=>{const h=Promise.withResolvers();return this.streamControllers[s].pullCall=h,c.postMessage({sourceName:a,targetName:l,stream:Kt.PULL,streamId:s,desiredSize:d.desiredSize}),h.promise},cancel:d=>{ie(d instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[s].cancelCall=h,this.streamControllers[s].isClosed=!0,c.postMessage({sourceName:a,targetName:l,stream:Kt.CANCEL,streamId:s,reason:$e(d)}),h.promise}},i)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}nu=new WeakSet,Wv=function(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,a=this,l=this.actionHandler[t.action],c={enqueue(d,h=1,p){if(this.isCancelled)return;const g=this.desiredSize;this.desiredSize-=h,g>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:n,stream:Kt.ENQUEUE,streamId:e,chunk:d},p)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:Kt.CLOSE,streamId:e}),delete a.streamSinks[e])},error(d){ie(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:Kt.ERROR,streamId:e,reason:$e(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[e]=c,new Promise(function(d){d(l(t.data,c))}).then(function(){s.postMessage({sourceName:i,targetName:n,stream:Kt.START_COMPLETE,streamId:e,success:!0})},function(d){s.postMessage({sourceName:i,targetName:n,stream:Kt.START_COMPLETE,streamId:e,reason:$e(d)})})},su=new WeakSet,qv=function(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,a=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case Kt.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject($e(t.reason));break;case Kt.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject($e(t.reason));break;case Kt.PULL:if(!l){s.postMessage({sourceName:i,targetName:n,stream:Kt.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,new Promise(function(c){var d;c((d=l.onPull)==null?void 0:d.call(l))}).then(function(){s.postMessage({sourceName:i,targetName:n,stream:Kt.PULL_COMPLETE,streamId:e,success:!0})},function(c){s.postMessage({sourceName:i,targetName:n,stream:Kt.PULL_COMPLETE,streamId:e,reason:$e(c)})});break;case Kt.ENQUEUE:if(ie(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case Kt.CLOSE:if(ie(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),A(this,ya,Wh).call(this,a,e);break;case Kt.ERROR:ie(a,"error should have stream controller"),a.controller.error($e(t.reason)),A(this,ya,Wh).call(this,a,e);break;case Kt.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject($e(t.reason)),A(this,ya,Wh).call(this,a,e);break;case Kt.CANCEL:if(!l)break;new Promise(function(c){var d;c((d=l.onCancel)==null?void 0:d.call(l,$e(t.reason)))}).then(function(){s.postMessage({sourceName:i,targetName:n,stream:Kt.CANCEL_COMPLETE,streamId:e,success:!0})},function(c){s.postMessage({sourceName:i,targetName:n,stream:Kt.CANCEL_COMPLETE,streamId:e,reason:$e(c)})}),l.sinkCapability.reject($e(t.reason)),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},ya=new WeakSet,Wh=async function(t,e){var i,n,s;await Promise.allSettled([(i=t.startCall)==null?void 0:i.promise,(n=t.pullCall)==null?void 0:n.promise,(s=t.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[e]};var zs,Vl;class WC{constructor({parsedData:t,rawData:e}){m(this,zs,void 0);m(this,Vl,void 0);w(this,zs,t),w(this,Vl,e)}getRaw(){return o(this,Vl)}get(t){return o(this,zs).get(t)??null}getAll(){return Kg(o(this,zs))}has(t){return o(this,zs).has(t)}}zs=new WeakMap,Vl=new WeakMap;const Mn=Symbol("INTERNAL");var Wl,ql,Xl,wa;class qC{constructor(t,{name:e,intent:i,usage:n}){m(this,Wl,!1);m(this,ql,!1);m(this,Xl,!1);m(this,wa,!0);w(this,Wl,!!(t&ii.DISPLAY)),w(this,ql,!!(t&ii.PRINT)),this.name=e,this.intent=i,this.usage=n}get visible(){if(o(this,Xl))return o(this,wa);if(!o(this,wa))return!1;const{print:t,view:e}=this.usage;return o(this,Wl)?(e==null?void 0:e.viewState)!=="OFF":o(this,ql)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,i=!1){t!==Mn&&It("Internal method `_setVisible` called."),w(this,Xl,i),w(this,wa,e)}}Wl=new WeakMap,ql=new WeakMap,Xl=new WeakMap,wa=new WeakMap;var Wn,kt,Aa,Ea,Yl,Xp;class XC{constructor(t,e=ii.DISPLAY){m(this,Yl);m(this,Wn,null);m(this,kt,new Map);m(this,Aa,null);m(this,Ea,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,w(this,Ea,t.order);for(const i of t.groups)o(this,kt).set(i.id,new qC(e,i));if(t.baseState==="OFF")for(const i of o(this,kt).values())i._setVisible(Mn,!1);for(const i of t.on)o(this,kt).get(i)._setVisible(Mn,!0);for(const i of t.off)o(this,kt).get(i)._setVisible(Mn,!1);w(this,Aa,this.getHash())}}isVisible(t){if(o(this,kt).size===0)return!0;if(!t)return gf("Optional content group not defined."),!0;if(t.type==="OCG")return o(this,kt).has(t.id)?o(this,kt).get(t.id).visible:(pt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return A(this,Yl,Xp).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!o(this,kt).has(e))return pt(`Optional content group not found: ${e}`),!0;if(o(this,kt).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!o(this,kt).has(e))return pt(`Optional content group not found: ${e}`),!0;if(!o(this,kt).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!o(this,kt).has(e))return pt(`Optional content group not found: ${e}`),!0;if(!o(this,kt).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!o(this,kt).has(e))return pt(`Optional content group not found: ${e}`),!0;if(o(this,kt).get(e).visible)return!1}return!0}return pt(`Unknown optional content policy ${t.policy}.`),!0}return pt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0){const i=o(this,kt).get(t);if(!i){pt(`Optional content group not found: ${t}`);return}i._setVisible(Mn,!!e,!0),w(this,Wn,null)}setOCGState({state:t,preserveRB:e}){let i;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":i=n;continue}const s=o(this,kt).get(n);if(s)switch(i){case"ON":s._setVisible(Mn,!0);break;case"OFF":s._setVisible(Mn,!1);break;case"Toggle":s._setVisible(Mn,!s.visible);break}}w(this,Wn,null)}get hasInitialVisibility(){return o(this,Aa)===null||this.getHash()===o(this,Aa)}getOrder(){return o(this,kt).size?o(this,Ea)?o(this,Ea).slice():[...o(this,kt).keys()]:null}getGroups(){return o(this,kt).size>0?Kg(o(this,kt)):null}getGroup(t){return o(this,kt).get(t)||null}getHash(){if(o(this,Wn)!==null)return o(this,Wn);const t=new Hv;for(const[e,i]of o(this,kt))t.update(`${e}:${i.visible}`);return w(this,Wn,t.hexdigest())}}Wn=new WeakMap,kt=new WeakMap,Aa=new WeakMap,Ea=new WeakMap,Yl=new WeakSet,Xp=function(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let n=1;n<e;n++){const s=t[n];let a;if(Array.isArray(s))a=A(this,Yl,Xp).call(this,s);else if(o(this,kt).has(s))a=o(this,kt).get(s).visible;else return pt(`Optional content group not found: ${s}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class YC{constructor(t,{disableRange:e=!1,disableStream:i=!1}){ie(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:s,progressiveDone:a,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=l,(s==null?void 0:s.length)>0){const c=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((c,d)=>{this._onReceiveData({begin:c,chunk:d})}),t.addProgressListener((c,d)=>{this._onProgress({loaded:c,total:d})}),t.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const n=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(i),!0)});ie(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,i,n,s;t.total===void 0?(i=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||i.call(e,{loaded:t.loaded}):(s=(n=this._fullRequestReader)==null?void 0:n.onProgress)==null||s.call(n,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){ie(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new KC(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new ZC(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class KC{constructor(t,e,i=!1,n=null){this._stream=t,this._done=i||!1,this._filename=em(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ZC{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function JC(r){let t=!0,e=i("filename\\*","i").exec(r);if(e){e=e[1];let h=l(e);return h=unescape(h),h=c(h),h=d(h),s(h)}if(e=a(r),e){const h=d(e);return s(h)}if(e=i("filename","i").exec(r),e){e=e[1];let h=l(e);return h=d(h),s(h)}function i(h,p){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function n(h,p){if(h){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const g=new TextDecoder(h,{fatal:!0}),v=vf(p);p=g.decode(v),t=!1}catch{}}return p}function s(h){return t&&/[\x80-\xff]/.test(h)&&(h=n("utf-8",h),t&&(h=n("iso-8859-1",h))),h}function a(h){const p=[];let g;const v=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(g=v.exec(h))!==null;){let[,E,C,_]=g;if(E=parseInt(E,10),E in p){if(E===0)break;continue}p[E]=[C,_]}const b=[];for(let E=0;E<p.length&&E in p;++E){let[C,_]=p[E];_=l(_),C&&(_=unescape(_),E===0&&(_=c(_))),b.push(_)}return b.join("")}function l(h){if(h.startsWith('"')){const p=h.slice(1).split('\\"');for(let g=0;g<p.length;++g){const v=p[g].indexOf('"');v!==-1&&(p[g]=p[g].slice(0,v),p.length=g+1),p[g]=p[g].replaceAll(/\\(.)/g,"$1")}h=p.join('"')}return h}function c(h){const p=h.indexOf("'");if(p===-1)return h;const g=h.slice(0,p),b=h.slice(p+1).replace(/^[^']*'/,"");return n(g,b)}function d(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,g,v,b){if(v==="q"||v==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,C){return String.fromCharCode(parseInt(C,16))}),n(g,b);try{b=atob(b)}catch{}return n(g,b)})}return""}function sm({getResponseHeader:r,isHttp:t,rangeChunkSize:e,disableRange:i}){const n={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(r("Content-Length"),10);return!Number.isInteger(s)||(n.suggestedLength=s,s<=2*e)||i||!t||r("Accept-Ranges")!=="bytes"||(r("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function rm(r){const t=r("Content-Disposition");if(t){let e=JC(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(em(e))return e}return null}function _f(r,t){return r===404||r===0&&t.startsWith("file:")?new Nr('Missing PDF "'+t+'".'):new mf(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r)}function Xv(r){return r===200||r===206}function Yv(r,t,e){return{method:"GET",headers:r,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Kv(r){const t=new Headers;for(const e in r){const i=r[e];i!==void 0&&t.append(e,i)}return t}function Zv(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(pt(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class Zm{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return ie(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new QC(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new tT(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class QC{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._headers=Kv(this._stream.httpHeaders);const i=e.url;fetch(i,Yv(this._headers,this._withCredentials,this._abortController)).then(n=>{if(!Xv(n.status))throw _f(n.status,i);this._reader=n.body.getReader(),this._headersCapability.resolve();const s=c=>n.headers.get(c),{allowRangeRequests:a,suggestedLength:l}=sm({getResponseHeader:s,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=rm(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Br("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Zv(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class tT{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController,this._headers=Kv(this._stream.httpHeaders),this._headers.append("Range",`bytes=${e}-${i-1}`);const s=n.url;fetch(s,Yv(this._headers,this._withCredentials,this._abortController)).then(a=>{if(!Xv(a.status))throw _f(a.status,s);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:Zv(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const ip=200,np=206;function eT(r){const t=r.response;return typeof t!="string"?t:vf(t).buffer}class iT{constructor(t,e={}){this.url=t,this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,i){const n={begin:t,end:e};for(const s in i)n[s]=i[s];return this.request(n)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,n=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const s in this.httpHeaders){const a=this.httpHeaders[s];a!==void 0&&e.setRequestHeader(s,a)}return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=np):n.expectedStatus=ip,e.responseType="arraybuffer",t.onError&&(e.onerror=function(s){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){var n;const i=this.pendingRequests[t];i&&((n=i.onProgress)==null||n.call(i,e))}onStateChange(t,e){var c,d,h;const i=this.pendingRequests[t];if(!i)return;const n=i.xhr;if(n.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){(c=i.onError)==null||c.call(i,n.status);return}const s=n.status||ip;if(!(s===ip&&i.expectedStatus===np)&&s!==i.expectedStatus){(d=i.onError)==null||d.call(i,n.status);return}const l=eT(n);if(s===np){const p=n.getResponseHeader("Content-Range"),g=/bytes (\d+)-(\d+)\/(\d+)/.exec(p);i.onDone({begin:parseInt(g[1],10),chunk:l})}else l?i.onDone({begin:0,chunk:l}):(h=i.onError)==null||h.call(i,n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class nT{constructor(t){this._source=t,this._manager=new iT(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return ie(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new sT(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new rT(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class sT{constructor(t,e){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=a=>e.getResponseHeader(a),{allowRangeRequests:n,suggestedLength:s}=sm({getResponseHeader:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=rm(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=_f(t,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class rT{constructor(t,e,i){this._manager=t;const n={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,i,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=_f(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Jv=/^file:\/\/\/[a-zA-Z]:\//;function aT(r){const t=Ui.get("url"),e=t.parse(r);return e.protocol==="file:"||e.host?e:/^[a-z]:[/\\]/i.test(r)?t.parse(`file:///${r}`):(e.host||(e.protocol="file:"),e)}class oT{constructor(t){this.source=t,this.url=aT(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return ie(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new hT(this):new lT(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=this.isFsUrl?new dT(this,t,e):new cT(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Qv{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Br("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class tb{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function yd(r,t){return{protocol:r.protocol,auth:r.auth,host:r.hostname,port:r.port,path:r.path,method:"GET",headers:t}}class lT extends Qv{constructor(t){super(t);const e=i=>{if(i.statusCode===404){const l=new Nr(`Missing PDF "${this._url}".`);this._storedError=l,this._headersCapability.reject(l);return}this._headersCapability.resolve(),this._setReadableStream(i);const n=l=>this._readableStream.headers[l.toLowerCase()],{allowRangeRequests:s,suggestedLength:a}=sm({getResponseHeader:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=a||this._contentLength,this._filename=rm(n)};if(this._request=null,this._url.protocol==="http:"){const i=Ui.get("http");this._request=i.request(yd(this._url,t.httpHeaders),e)}else{const i=Ui.get("https");this._request=i.request(yd(this._url,t.httpHeaders),e)}this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}}class cT extends tb{constructor(t,e,i){super(t),this._httpHeaders={};for(const s in t.httpHeaders){const a=t.httpHeaders[s];a!==void 0&&(this._httpHeaders[s]=a)}this._httpHeaders.Range=`bytes=${e}-${i-1}`;const n=s=>{if(s.statusCode===404){const a=new Nr(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(s)};if(this._request=null,this._url.protocol==="http:"){const s=Ui.get("http");this._request=s.request(yd(this._url,this._httpHeaders),n)}else{const s=Ui.get("https");this._request=s.request(yd(this._url,this._httpHeaders),n)}this._request.on("error",s=>{this._storedError=s}),this._request.end()}}class hT extends Qv{constructor(t){super(t);let e=decodeURIComponent(this._url.path);Jv.test(this._url.href)&&(e=e.replace(/^\//,""));const i=Ui.get("fs");i.promises.lstat(e).then(n=>{this._contentLength=n.size,this._setReadableStream(i.createReadStream(e)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new Nr(`Missing PDF "${e}".`)),this._storedError=n,this._headersCapability.reject(n)})}}class dT extends tb{constructor(t,e,i){super(t);let n=decodeURIComponent(this._url.path);Jv.test(this._url.href)&&(n=n.replace(/^\//,""));const s=Ui.get("fs");this._setReadableStream(s.createReadStream(n,{start:e,end:i-1}))}}const uT=1e5,Le=30,fT=.8;var f0,qn,Ie,Kl,Zl,Gs,cn,Jl,Ql,Vs,_a,xa,Xn,Sa,tc,Ca,Ws,ec,ic,Me,qs,Xs,Ta,ru,eb,au,ib,nc,Yp,Pa,qh,ou,nb;let wd=(Me=class{constructor({textContentSource:t,container:e,viewport:i}){m(this,ru);m(this,au);m(this,nc);m(this,qn,Promise.withResolvers());m(this,Ie,null);m(this,Kl,!1);m(this,Zl,!!((f0=globalThis.FontInspector)!=null&&f0.enabled));m(this,Gs,null);m(this,cn,null);m(this,Jl,0);m(this,Ql,0);m(this,Vs,null);m(this,_a,null);m(this,xa,0);m(this,Xn,0);m(this,Sa,Object.create(null));m(this,tc,[]);m(this,Ca,null);m(this,Ws,[]);m(this,ec,new WeakMap);m(this,ic,null);if(t instanceof ReadableStream)w(this,Ca,t);else if(typeof t=="object")w(this,Ca,new ReadableStream({start(c){c.enqueue(t),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');w(this,Ie,w(this,_a,e)),w(this,Xn,i.scale*(globalThis.devicePixelRatio||1)),w(this,xa,i.rotation),w(this,cn,{prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:null});const{pageWidth:n,pageHeight:s,pageX:a,pageY:l}=i.rawDims;w(this,ic,[1,0,0,-1,-a,l+s]),w(this,Ql,n),w(this,Jl,s),Lr(e,i),o(this,qn).promise.catch(()=>{}).then(()=>{o(Me,Ta).delete(this),w(this,cn,null),w(this,Sa,null)})}render(){const t=()=>{o(this,Vs).read().then(({value:e,done:i})=>{if(i){o(this,qn).resolve();return}o(this,Gs)??w(this,Gs,e.lang),Object.assign(o(this,Sa),e.styles),A(this,ru,eb).call(this,e.items),t()},o(this,qn).reject)};return w(this,Vs,o(this,Ca).getReader()),o(Me,Ta).add(this),t(),o(this,qn).promise}update({viewport:t,onBefore:e=null}){var s;const i=t.scale*(globalThis.devicePixelRatio||1),n=t.rotation;if(n!==o(this,xa)&&(e==null||e(),w(this,xa,n),Lr(o(this,_a),{rotation:n})),i!==o(this,Xn)){e==null||e(),w(this,Xn,i);const a={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:A(s=Me,Pa,qh).call(s,o(this,Gs))};for(const l of o(this,Ws))a.properties=o(this,ec).get(l),a.div=l,A(this,nc,Yp).call(this,a)}}cancel(){var e;const t=new Br("TextLayer task cancelled.");(e=o(this,Vs))==null||e.cancel(t).catch(()=>{}),w(this,Vs,null),o(this,qn).reject(t)}get textDivs(){return o(this,Ws)}get textContentItemsStr(){return o(this,tc)}static cleanup(){if(!(o(this,Ta).size>0)){o(this,qs).clear();for(const{canvas:t}of o(this,Xs).values())t.remove();o(this,Xs).clear()}}},qn=new WeakMap,Ie=new WeakMap,Kl=new WeakMap,Zl=new WeakMap,Gs=new WeakMap,cn=new WeakMap,Jl=new WeakMap,Ql=new WeakMap,Vs=new WeakMap,_a=new WeakMap,xa=new WeakMap,Xn=new WeakMap,Sa=new WeakMap,tc=new WeakMap,Ca=new WeakMap,Ws=new WeakMap,ec=new WeakMap,ic=new WeakMap,qs=new WeakMap,Xs=new WeakMap,Ta=new WeakMap,ru=new WeakSet,eb=function(t){var n,s;if(o(this,Kl))return;(s=o(this,cn)).ctx||(s.ctx=A(n=Me,Pa,qh).call(n,o(this,Gs)));const e=o(this,Ws),i=o(this,tc);for(const a of t){if(e.length>uT){pt("Ignoring additional textDivs for performance reasons."),w(this,Kl,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const l=o(this,Ie);w(this,Ie,document.createElement("span")),o(this,Ie).classList.add("markedContent"),a.id!==null&&o(this,Ie).setAttribute("id",`${a.id}`),l.append(o(this,Ie))}else a.type==="endMarkedContent"&&w(this,Ie,o(this,Ie).parentNode);continue}i.push(a.str),A(this,au,ib).call(this,a)}},au=new WeakSet,ib=function(t){var E;const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};o(this,Ws).push(e);const n=J.transform(o(this,ic),t.transform);let s=Math.atan2(n[1],n[0]);const a=o(this,Sa)[t.fontName];a.vertical&&(s+=Math.PI/2);const l=o(this,Zl)&&a.fontSubstitution||a.fontFamily,c=Math.hypot(n[2],n[3]),d=c*A(E=Me,ou,nb).call(E,l,o(this,Gs));let h,p;s===0?(h=n[4],p=n[5]-d):(h=n[4]+d*Math.sin(s),p=n[5]-d*Math.cos(s));const g="calc(var(--scale-factor)*",v=e.style;o(this,Ie)===o(this,_a)?(v.left=`${(100*h/o(this,Ql)).toFixed(2)}%`,v.top=`${(100*p/o(this,Jl)).toFixed(2)}%`):(v.left=`${g}${h.toFixed(2)}px)`,v.top=`${g}${p.toFixed(2)}px)`),v.fontSize=`${g}${c.toFixed(2)}px)`,v.fontFamily=l,i.fontSize=c,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,o(this,Zl)&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),s!==0&&(i.angle=s*(180/Math.PI));let b=!1;if(t.str.length>1)b=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const C=Math.abs(t.transform[0]),_=Math.abs(t.transform[3]);C!==_&&Math.max(C,_)/Math.min(C,_)>1.5&&(b=!0)}if(b&&(i.canvasWidth=a.vertical?t.height:t.width),o(this,ec).set(e,i),o(this,cn).div=e,o(this,cn).properties=i,A(this,nc,Yp).call(this,o(this,cn)),i.hasText&&o(this,Ie).append(e),i.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),o(this,Ie).append(C)}},nc=new WeakSet,Yp=function(t){const{div:e,properties:i,ctx:n,prevFontSize:s,prevFontFamily:a}=t,{style:l}=e;let c="";if(i.canvasWidth!==0&&i.hasText){const{fontFamily:d}=l,{canvasWidth:h,fontSize:p}=i;(s!==p||a!==d)&&(n.font=`${p*o(this,Xn)}px ${d}`,t.prevFontSize=p,t.prevFontFamily=d);const{width:g}=n.measureText(e.textContent);g>0&&(c=`scaleX(${h*o(this,Xn)/g})`)}i.angle!==0&&(c=`rotate(${i.angle}deg) ${c}`),c.length>0&&(l.transform=c)},Pa=new WeakSet,qh=function(t=null){let e=o(this,Xs).get(t||(t=""));if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1}),o(this,Xs).set(t,e)}return e},ou=new WeakSet,nb=function(t,e){const i=o(this,qs).get(t);if(i)return i;const n=A(this,Pa,qh).call(this,e),s=n.font;n.canvas.width=n.canvas.height=Le,n.font=`${Le}px ${t}`;const a=n.measureText("");let l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);if(l){const p=l/(l+c);return o(this,qs).set(t,p),n.canvas.width=n.canvas.height=0,n.font=s,p}n.strokeStyle="red",n.clearRect(0,0,Le,Le),n.strokeText("g",0,0);let d=n.getImageData(0,0,Le,Le).data;c=0;for(let p=d.length-1-3;p>=0;p-=4)if(d[p]>0){c=Math.ceil(p/4/Le);break}n.clearRect(0,0,Le,Le),n.strokeText("A",0,Le),d=n.getImageData(0,0,Le,Le).data,l=0;for(let p=0,g=d.length;p<g;p+=4)if(d[p]>0){l=Le-Math.floor(p/4/Le);break}n.canvas.width=n.canvas.height=0,n.font=s;const h=l?l/(l+c):fT;return o(this,qs).set(t,h),h},m(Me,Pa),m(Me,ou),m(Me,qs,new Map),m(Me,Xs,new Map),m(Me,Ta,new Set),Me);function pT(){bv("`renderTextLayer`, please use `TextLayer` instead.");const{textContentSource:r,container:t,viewport:e,...i}=arguments[0],n=Object.keys(i);n.length>0&&pt("Ignoring `renderTextLayer` parameters: "+n.join(", "));const s=new wd({textContentSource:r,container:t,viewport:e}),{textDivs:a,textContentItemsStr:l}=s;return{promise:s.render(),textDivs:a,textContentItemsStr:l}}function gT(){bv("`updateTextLayer`, please use `TextLayer` instead.")}class qo{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function n(s){var c;if(!s)return;let a=null;const l=s.name;if(l==="#text")a=s.value;else if(qo.shouldBuildText(l))(c=s==null?void 0:s.attributes)!=null&&c.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&e.push({str:a}),!!s.children)for(const d of s.children)n(d)}return n(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const mT=65536,vT=100,bT=5e3,yT=Ae?LC:vC,wT=Ae?kC:mv,AT=Ae?RC:mC,ET=Ae?IC:vv;function _T(r){if(typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r}),typeof r!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!r.url&&!r.data&&!r.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const t=new Kp,{docId:e}=t,i=r.url?xT(r.url):null,n=r.data?ST(r.data):null,s=r.httpHeaders||null,a=r.withCredentials===!0,l=r.password??null,c=r.range instanceof sb?r.range:null,d=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:mT;let h=r.worker instanceof Qr?r.worker:null;const p=r.verbosity,g=typeof r.docBaseUrl=="string"&&!tm(r.docBaseUrl)?r.docBaseUrl:null,v=typeof r.cMapUrl=="string"?r.cMapUrl:null,b=r.cMapPacked!==!1,E=r.CMapReaderFactory||wT,C=typeof r.standardFontDataUrl=="string"?r.standardFontDataUrl:null,_=r.StandardFontDataFactory||ET,R=r.stopAtErrors!==!0,L=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,D=r.isEvalSupported!==!1,O=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Ae,N=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,j=typeof r.disableFontFace=="boolean"?r.disableFontFace:Ae,S=r.fontExtraProperties===!0,T=r.enableXfa===!0,F=r.ownerDocument||globalThis.document,k=r.disableRange===!0,U=r.disableStream===!0,H=r.disableAutoFetch===!0,G=r.pdfBug===!0,K=c?c.length:r.length??NaN,Z=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Ae&&!j,B=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:E===mv&&_===vv&&v&&C&&Lo(v,document.baseURI)&&Lo(C,document.baseURI),W=r.canvasFactory||new yT({ownerDocument:F}),q=r.filterFactory||new AT({docId:e,ownerDocument:F}),xt=null;rC(p);const vt={canvasFactory:W,filterFactory:q};if(B||(vt.cMapReaderFactory=new E({baseUrl:v,isCompressed:b}),vt.standardFontDataFactory=new _({baseUrl:C})),!h){const et={verbosity:p,port:Pn.workerPort};h=et.port?Qr.fromPort(et):new Qr(et),t._worker=h}const V={docId:e,apiVersion:"4.3.136",data:n,password:l,disableAutoFetch:H,rangeChunkSize:d,length:K,docBaseUrl:g,enableXfa:T,evaluatorOptions:{maxImageSize:L,disableFontFace:j,ignoreErrors:R,isEvalSupported:D,isOffscreenCanvasSupported:O,canvasMaxAreaInBytes:N,fontExtraProperties:S,useSystemFonts:Z,cMapUrl:B?v:null,standardFontDataUrl:B?C:null}},it={disableFontFace:j,fontExtraProperties:S,ownerDocument:F,pdfBug:G,styleElement:xt,loadingParams:{disableAutoFetch:H,enableXfa:T}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const et=h.messageHandler.sendWithPromise("GetDocRequest",V,n?[n.buffer]:null);let nt;return c?nt=new YC(c,{disableRange:k,disableStream:U}):n||(nt=(Q=>Ae?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&Lo(Q.url)?new Zm(Q):new oT(Q):Lo(Q.url)?new Zm(Q):new nT(Q))({url:i,length:K,httpHeaders:s,withCredentials:a,rangeChunkSize:d,disableRange:k,disableStream:U})),et.then(dt=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Q=new Fo(e,dt,h.port),_t=new RT(Q,t,nt,it,vt);t._transport=_t,Q.send("Ready",null)})}).catch(t._capability.reject),t}function xT(r){if(r instanceof URL)return r.href;try{return new URL(r,window.location).href}catch{if(Ae&&typeof r=="string")return r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function ST(r){if(Ae&&typeof md<"u"&&r instanceof md)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return vf(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r==null?void 0:r.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Jm(r){return typeof r=="object"&&Number.isInteger(r==null?void 0:r.num)&&r.num>=0&&Number.isInteger(r==null?void 0:r.gen)&&r.gen>=0}var lu;const cu=class cu{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Be(cu,lu)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(n){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,n}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};lu=new WeakMap,m(cu,lu,0);let Kp=cu,sb=class{constructor(t,e,i=!1,n=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const i of this._rangeListeners)i(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){It("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class CT{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Et(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Yn,hn,Kn,Vr,Ra,Xh;class TT{constructor(t,e,i,n=!1){m(this,Kn);m(this,Ra);m(this,Yn,null);m(this,hn,!1);this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=n?new Bm:null,this._pdfBug=n,this.commonObjs=i.commonObjs,this.objs=new rb,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:n=0,dontFlip:s=!1}={}){return new wh({viewBox:this.view,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Et(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:n=On.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:d=null,printAnnotationStorage:h=null}){var L,D;(L=this._stats)==null||L.time("Overall");const p=this._transport.getRenderingIntent(i,n,h),{renderingIntent:g,cacheKey:v}=p;w(this,hn,!1),A(this,Ra,Xh).call(this),l||(l=this._transport.getOptionalContentConfig(g));let b=this._intentStates.get(v);b||(b=Object.create(null),this._intentStates.set(v,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const E=!!(g&ii.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(D=this._stats)==null||D.time("Page Request"),this._pumpOperatorList(p));const C=O=>{var N;b.renderTasks.delete(_),(this._maybeCleanupAfterRender||E)&&w(this,hn,!0),A(this,Kn,Vr).call(this,!E),O?(_.capability.reject(O),this._abortOperatorList({intentState:b,reason:O instanceof Error?O:new Error(O)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(N=globalThis.Stats)!=null&&N.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new Jp({callback:C,params:{canvasContext:t,viewport:e,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:d});(b.renderTasks||(b.renderTasks=new Set)).add(_);const R=_.task;return Promise.all([b.displayReadyCapability.promise,l]).then(([O,N])=>{var j;if(this.destroyed){C();return}if((j=this._stats)==null||j.time("Rendering"),!(N.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:O,optionalContentConfig:N}),_.operatorListChanged()}).catch(C),R}getOperatorList({intent:t="display",annotationMode:e=On.ENABLE,printAnnotationStorage:i=null}={}){var c;function n(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const s=this._transport.getRenderingIntent(t,e,i,!0);let a=this._intentStates.get(s.cacheKey);a||(a=Object.create(null),this._intentStates.set(s.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=n,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(s)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>qo.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,n){function s(){a.read().then(function({value:c,done:d}){if(d){i(l);return}l.lang??(l.lang=c.lang),Object.assign(l.styles,c.styles),l.items.push(...c.items),s()},n)}const a=e.getReader(),l={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),w(this,hn,!1),A(this,Ra,Xh).call(this),Promise.all(t)}cleanup(t=!1){w(this,hn,!0);const e=A(this,Kn,Vr).call(this,!1);return t&&e&&this._stats&&(this._stats=new Bm),e}_startRenderPage(t,e){var n,s;const i=this._intentStates.get(e);i&&((n=this._stats)==null||n.timeEnd("Page Request"),(s=i.displayReadyCapability)==null||s.resolve(t))}_renderPageChunk(t,e){for(let i=0,n=t.length;i<n;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&A(this,Kn,Vr).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i}){const{map:n,transfer:s}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:n},s).getReader(),c=this._intentStates.get(e);c.streamReader=l;const d=()=>{l.read().then(({value:h,done:p})=>{if(p){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,c),d())},h=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const p of c.renderTasks)p.operatorListChanged();A(this,Kn,Vr).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(h);else if(c.opListReadCapability)c.opListReadCapability.reject(h);else throw h}})};d()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof Qg){let n=vT;e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},n);return}}if(t.streamReader.cancel(new Br(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,s]of this._intentStates)if(s===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}Yn=new WeakMap,hn=new WeakMap,Kn=new WeakSet,Vr=function(t=!1){if(A(this,Ra,Xh).call(this),!o(this,hn)||this.destroyed)return!1;if(t)return w(this,Yn,setTimeout(()=>{w(this,Yn,null),A(this,Kn,Vr).call(this,!1)},bT)),!1;for(const{renderTasks:e,operatorList:i}of this._intentStates.values())if(e.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),w(this,hn,!1),!0},Ra=new WeakSet,Xh=function(){o(this,Yn)&&(clearTimeout(o(this,Yn)),w(this,Yn,null))};var Ys,hu;class PT{constructor(){m(this,Ys,new Set);m(this,hu,Promise.resolve())}postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};o(this,hu).then(()=>{for(const n of o(this,Ys))n.call(this,i)})}addEventListener(t,e){o(this,Ys).add(e)}removeEventListener(t,e){o(this,Ys).delete(e)}terminate(){o(this,Ys).clear()}}Ys=new WeakMap,hu=new WeakMap;const Zi={isWorkerDisabled:!1,fakeWorkerId:0};Ae&&(Zi.isWorkerDisabled=!0,Pn.workerSrc||(Pn.workerSrc="./pdf.worker.mjs")),Zi.isSameOrigin=function(r,t){let e;try{if(e=new URL(r),!e.origin||e.origin==="null")return!1}catch{return!1}const i=new URL(t,e);return e.origin===i.origin},Zi.createCDNWrapper=function(r){const t=`await import("${r}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};var Ks,La,Yh;const je=class je{constructor({name:t=null,port:e=null,verbosity:i=aC()}={}){var n;if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((n=o(je,Ks))!=null&&n.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(o(je,Ks)||w(je,Ks,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return Ae?Promise.all([Ui.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Fo("main","worker",t),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!Zi.isWorkerDisabled&&!o(je,La,Yh)){let{workerSrc:t}=je;try{Zi.isSameOrigin(window.location.href,t)||(t=Zi.createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Fo("main","worker",e),n=()=>{e.removeEventListener("error",s),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=()=>{this._webWorker||n()};e.addEventListener("error",s),i.on("test",l=>{if(e.removeEventListener("error",s),this.destroyed){n();return}l?(this._messageHandler=i,this._port=e,this._webWorker=e,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),e.terminate())}),i.on("ready",l=>{if(e.removeEventListener("error",s),this.destroyed){n();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const l=new Uint8Array;i.send("test",l,[l.buffer])};a();return}catch{gf("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){Zi.isWorkerDisabled||(pt("Setting up fake worker."),Zi.isWorkerDisabled=!0),je._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new PT;this._port=e;const i=`fake${Zi.fakeWorkerId++}`,n=new Fo(i+"_worker",i,e);t.setup(n,e);const s=new Fo(i,i+"_worker",e);this._messageHandler=s,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(t=o(je,Ks))==null||t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){var i;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(i=o(this,Ks))==null?void 0:i.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new je(t)}static get workerSrc(){if(Pn.workerSrc)return Pn.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Et(this,"_setupFakeWorkerGlobal",(async()=>o(this,La,Yh)?o(this,La,Yh):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ks=new WeakMap,La=new WeakSet,Yh=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},m(je,La),m(je,Ks,void 0);let Qr=je;var dn,Ri,ka,Ia,Li,Zs,Mo;class RT{constructor(t,e,i,n,s){m(this,Zs);m(this,dn,new Map);m(this,Ri,new Map);m(this,ka,new Map);m(this,Ia,new Map);m(this,Li,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new rb,this.fontLoader=new TC({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Et(this,"annotationStorage",new nm)}getRenderingIntent(t,e=On.ENABLE,i=null,n=!1){let s=ii.DISPLAY,a=Hp;switch(t){case"any":s=ii.ANY;break;case"display":break;case"print":s=ii.PRINT;break;default:pt(`getRenderingIntent - invalid intent: ${t}`)}switch(e){case On.DISABLE:s+=ii.ANNOTATIONS_DISABLE;break;case On.ENABLE:break;case On.ENABLE_FORMS:s+=ii.ANNOTATIONS_FORMS;break;case On.ENABLE_STORAGE:s+=ii.ANNOTATIONS_STORAGE,a=(s&ii.PRINT&&i instanceof Gv?i:this.annotationStorage).serializable;break;default:pt(`getRenderingIntent - invalid annotationMode: ${e}`)}return n&&(s+=ii.OPLIST),{renderingIntent:s,cacheKey:`${s}_${a.hash}`,annotationStorageSerializable:a}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=o(this,Li))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of o(this,Ri).values())t.push(n._destroy());o(this,Ri).clear(),o(this,ka).clear(),o(this,Ia).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var n;this.commonObjs.clear(),this.fontLoader.clear(),o(this,dn).clear(),this.filterFactory.destroy(),wd.cleanup(),(n=this._networkStream)==null||n.cancelAllRequests(new Br("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,n)=>{ie(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},n.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){n.close();return}ie(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{n.error(s)})},n.onCancel=s=>{this._fullReader.cancel(s),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",i=>{const n=Promise.withResolvers(),s=this._fullReader;return s.headersReady.then(()=>{var a;(!s.isStreamingSupported||!s.isRangeSupported)&&(this._lastProgress&&((a=e.onProgress)==null||a.call(e,this._lastProgress)),s.onProgress=l=>{var c;(c=e.onProgress)==null||c.call(e,{loaded:l.loaded,total:l.total})}),n.resolve({isStreamingSupported:s.isStreamingSupported,isRangeSupported:s.isRangeSupported,contentLength:s.contentLength})},n.reject),n.promise}),t.on("GetRangeReader",(i,n)=>{ie(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(i.begin,i.end);if(!s){n.close();return}n.onPull=()=>{s.read().then(function({value:a,done:l}){if(l){n.close();return}ie(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{s.cancel(a),n.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new CT(i,this))}),t.on("DocException",function(i){let n;switch(i.name){case"PasswordException":n=new vp(i.message,i.code);break;case"InvalidPDFException":n=new uv(i.message);break;case"MissingPDFException":n=new Nr(i.message);break;case"UnexpectedResponseException":n=new mf(i.message,i.status);break;case"UnknownErrorException":n=new bp(i.message,i.details);break;default:It("DocException - expected a valid Error.")}e._capability.reject(n)}),t.on("PasswordRequest",i=>{if(w(this,Li,Promise.withResolvers()),e.onPassword){const n=s=>{s instanceof Error?o(this,Li).reject(s):o(this,Li).resolve({password:s})};try{e.onPassword(n,i.code)}catch(s){o(this,Li).reject(s)}}else o(this,Li).reject(new vp(i.message,i.code));return o(this,Li).promise}),t.on("DataLoaded",i=>{var n;(n=e.onProgress)==null||n.call(e,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;o(this,Ri).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,n,s])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(n){case"Font":const{disableFontFace:l,fontExtraProperties:c,pdfBug:d}=this._params;if("error"in s){const v=s.error;pt(`Error during font loading: ${v}`),this.commonObjs.resolve(i,v);break}const h=d&&((a=globalThis.FontInspector)!=null&&a.enabled)?(v,b)=>globalThis.FontInspector.fontAdded(v,b):null,p=new PC(s,{disableFontFace:l,inspectFont:h});this.fontLoader.bind(p).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!c&&p.data&&(p.data=null),this.commonObjs.resolve(i,p)});break;case"CopyLocalImage":const{imageRef:g}=s;ie(g,"The imageRef must be defined.");for(const v of o(this,Ri).values())for(const[,b]of v.objs)if((b==null?void 0:b.ref)===g)return b.dataLen?(this.commonObjs.resolve(i,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,s);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([i,n,s,a])=>{var c;if(this.destroyed)return;const l=o(this,Ri).get(n);if(!l.objs.has(i)){if(l._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(s){case"Image":l.objs.resolve(i,a),(a==null?void 0:a.dataLen)>eC&&(l._maybeCleanupAfterRender=!0);break;case"Pattern":l.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",i=>{var n;this.destroyed||(n=e.onProgress)==null||n.call(e,{loaded:i.loaded,total:i.total})}),t.on("FetchBuiltInCMap",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(i):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(i):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&pt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((i=this._fullReader)==null?void 0:i.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=o(this,ka).get(e);if(i)return i;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&o(this,Ia).set(s.refStr,t);const a=new TT(e,s,this,this._params.pdfBug);return o(this,Ri).set(e,a),a});return o(this,ka).set(e,n),n}getPageIndex(t){return Jm(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return A(this,Zs,Mo).call(this,"GetFieldObjects")}hasJSActions(){return A(this,Zs,Mo).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return A(this,Zs,Mo).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return A(this,Zs,Mo).call(this,"GetOptionalContentConfig").then(e=>new XC(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=o(this,dn).get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(n=>{var s,a;return{info:n[0],metadata:n[1]?new WC(n[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return o(this,dn).set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of o(this,Ri).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),o(this,dn).clear(),this.filterFactory.destroy(!0),wd.cleanup()}}cachedPageNumber(t){if(!Jm(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return o(this,Ia).get(e)??null}}dn=new WeakMap,Ri=new WeakMap,ka=new WeakMap,Ia=new WeakMap,Li=new WeakMap,Zs=new WeakSet,Mo=function(t,e=null){const i=o(this,dn).get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,e);return o(this,dn).set(t,n),n};const Dh=Symbol("INITIAL_DATA");var ci,sc,Zp;class rb{constructor(){m(this,sc);m(this,ci,Object.create(null))}get(t,e=null){if(e){const n=A(this,sc,Zp).call(this,t);return n.promise.then(()=>e(n.data)),null}const i=o(this,ci)[t];if(!i||i.data===Dh)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=o(this,ci)[t];return!!e&&e.data!==Dh}resolve(t,e=null){const i=A(this,sc,Zp).call(this,t);i.data=e,i.resolve()}clear(){var t;for(const e in o(this,ci)){const{data:i}=o(this,ci)[e];(t=i==null?void 0:i.bitmap)==null||t.close()}w(this,ci,Object.create(null))}*[Symbol.iterator](){for(const t in o(this,ci)){const{data:e}=o(this,ci)[t];e!==Dh&&(yield[t,e])}}}ci=new WeakMap,sc=new WeakSet,Zp=function(t){var e;return(e=o(this,ci))[t]||(e[t]={...Promise.withResolvers(),data:Dh})};var Zn;class LT{constructor(t){m(this,Zn,null);w(this,Zn,t),this.onContinue=null}get promise(){return o(this,Zn).capability.promise}cancel(t=0){o(this,Zn).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=o(this,Zn).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=o(this,Zn);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}Zn=new WeakMap;var Js;const As=class As{constructor({callback:t,params:e,objs:i,commonObjs:n,annotationCanvasMap:s,operatorList:a,pageIndex:l,canvasFactory:c,filterFactory:d,useRequestAnimationFrame:h=!1,pdfBug:p=!1,pageColors:g=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=n,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=d,this._pdfBug=p,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new LT(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var l,c;if(this.cancelled)return;if(this._canvas){if(o(As,Js).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");o(As,Js).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:n,transform:s,background:a}=this.params;this.gfx=new Jr(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:n,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(t=null,e=0){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),o(As,Js).delete(this._canvas),this.callback(t||new Qg(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),o(As,Js).delete(this._canvas),this.callback())))}};Js=new WeakMap,m(As,Js,new WeakSet);let Jp=As;const kT="4.3.136",IT="0cec64437";function Qm(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function Co(r){return Math.max(0,Math.min(255,255*r))}class t0{static CMYK_G([t,e,i,n]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Co(t),[t,t,t]}static G_HTML([t]){const e=Qm(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Co)}static RGB_HTML(t){return`#${t.map(Qm).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,i+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,i,n]){return[Co(1-Math.min(1,t+n)),Co(1-Math.min(1,i+n)),Co(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const n=1-t,s=1-e,a=1-i,l=Math.min(n,s,a);return["CMYK",n,s,a,l]}}class ab{static setupStorage(t,e,i,n,s){const a=n.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),s==="print")break;t.addEventListener("input",l=>{n.setValue(e,{value:l.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",l=>{n.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),s==="print")break;t.addEventListener("input",l=>{n.setValue(e,{value:l.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const l of i.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const c=l.target.options,d=c.selectedIndex===-1?"":c[c.selectedIndex].value;n.setValue(e,{value:d})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:n,linkService:s}){const{attributes:a}=e,l=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[c,d]of Object.entries(a))if(d!=null)switch(c){case"class":d.length&&t.setAttribute(c,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!l||c!=="href"&&c!=="newWindow")&&t.setAttribute(c,d)}l&&s.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){var p,g;const e=t.annotationStorage,i=t.linkService,n=t.xfaHtml,s=t.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:s,linkService:i});const l=s!=="richText",c=t.div;if(c.append(a),t.viewport){const v=`matrix(${t.viewport.transform.join(",")})`;c.style.transform=v}l&&c.setAttribute("class","xfaLayer xfaFont");const d=[];if(n.children.length===0){if(n.value){const v=document.createTextNode(n.value);a.append(v),l&&qo.shouldBuildText(n.name)&&d.push(v)}return{textDivs:d}}const h=[[n,-1,a]];for(;h.length>0;){const[v,b,E]=h.at(-1);if(b+1===v.children.length){h.pop();continue}const C=v.children[++h.at(-1)[1]];if(C===null)continue;const{name:_}=C;if(_==="#text"){const L=document.createTextNode(C.value);d.push(L),E.append(L);continue}const R=(p=C==null?void 0:C.attributes)!=null&&p.xmlns?document.createElementNS(C.attributes.xmlns,_):document.createElement(_);if(E.append(R),C.attributes&&this.setAttributes({html:R,element:C,storage:e,intent:s,linkService:i}),((g=C.children)==null?void 0:g.length)>0)h.push([C,-1,R]);else if(C.value){const L=document.createTextNode(C.value);l&&qo.shouldBuildText(_)&&d.push(L),R.append(L)}}for(const v of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))v.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const _h=1e3,FT=9,Ir=new WeakSet;function Rn(r){return{width:r[2]-r[0],height:r[3]-r[1]}}class MT{static create(t){switch(t.data.annotationType){case Zt.LINK:return new ob(t);case Zt.TEXT:return new DT(t);case Zt.WIDGET:switch(t.data.fieldType){case"Tx":return new OT(t);case"Btn":return t.data.radioButton?new hb(t):t.data.checkBox?new BT(t):new $T(t);case"Ch":return new jT(t);case"Sig":return new NT(t)}return new $r(t);case Zt.POPUP:return new tg(t);case Zt.FREETEXT:return new gb(t);case Zt.LINE:return new HT(t);case Zt.SQUARE:return new zT(t);case Zt.CIRCLE:return new GT(t);case Zt.POLYLINE:return new mb(t);case Zt.CARET:return new WT(t);case Zt.INK:return new vb(t);case Zt.POLYGON:return new VT(t);case Zt.HIGHLIGHT:return new qT(t);case Zt.UNDERLINE:return new XT(t);case Zt.SQUIGGLY:return new YT(t);case Zt.STRIKEOUT:return new KT(t);case Zt.STAMP:return new bb(t);case Zt.FILEATTACHMENT:return new ZT(t);default:return new Xt(t)}}}var Qs,Fa,Ma,rc,Qp;const cm=class cm{constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:n=!1}={}){m(this,rc);m(this,Qs,null);m(this,Fa,!1);m(this,Ma,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t!=null&&t.str||e!=null&&e.str||i!=null&&i.str)}get hasPopupData(){return cm._hasPopupData(this.data)}updateEdited(t){var i;if(!this.container)return;o(this,Qs)||w(this,Qs,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&A(this,rc,Qp).call(this,e),(i=o(this,Ma))==null||i.popup.updateEdited(t)}resetEdited(){var t;o(this,Qs)&&(A(this,rc,Qp).call(this,o(this,Qs).rect),(t=o(this,Ma))==null||t.popup.resetEdited(),w(this,Qs,null))}_createContainer(t){const{data:e,parent:{page:i,viewport:n}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof $r||(s.tabIndex=_h);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,e.popupRef&&s.setAttribute("aria-haspopup","dialog"),e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof tg){const{rotation:E}=e;return!e.hasOwnCanvas&&E!==0&&this.setRotation(E,s),s}const{width:l,height:c}=Rn(e.rect);if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const E=e.borderStyle.horizontalCornerRadius,C=e.borderStyle.verticalCornerRadius;if(E>0||C>0){const R=`calc(${E}px * var(--scale-factor)) / calc(${C}px * var(--scale-factor))`;a.borderRadius=R}else if(this instanceof hb){const R=`calc(${l}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;a.borderRadius=R}switch(e.borderStyle.style){case xo.SOLID:a.borderStyle="solid";break;case xo.DASHED:a.borderStyle="dashed";break;case xo.BEVELED:pt("Unimplemented border style: beveled");break;case xo.INSET:pt("Unimplemented border style: inset");break;case xo.UNDERLINE:a.borderBottomStyle="solid";break}const _=e.borderColor||null;_?(w(this,Fa,!0),a.borderColor=J.makeHexColor(_[0]|0,_[1]|0,_[2]|0)):a.borderWidth=0}const d=J.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:p,pageX:g,pageY:v}=n.rawDims;a.left=`${100*(d[0]-g)/h}%`,a.top=`${100*(d[1]-v)/p}%`;const{rotation:b}=e;return e.hasOwnCanvas||b===0?(a.width=`${100*l/h}%`,a.height=`${100*c/p}%`):this.setRotation(b,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:n}=this.parent.viewport.rawDims,{width:s,height:a}=Rn(this.data.rect);let l,c;t%180===0?(l=100*s/i,c=100*a/n):(l=100*a/i,c=100*s/n),e.style.width=`${l}%`,e.style.height=`${c}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,n)=>{const s=n.detail[e],a=s[0],l=s.slice(1);n.target.style[i]=t0[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[i]:t0[`${a}_rgb`](l)})};return Et(this,"_commonActions",{display:e=>{const{display:i}=e.detail,n=i%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const n of Object.keys(e.detail)){const s=t[n]||i[n];s==null||s(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[n,s]of Object.entries(e)){const a=i[n];if(a){const l={detail:{[n]:s},target:t};a(l),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,n,s]=this.data.rect;if(t.length===1){const[,{x:E,y:C},{x:_,y:R}]=t[0];if(n===E&&s===C&&e===_&&i===R)return}const{style:a}=this.container;let l;if(o(this,Fa)){const{borderColor:E,borderWidth:C}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${E}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const c=n-e,d=s-i,{svgFactory:h}=this,p=h.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0);const g=h.createElement("defs");p.append(g);const v=h.createElement("clipPath"),b=`clippath_${this.data.id}`;v.setAttribute("id",b),v.setAttribute("clipPathUnits","objectBoundingBox"),g.append(v);for(const[,{x:E,y:C},{x:_,y:R}]of t){const L=h.createElement("rect"),D=(_-e)/c,O=(s-C)/d,N=(E-_)/c,j=(C-R)/d;L.setAttribute("x",D),L.setAttribute("y",O),L.setAttribute("width",N),L.setAttribute("height",j),v.append(L),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${O}" width="${N}" height="${j}"/>`)}o(this,Fa)&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(p),this.container.style.clipPath=`url(#${b})`}_createPopup(){const{container:t,data:e}=this;t.setAttribute("aria-haspopup","dialog");const i=w(this,Ma,new tg({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(i.render())}render(){It("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:s,id:a,exportValues:l}of n){if(s===-1||a===e)continue;const c=typeof l=="string"?l:null,d=document.querySelector(`[data-element-id="${a}"]`);if(d&&!Ir.has(d)){pt(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:c,domElement:d})}return i}for(const n of document.getElementsByName(t)){const{exportValue:s}=n,a=n.getAttribute("data-element-id");a!==e&&Ir.has(n)&&i.push({id:a,exportValue:s,domElement:n})}return i}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};Qs=new WeakMap,Fa=new WeakMap,Ma=new WeakMap,rc=new WeakSet,Qp=function(t){const{container:{style:e},data:{rect:i,rotation:n},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:l,pageY:c}}}}=this;i==null||i.splice(0,4,...t);const{width:d,height:h}=Rn(t);e.left=`${100*(t[0]-l)/s}%`,e.top=`${100*(a-t[3]+c)/a}%`,n===0?(e.width=`${100*d/s}%`,e.height=`${100*h/a}%`):this.setRotation(n)};let Xt=cm;var un,vs,du,lb,uu,cb;class ob extends Xt{constructor(e,i=null){super(e,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});m(this,un);m(this,du);m(this,uu);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:i}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(i.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action),s=!0):e.attachment?(A(this,du,lb).call(this,n,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(A(this,uu,cb).call(this,n,e.setOCGState),s=!0):e.dest?(this._bindLink(n,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(n),this.container}_bindLink(e,i){e.href=this.linkService.getDestinationHash(i),e.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&A(this,un,vs).call(this)}_bindNamedAction(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(i),!1),A(this,un,vs).call(this)}_bindJSAction(e,i){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(i.actions)){const a=n.get(s);a&&(e[a]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:s}}),!1})}e.onclick||(e.onclick=()=>!1),A(this,un,vs).call(this)}_bindResetFormAction(e,i){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),A(this,un,vs).call(this),!this._fieldObjects){pt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{var p;n==null||n();const{fields:s,refs:a,include:l}=i,c=[];if(s.length!==0||a.length!==0){const g=new Set(a);for(const v of s){const b=this._fieldObjects[v]||[];for(const{id:E}of b)g.add(E)}for(const v of Object.values(this._fieldObjects))for(const b of v)g.has(b.id)===l&&c.push(b)}else for(const g of Object.values(this._fieldObjects))c.push(...g);const d=this.annotationStorage,h=[];for(const g of c){const{id:v}=g;switch(h.push(v),g.type){case"text":{const E=g.defaultValue||"";d.setValue(v,{value:E});break}case"checkbox":case"radiobutton":{const E=g.defaultValue===g.exportValues;d.setValue(v,{value:E});break}case"combobox":case"listbox":{const E=g.defaultValue||"";d.setValue(v,{value:E});break}default:continue}const b=document.querySelector(`[data-element-id="${v}"]`);if(b){if(!Ir.has(b)){pt(`_bindResetFormAction - element not allowed: ${v}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}un=new WeakSet,vs=function(){this.container.setAttribute("data-internal-link","")},du=new WeakSet,lb=function(e,i,n=null){e.href=this.linkService.getAnchorUrl(""),i.description&&(e.title=i.description),e.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(i.content,i.filename,n),!1},A(this,un,vs).call(this)},uu=new WeakSet,cb=function(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(i),!1),A(this,un,vs).call(this)};class DT extends Xt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class $r extends Xt{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Oe.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,n,s){i.includes("mouse")?t.addEventListener(i,a=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{var l;if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}s&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(a)}}))})}_setEventListeners(t,e,i,n){var s,a,l;for(const[c,d]of i)(d==="Action"||(s=this.data.actions)!=null&&s[d])&&((d==="Focus"||d==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,c,d,n),d==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(t,e,"blur","Blur",null):d==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":J.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||FT,s=t.style;let a;const l=2,c=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l),h=Math.round(d/(Jf*n))||1,p=d/h;a=Math.min(n,c(p/Jf))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(n,c(d/Jf))}s.fontSize=`calc(${a}px * var(--scale-factor))`,s.color=J.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class OT extends $r{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,n){const s=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),s.setValue(a.id,{[n]:i})}render(){var n,s;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let l=a.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let d=a.formattedValue||((n=this.data.textContent)==null?void 0:n.join(`
`))||null;d&&this.data.comb&&(d=d.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:d,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=d??l,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",d??l),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Ir.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=_h,this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",g=>{t.setValue(e,{value:g.target.value}),this.setPropertyOnSiblings(i,"value",g.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",g=>{const v=this.data.defaultFieldValue??"";i.value=h.userValue=v,h.formattedValue=null});let p=g=>{const{formattedValue:v}=h;v!=null&&(g.target.value=v),g.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",v=>{var E;if(h.focused)return;const{target:b}=v;h.userValue&&(b.value=h.userValue),h.lastCommittedValue=b.value,h.commitKey=1,(E=this.data.actions)!=null&&E.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",v=>{this.showElementAndHideCanvas(v.target);const b={value(E){h.userValue=E.detail.value??"",t.setValue(e,{value:h.userValue.toString()}),E.target.value=h.userValue},formattedValue(E){const{formattedValue:C}=E.detail;h.formattedValue=C,C!=null&&E.target!==document.activeElement&&(E.target.value=C),t.setValue(e,{formattedValue:C})},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{var L;const{charLimit:C}=E.detail,{target:_}=E;if(C===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",C);let R=h.userValue;!R||R.length<=C||(R=R.slice(0,C),_.value=h.userValue=R,t.setValue(e,{value:R}),(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(b,v)}),i.addEventListener("keydown",v=>{var C;h.commitKey=1;let b=-1;if(v.key==="Escape"?b=0:v.key==="Enter"&&!this.data.multiLine?b=2:v.key==="Tab"&&(h.commitKey=3),b===-1)return;const{value:E}=v.target;h.lastCommittedValue!==E&&(h.lastCommittedValue=E,h.userValue=E,(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:b,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}))});const g=p;p=null,i.addEventListener("blur",v=>{var E,C;if(!h.focused||!v.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(h.focused=!1);const{value:b}=v.target;h.userValue=b,h.lastCommittedValue!==b&&((C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,willCommit:!0,commitKey:h.commitKey,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}})),g(v)}),(s=this.data.actions)!=null&&s.Keystroke&&i.addEventListener("beforeinput",v=>{var O;h.lastCommittedValue=null;const{data:b,target:E}=v,{value:C,selectionStart:_,selectionEnd:R}=E;let L=_,D=R;switch(v.inputType){case"deleteWordBackward":{const N=C.substring(0,_).match(/\w*[^\w]*$/);N&&(L-=N[0].length);break}case"deleteWordForward":{const N=C.substring(_).match(/^[^\w]*\w*/);N&&(D+=N[0].length);break}case"deleteContentBackward":_===R&&(L-=1);break;case"deleteContentForward":_===R&&(D+=1);break}v.preventDefault(),(O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,change:b||"",willCommit:!1,selStart:L,selEnd:D}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],v=>v.target.value)}if(p&&i.addEventListener("blur",p),this.data.comb){const v=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${v}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class NT extends $r{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class BT extends $r{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(i,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Ir.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=_h,s.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const d of this._getElementsByName(l,i)){const h=c&&d.exportValue===e.exportValue;d.domElement&&(d.domElement.checked=h),t.setValue(d.id,{value:h})}t.setValue(i,{value:c})}),s.addEventListener("resetform",a=>{const l=e.defaultFieldValue||"Off";a.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const l={value(c){c.target.checked=c.detail.value!=="Off",t.setValue(i,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class hb extends $r{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof n=="string"&&(n=n!==e.buttonValue,t.setValue(i,{value:n})),n)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const s=document.createElement("input");if(Ir.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.tabIndex=_h,s.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const d of this._getElementsByName(l,i))t.setValue(d.id,{value:!1});t.setValue(i,{value:c})}),s.addEventListener("resetform",a=>{const l=e.defaultFieldValue;a.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;s.addEventListener("updatefromsandbox",l=>{const c={value:d=>{const h=a===d.detail.value;for(const p of this._getElementsByName(d.target.name)){const g=h&&p.id===i;p.domElement&&(p.domElement.checked=g),t.setValue(p.id,{value:g})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class $T extends ob{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class jT extends $r{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");Ir.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=_h;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",h=>{const p=this.data.defaultFieldValue;for(const g of n.options)g.selected=g.value===p});for(const h of this.data.options){const p=document.createElement("option");p.textContent=h.displayValue,p.value=h.exportValue,i.value.includes(h.exportValue)&&(p.setAttribute("selected",!0),s=!1),n.append(p)}let a=null;if(s){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),n.prepend(h),a=()=>{h.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const l=h=>{const p=h?"value":"textContent",{options:g,multiple:v}=n;return v?Array.prototype.filter.call(g,b=>b.selected).map(b=>b[p]):g.selectedIndex===-1?null:g[g.selectedIndex][p]};let c=l(!1);const d=h=>{const p=h.target.options;return Array.prototype.map.call(p,g=>({displayValue:g.textContent,exportValue:g.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",h=>{const p={value(g){a==null||a();const v=g.detail.value,b=new Set(Array.isArray(v)?v:[v]);for(const E of n.options)E.selected=b.has(E.value);t.setValue(e,{value:l(!0)}),c=l(!1)},multipleSelection(g){n.multiple=!0},remove(g){const v=n.options,b=g.detail.remove;v[b].selected=!1,n.remove(b),v.length>0&&Array.prototype.findIndex.call(v,C=>C.selected)===-1&&(v[0].selected=!0),t.setValue(e,{value:l(!0),items:d(g)}),c=l(!1)},clear(g){for(;n.length!==0;)n.remove(0);t.setValue(e,{value:null,items:[]}),c=l(!1)},insert(g){const{index:v,displayValue:b,exportValue:E}=g.detail.insert,C=n.children[v],_=document.createElement("option");_.textContent=b,_.value=E,C?C.before(_):n.append(_),t.setValue(e,{value:l(!0),items:d(g)}),c=l(!1)},items(g){const{items:v}=g.detail;for(;n.length!==0;)n.remove(0);for(const b of v){const{displayValue:E,exportValue:C}=b,_=document.createElement("option");_.textContent=E,_.value=C,n.append(_)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:l(!0),items:d(g)}),c=l(!1)},indices(g){const v=new Set(g.detail.indices);for(const b of g.target.options)b.selected=v.has(b.index);t.setValue(e,{value:l(!0)}),c=l(!1)},editable(g){g.target.disabled=!g.detail.editable}};this._dispatchEventFromSandbox(p,h)}),n.addEventListener("input",h=>{var v;const p=l(!0),g=l(!1);t.setValue(e,{value:p}),h.preventDefault(),(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:c,change:g,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):n.addEventListener("input",function(h){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class tg extends Xt{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:Xt._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new UT({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${pv}${i}`).join(",")),this.container}}var Da,fu,pu,Oa,tr,Vt,fn,er,ac,oc,Na,pn,hi,gn,lc,mn,cc,ir,nr,Ba,Kh,hc,eg,gu,db,mu,ub,vu,fb,bu,pb,$a,Zh,ja,Jh,dc,ig;class UT{constructor({container:t,color:e,elements:i,titleObj:n,modificationDate:s,contentsObj:a,richText:l,parent:c,rect:d,parentRect:h,open:p}){m(this,Ba);m(this,hc);m(this,gu);m(this,mu);m(this,vu);m(this,bu);m(this,$a);m(this,ja);m(this,dc);m(this,Da,A(this,vu,fb).bind(this));m(this,fu,A(this,dc,ig).bind(this));m(this,pu,A(this,ja,Jh).bind(this));m(this,Oa,A(this,$a,Zh).bind(this));m(this,tr,null);m(this,Vt,null);m(this,fn,null);m(this,er,null);m(this,ac,null);m(this,oc,null);m(this,Na,null);m(this,pn,!1);m(this,hi,null);m(this,gn,null);m(this,lc,null);m(this,mn,null);m(this,cc,null);m(this,ir,null);m(this,nr,!1);var g;w(this,Vt,t),w(this,cc,n),w(this,fn,a),w(this,mn,l),w(this,oc,c),w(this,tr,e),w(this,lc,d),w(this,Na,h),w(this,ac,i),w(this,er,yv.toDateObject(s)),this.trigger=i.flatMap(v=>v.getElementsToTriggerPopup());for(const v of this.trigger)v.addEventListener("click",o(this,Oa)),v.addEventListener("mouseenter",o(this,pu)),v.addEventListener("mouseleave",o(this,fu)),v.classList.add("popupTriggerArea");for(const v of i)(g=v.container)==null||g.addEventListener("keydown",o(this,Da));o(this,Vt).hidden=!0,p&&A(this,$a,Zh).call(this)}render(){if(o(this,hi))return;const t=w(this,hi,document.createElement("div"));if(t.className="popup",o(this,tr)){const s=t.style.outlineColor=J.makeHexColor(...o(this,tr));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:t.style.backgroundColor=J.makeHexColor(...o(this,tr).map(l=>Math.floor(.7*(255-l)+l)))}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),{dir:i.dir,str:i.textContent}=o(this,cc),t.append(e),o(this,er)){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),s.setAttribute("data-l10n-args",JSON.stringify({date:o(this,er).toLocaleDateString(),time:o(this,er).toLocaleTimeString()})),e.append(s)}const n=o(this,Ba,Kh);if(n)ab.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(o(this,fn));t.append(s)}o(this,Vt).append(t)}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const n=t.split(/(?:\r\n?|\n)/);for(let s=0,a=n.length;s<a;++s){const l=n[s];i.append(document.createTextNode(l)),s<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:t,popupContent:e}){var i;o(this,ir)||w(this,ir,{contentsObj:o(this,fn),richText:o(this,mn)}),t&&w(this,gn,null),e&&(w(this,mn,A(this,mu,ub).call(this,e)),w(this,fn,null)),(i=o(this,hi))==null||i.remove(),w(this,hi,null)}resetEdited(){var t;o(this,ir)&&({contentsObj:Be(this,fn)._,richText:Be(this,mn)._}=o(this,ir),w(this,ir,null),(t=o(this,hi))==null||t.remove(),w(this,hi,null),w(this,gn,null))}forceHide(){w(this,nr,this.isVisible),o(this,nr)&&(o(this,Vt).hidden=!0)}maybeShow(){o(this,nr)&&(o(this,hi)||A(this,ja,Jh).call(this),w(this,nr,!1),o(this,Vt).hidden=!1)}get isVisible(){return o(this,Vt).hidden===!1}}Da=new WeakMap,fu=new WeakMap,pu=new WeakMap,Oa=new WeakMap,tr=new WeakMap,Vt=new WeakMap,fn=new WeakMap,er=new WeakMap,ac=new WeakMap,oc=new WeakMap,Na=new WeakMap,pn=new WeakMap,hi=new WeakMap,gn=new WeakMap,lc=new WeakMap,mn=new WeakMap,cc=new WeakMap,ir=new WeakMap,nr=new WeakMap,Ba=new WeakSet,Kh=function(){const t=o(this,mn),e=o(this,fn);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&o(this,mn).html||null},hc=new WeakSet,eg=function(){var t,e,i;return((i=(e=(t=o(this,Ba,Kh))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.fontSize)||0},gu=new WeakSet,db=function(){var t,e,i;return((i=(e=(t=o(this,Ba,Kh))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.color)||null},mu=new WeakSet,ub=function(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:o(this,gu,db),fontSize:o(this,hc,eg)?`calc(${o(this,hc,eg)}px * var(--scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:n});return i},vu=new WeakSet,fb=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&o(this,pn))&&A(this,$a,Zh).call(this)},bu=new WeakSet,pb=function(){if(o(this,gn)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:n,pageY:s}}}=o(this,oc);let a=!!o(this,Na),l=a?o(this,Na):o(this,lc);for(const b of o(this,ac))if(!l||J.intersect(b.data.rect,l)!==null){l=b.data.rect,a=!0;break}const c=J.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),h=a?l[2]-l[0]+5:0,p=c[0]+h,g=c[1];w(this,gn,[100*(p-n)/e,100*(g-s)/i]);const{style:v}=o(this,Vt);v.left=`${o(this,gn)[0]}%`,v.top=`${o(this,gn)[1]}%`},$a=new WeakSet,Zh=function(){w(this,pn,!o(this,pn)),o(this,pn)?(A(this,ja,Jh).call(this),o(this,Vt).addEventListener("click",o(this,Oa)),o(this,Vt).addEventListener("keydown",o(this,Da))):(A(this,dc,ig).call(this),o(this,Vt).removeEventListener("click",o(this,Oa)),o(this,Vt).removeEventListener("keydown",o(this,Da)))},ja=new WeakSet,Jh=function(){o(this,hi)||this.render(),this.isVisible?o(this,pn)&&o(this,Vt).classList.add("focused"):(A(this,bu,pb).call(this),o(this,Vt).hidden=!1,o(this,Vt).style.zIndex=parseInt(o(this,Vt).style.zIndex)+1e3)},dc=new WeakSet,ig=function(){o(this,Vt).classList.remove("focused"),!(o(this,pn)||!this.isVisible)&&(o(this,Vt).hidden=!0,o(this,Vt).style.zIndex=parseInt(o(this,Vt).style.zIndex)-1e3)};class gb extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=yt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}var uc;class HT extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});m(this,uc,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:i,height:n}=Rn(e.rect),s=this.svgFactory.create(i,n,!0),a=w(this,uc,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,uc)}addHighlightArea(){this.container.classList.add("highlightArea")}}uc=new WeakMap;var fc;class zT extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});m(this,fc,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:i,height:n}=Rn(e.rect),s=this.svgFactory.create(i,n,!0),a=e.borderStyle.width,l=w(this,fc,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",i-a),l.setAttribute("height",n-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,fc)}addHighlightArea(){this.container.classList.add("highlightArea")}}fc=new WeakMap;var pc;class GT extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});m(this,pc,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:i,height:n}=Rn(e.rect),s=this.svgFactory.create(i,n,!0),a=e.borderStyle.width,l=w(this,pc,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",i/2),l.setAttribute("cy",n/2),l.setAttribute("rx",i/2-a/2),l.setAttribute("ry",n/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,pc)}addHighlightArea(){this.container.classList.add("highlightArea")}}pc=new WeakMap;var gc;class mb extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});m(this,gc,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:i,height:n}=Rn(e.rect),s=this.svgFactory.create(i,n,!0);let a=[];for(const c of e.vertices){const d=c.x-e.rect[0],h=e.rect[3]-c.y;a.push(d+","+h)}a=a.join(" ");const l=w(this,gc,this.svgFactory.createElement(this.svgElementName));return l.setAttribute("points",a),l.setAttribute("stroke-width",e.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,gc)}addHighlightArea(){this.container.classList.add("highlightArea")}}gc=new WeakMap;class VT extends mb{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class WT extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var mc;class vb extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});m(this,mc,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=yt.INK}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:i,height:n}=Rn(e.rect),s=this.svgFactory.create(i,n,!0);for(const a of e.inkLists){let l=[];for(const d of a){const h=d.x-e.rect[0],p=e.rect[3]-d.y;l.push(`${h},${p}`)}l=l.join(" ");const c=this.svgFactory.createElement(this.svgElementName);o(this,mc).push(c),c.setAttribute("points",l),c.setAttribute("stroke-width",e.borderStyle.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),!e.popupRef&&this.hasPopupData&&this._createPopup(),s.append(c)}return this.container.append(s),this.container}getElementsToTriggerPopup(){return o(this,mc)}addHighlightArea(){this.container.classList.add("highlightArea")}}mc=new WeakMap;class qT extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class XT extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class YT extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class KT extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class bb extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var vc,bc,ng;class ZT extends Xt{constructor(e){var n;super(e,{isRenderable:!0});m(this,bc);m(this,vc,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(n=this.linkService.eventBus)==null||n.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:i}=this;let n;i.hasAppearance||i.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),n.addEventListener("dblclick",A(this,bc,ng).bind(this)),w(this,vc,n);const{isMac:s}=Oe.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&A(this,bc,ng).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return o(this,vc)}addHighlightArea(){this.container.classList.add("highlightArea")}}vc=new WeakMap,bc=new WeakSet,ng=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var yc,sr,Ua,yu,yb,wc,sg,p0;let JT=(p0=class{constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:n,page:s,viewport:a}){m(this,yu);m(this,wc);m(this,yc,null);m(this,sr,null);m(this,Ua,new Map);this.div=t,w(this,yc,e),w(this,sr,i),this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n}async render(t){var a;const{annotations:e}=t,i=this.div;Lr(i,this.viewport);const n=new Map,s={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Jg,annotationStorage:t.annotationStorage||new nm,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const c=l.annotationType===Zt.POPUP;if(c){const p=n.get(l.id);if(!p)continue;s.elements=p}else{const{width:p,height:g}=Rn(l.rect);if(p<=0||g<=0)continue}s.data=l;const d=MT.create(s);if(!d.isRenderable)continue;if(!c&&l.popupRef){const p=n.get(l.popupRef);p?p.push(d):n.set(l.popupRef,[d])}const h=d.render();l.hidden&&(h.style.visibility="hidden"),A(this,yu,yb).call(this,h,l.id),d.annotationEditorType>0&&(o(this,Ua).set(d.data.id,d),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(d))}A(this,wc,sg).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,Lr(e,{rotation:t.rotation}),A(this,wc,sg).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(o(this,Ua).values())}getEditableAnnotation(t){return o(this,Ua).get(t)}},yc=new WeakMap,sr=new WeakMap,Ua=new WeakMap,yu=new WeakSet,yb=function(t,e){var n;const i=t.firstChild||t;i.id=`${pv}${e}`,this.div.append(t),(n=o(this,yc))==null||n.moveElementInDOM(this.div,t,i,!1)},wc=new WeakSet,sg=function(){if(!o(this,sr))return;const t=this.div;for(const[e,i]of o(this,sr)){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;i.className="annotationContent";const{firstChild:s}=n;s?s.nodeName==="CANVAS"?s.replaceWith(i):s.classList.contains("annotationContent")?s.after(i):s.before(i):n.append(i)}o(this,sr).clear()},p0);const Oh=/\r\n?|\n/g;var Ac,Ec,_c,xc,Sc,di,He,Cc,ze,Ha,wu,wb,Au,Ab,Eu,Eb,za,Qh,Ga,td,Va,ed,_u,_b,Tc,ag,xu,xb;const Dt=class Dt extends Lt{constructor(e){super({...e,name:"freeTextEditor"});m(this,wu);m(this,Au);m(this,Eu);m(this,za);m(this,Va);m(this,_u);m(this,xu);m(this,Ac,this.editorDivBlur.bind(this));m(this,Ec,this.editorDivFocus.bind(this));m(this,_c,this.editorDivInput.bind(this));m(this,xc,this.editorDivKeydown.bind(this));m(this,Sc,this.editorDivPaste.bind(this));m(this,di,void 0);m(this,He,"");m(this,Cc,`${this.id}-editor`);m(this,ze,void 0);m(this,Ha,null);w(this,di,e.color||Dt._defaultColor||Lt._defaultLineColor),w(this,ze,e.fontSize||Dt._defaultFontSize)}static get _keyboardManager(){const e=Dt.prototype,i=a=>a.isEmpty(),n=kr.TRANSLATE_SMALL,s=kr.TRANSLATE_BIG;return Et(this,"_keyboardManager",new Ah([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:i}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:i}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:i}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:i}]]))}static initialize(e,i){Lt.initialize(e,i,{strings:["pdfjs-free-text-default-content"]});const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,i){switch(e){case lt.FREETEXT_SIZE:Dt._defaultFontSize=i;break;case lt.FREETEXT_COLOR:Dt._defaultColor=i;break}}updateParams(e,i){switch(e){case lt.FREETEXT_SIZE:A(this,wu,wb).call(this,i);break;case lt.FREETEXT_COLOR:A(this,Au,Ab).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[lt.FREETEXT_SIZE,Dt._defaultFontSize],[lt.FREETEXT_COLOR,Dt._defaultColor||Lt._defaultLineColor]]}get propertiesToUpdate(){return[[lt.FREETEXT_SIZE,o(this,ze)],[lt.FREETEXT_COLOR,o(this,di)]]}_translateEmpty(e,i){this._uiManager.translateSelectedEditors(e,i,!0)}getInitialTranslation(){const e=this.parentScale;return[-Dt._internalPadding*e,-(Dt._internalPadding+o(this,ze))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(yt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",o(this,xc)),this.editorDiv.addEventListener("focus",o(this,Ec)),this.editorDiv.addEventListener("blur",o(this,Ac)),this.editorDiv.addEventListener("input",o(this,_c)),this.editorDiv.addEventListener("paste",o(this,Sc)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",o(this,Cc)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",o(this,xc)),this.editorDiv.removeEventListener("focus",o(this,Ec)),this.editorDiv.removeEventListener("blur",o(this,Ac)),this.editorDiv.removeEventListener("input",o(this,_c)),this.editorDiv.removeEventListener("paste",o(this,Sc)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width||(this.enableEditMode(),this.editorDiv.focus(),(e=this._initialOptions)!=null&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=o(this,He),i=w(this,He,A(this,Eu,Eb).call(this).trimEnd());if(e===i)return;const n=s=>{if(w(this,He,s),!s){this.remove();return}A(this,Va,ed).call(this),this._uiManager.rebuild(this),A(this,za,Qh).call(this)};this.addCommands({cmd:()=>{n(i)},undo:()=>{n(e)},mustExec:!1}),A(this,za,Qh).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Dt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",o(this,Cc)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),Lt._l10nPromise.get("pdfjs-free-text-default-content").then(s=>{var a;return(a=this.editorDiv)==null?void 0:a.setAttribute("default-content",s)}),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${o(this,ze)}px * var(--scale-factor))`,n.color=o(this,di),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),vd(this,this.div,["dblclick","keydown"]),this.width){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=o(this,Ha);let[c,d]=this.getInitialTranslation();[c,d]=this.pageTranslationToScreen(c,d);const[h,p]=this.pageDimensions,[g,v]=this.pageTranslation;let b,E;switch(this.rotation){case 0:b=e+(l[0]-g)/h,E=i+this.height-(l[1]-v)/p;break;case 90:b=e+(l[0]-g)/h,E=i-(l[1]-v)/p,[c,d]=[d,-c];break;case 180:b=e-this.width+(l[0]-g)/h,E=i-(l[1]-v)/p,[c,d]=[-c,-d];break;case 270:b=e+(l[0]-g-this.height*p)/h,E=i+(l[1]-v-this.width*h)/p,[c,d]=[-d,c];break}this.setAt(b*s,E*a,c,d)}else this.setAt(e*s,i*a,this.width*s,this.height*a);A(this,Va,ed).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var b,E,C;const i=e.clipboardData||window.clipboardData,{types:n}=i;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const s=A(b=Dt,Tc,ag).call(b,i.getData("text")||"").replaceAll(Oh,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:d}=l,h=[],p=[];if(c.nodeType===Node.TEXT_NODE){const _=c.parentElement;if(p.push(c.nodeValue.slice(d).replaceAll(Oh,"")),_!==this.editorDiv){let R=h;for(const L of this.editorDiv.childNodes){if(L===_){R=p;continue}R.push(A(E=Dt,Ga,td).call(E,L))}}h.push(c.nodeValue.slice(0,d).replaceAll(Oh,""))}else if(c===this.editorDiv){let _=h,R=0;for(const L of this.editorDiv.childNodes)R++===d&&(_=p),_.push(A(C=Dt,Ga,td).call(C,L))}w(this,He,`${h.join(`
`)}${s}${p.join(`
`)}`),A(this,Va,ed).call(this);const g=new Range;let v=h.reduce((_,R)=>_+R.length,0);for(const{firstChild:_}of this.editorDiv.childNodes)if(_.nodeType===Node.TEXT_NODE){const R=_.nodeValue.length;if(v<=R){g.setStart(_,v),g.setEnd(_,v);break}v-=R}a.removeAllRanges(),a.addRange(g)}get contentDiv(){return this.editorDiv}static deserialize(e,i,n){var l;let s=null;if(e instanceof gb){const{data:{defaultAppearanceData:{fontSize:c,fontColor:d},rect:h,rotation:p,id:g},textContent:v,textPosition:b,parent:{page:{pageNumber:E}}}=e;if(!v||v.length===0)return null;s=e={annotationType:yt.FREETEXT,color:Array.from(d),fontSize:c,value:v.join(`
`),position:b,pageIndex:E-1,rect:h.slice(0),rotation:p,id:g,deleted:!1}}const a=super.deserialize(e,i,n);return w(a,ze,e.fontSize),w(a,di,J.makeHexColor(...e.color)),w(a,He,A(l=Dt,Tc,ag).call(l,e.value)),a.annotationElementId=e.id||null,w(a,Ha,s),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const i=Dt._internalPadding*this.parentScale,n=this.getRect(i,i),s=Lt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:o(this,di)),a={annotationType:yt.FREETEXT,color:s,fontSize:o(this,ze),value:A(this,_u,_b).call(this),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?a:this.annotationElementId&&!A(this,xu,xb).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(e){const i=super.renderAnnotationElement(e);if(this.deleted)return i;const{style:n}=i;n.fontSize=`calc(${o(this,ze)}px * var(--scale-factor))`,n.color=o(this,di),i.replaceChildren();for(const a of o(this,He).split(`
`)){const l=document.createElement("div");l.append(a?document.createTextNode(a):document.createElement("br")),i.append(l)}const s=Dt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:o(this,He)}),i}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Ac=new WeakMap,Ec=new WeakMap,_c=new WeakMap,xc=new WeakMap,Sc=new WeakMap,di=new WeakMap,He=new WeakMap,Cc=new WeakMap,ze=new WeakMap,Ha=new WeakMap,wu=new WeakSet,wb=function(e){const i=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-o(this,ze))*this.parentScale),w(this,ze,s),A(this,za,Qh).call(this)},n=o(this,ze);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Au=new WeakSet,Ab=function(e){const i=s=>{w(this,di,this.editorDiv.style.color=s)},n=o(this,di);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Eu=new WeakSet,Eb=function(){var i;const e=[];this.editorDiv.normalize();for(const n of this.editorDiv.childNodes)e.push(A(i=Dt,Ga,td).call(i,n));return e.join(`
`)},za=new WeakSet,Qh=function(){const[e,i]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,l=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/i):(this.width=n.height/e,this.height=n.width/i),this.fixAndSetPosition()},Ga=new WeakSet,td=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Oh,"")},Va=new WeakSet,ed=function(){if(this.editorDiv.replaceChildren(),!!o(this,He))for(const e of o(this,He).split(`
`)){const i=document.createElement("div");i.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(i)}},_u=new WeakSet,_b=function(){return o(this,He).replaceAll(" "," ")},Tc=new WeakSet,ag=function(e){return e.replaceAll(" "," ")},xu=new WeakSet,xb=function(e){const{value:i,fontSize:n,color:s,pageIndex:a}=o(this,Ha);return this._hasBeenMoved||e.value!==i||e.fontSize!==n||e.color.some((l,c)=>l!==s[c])||e.pageIndex!==a},m(Dt,Ga),m(Dt,Tc),ct(Dt,"_freeTextDefaultContent",""),ct(Dt,"_internalPadding",0),ct(Dt,"_defaultColor",null),ct(Dt,"_defaultFontSize",10),ct(Dt,"_type","freetext"),ct(Dt,"_editorType",yt.FREETEXT);let rg=Dt;var Pc,Jn,ui,Su,Sb,Wa,id,Cu,Cb,Tu,Tb,Rc,lg;class og{constructor(t,e=0,i=0,n=!0){m(this,Su);m(this,Wa);m(this,Cu);m(this,Tu);m(this,Rc);m(this,Pc,void 0);m(this,Jn,[]);m(this,ui,[]);let s=1/0,a=-1/0,l=1/0,c=-1/0;const h=10**-4;for(const{x:_,y:R,width:L,height:D}of t){const O=Math.floor((_-e)/h)*h,N=Math.ceil((_+L+e)/h)*h,j=Math.floor((R-e)/h)*h,S=Math.ceil((R+D+e)/h)*h,T=[O,j,S,!0],F=[N,j,S,!1];o(this,Jn).push(T,F),s=Math.min(s,O),a=Math.max(a,N),l=Math.min(l,j),c=Math.max(c,S)}const p=a-s+2*i,g=c-l+2*i,v=s-i,b=l-i,E=o(this,Jn).at(n?-1:-2),C=[E[0],E[2]];for(const _ of o(this,Jn)){const[R,L,D]=_;_[0]=(R-v)/p,_[1]=(L-b)/g,_[2]=(D-b)/g}w(this,Pc,{x:v,y:b,width:p,height:g,lastPoint:C})}getOutlines(){o(this,Jn).sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of o(this,Jn))e[3]?(t.push(...A(this,Rc,lg).call(this,e)),A(this,Cu,Cb).call(this,e)):(A(this,Tu,Tb).call(this,e),t.push(...A(this,Rc,lg).call(this,e)));return A(this,Su,Sb).call(this,t)}}Pc=new WeakMap,Jn=new WeakMap,ui=new WeakMap,Su=new WeakSet,Sb=function(t){const e=[],i=new Set;for(const a of t){const[l,c,d]=a;e.push([l,c,a],[l,d,a])}e.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=e.length;a<l;a+=2){const c=e[a][2],d=e[a+1][2];c.push(d),d.push(c),i.add(c),i.add(d)}const n=[];let s;for(;i.size>0;){const a=i.values().next().value;let[l,c,d,h,p]=a;i.delete(a);let g=l,v=c;for(s=[l,d],n.push(s);;){let b;if(i.has(h))b=h;else if(i.has(p))b=p;else break;i.delete(b),[l,c,d,h,p]=b,g!==l&&(s.push(g,v,l,v===c?c:d),g=l),v=v===c?d:c}s.push(g,v)}return new QT(n,o(this,Pc))},Wa=new WeakSet,id=function(t){const e=o(this,ui);let i=0,n=e.length-1;for(;i<=n;){const s=i+n>>1,a=e[s][0];if(a===t)return s;a<t?i=s+1:n=s-1}return n+1},Cu=new WeakSet,Cb=function([,t,e]){const i=A(this,Wa,id).call(this,t);o(this,ui).splice(i,0,[t,e])},Tu=new WeakSet,Tb=function([,t,e]){const i=A(this,Wa,id).call(this,t);for(let n=i;n<o(this,ui).length;n++){const[s,a]=o(this,ui)[n];if(s!==t)break;if(s===t&&a===e){o(this,ui).splice(n,1);return}}for(let n=i-1;n>=0;n--){const[s,a]=o(this,ui)[n];if(s!==t)break;if(s===t&&a===e){o(this,ui).splice(n,1);return}}},Rc=new WeakSet,lg=function(t){const[e,i,n]=t,s=[[e,i,n]],a=A(this,Wa,id).call(this,n);for(let l=0;l<a;l++){const[c,d]=o(this,ui)[l];for(let h=0,p=s.length;h<p;h++){const[,g,v]=s[h];if(!(d<=g||v<=c)){if(g>=c){if(v>d)s[h][1]=d;else{if(p===1)return[];s.splice(h,1),h--,p--}continue}s[h][2]=c,v>d&&s.push([e,d,v])}}}return s};class Pb{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(t,e){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof hg}}var Lc,qa;class QT extends Pb{constructor(e,i){super();m(this,Lc,void 0);m(this,qa,void 0);w(this,qa,e),w(this,Lc,i)}toSVGPath(){const e=[];for(const i of o(this,qa)){let[n,s]=i;e.push(`M${n} ${s}`);for(let a=2;a<i.length;a+=2){const l=i[a],c=i[a+1];l===n?(e.push(`V${c}`),s=c):c===s&&(e.push(`H${l}`),n=l)}e.push("Z")}return e.join(" ")}serialize([e,i,n,s],a){const l=[],c=n-e,d=s-i;for(const h of o(this,qa)){const p=new Array(h.length);for(let g=0;g<h.length;g+=2)p[g]=e+h[g]*c,p[g+1]=s-h[g+1]*d;l.push(p)}return l}get box(){return o(this,Lc)}}Lc=new WeakMap,qa=new WeakMap;var ki,vn,Xa,Ya,Ii,bt,rr,ar,kc,Ic,Ka,Za,Qn,Fc,Pu,Ru,Mc,cg;const Xi=class Xi{constructor({x:t,y:e},i,n,s,a,l=0){m(this,Mc);m(this,ki,void 0);m(this,vn,[]);m(this,Xa,void 0);m(this,Ya,void 0);m(this,Ii,[]);m(this,bt,new Float64Array(18));m(this,rr,void 0);m(this,ar,void 0);m(this,kc,void 0);m(this,Ic,void 0);m(this,Ka,void 0);m(this,Za,void 0);m(this,Qn,[]);w(this,ki,i),w(this,Za,s*n),w(this,Ya,a),o(this,bt).set([NaN,NaN,NaN,NaN,t,e],6),w(this,Xa,l),w(this,Ic,o(Xi,Fc)*n),w(this,kc,o(Xi,Ru)*n),w(this,Ka,n),o(this,Qn).push(t,e)}get free(){return!0}isEmpty(){return isNaN(o(this,bt)[8])}add({x:t,y:e}){var T;w(this,rr,t),w(this,ar,e);const[i,n,s,a]=o(this,ki);let[l,c,d,h]=o(this,bt).subarray(8,12);const p=t-d,g=e-h,v=Math.hypot(p,g);if(v<o(this,kc))return!1;const b=v-o(this,Ic),E=b/v,C=E*p,_=E*g;let R=l,L=c;l=d,c=h,d+=C,h+=_,(T=o(this,Qn))==null||T.push(t,e);const D=-_/b,O=C/b,N=D*o(this,Za),j=O*o(this,Za);return o(this,bt).set(o(this,bt).subarray(2,8),0),o(this,bt).set([d+N,h+j],4),o(this,bt).set(o(this,bt).subarray(14,18),12),o(this,bt).set([d-N,h-j],16),isNaN(o(this,bt)[6])?(o(this,Ii).length===0&&(o(this,bt).set([l+N,c+j],2),o(this,Ii).push(NaN,NaN,NaN,NaN,(l+N-i)/s,(c+j-n)/a),o(this,bt).set([l-N,c-j],14),o(this,vn).push(NaN,NaN,NaN,NaN,(l-N-i)/s,(c-j-n)/a)),o(this,bt).set([R,L,l,c,d,h],6),!this.isEmpty()):(o(this,bt).set([R,L,l,c,d,h],6),Math.abs(Math.atan2(L-c,R-l)-Math.atan2(_,C))<Math.PI/2?([l,c,d,h]=o(this,bt).subarray(2,6),o(this,Ii).push(NaN,NaN,NaN,NaN,((l+d)/2-i)/s,((c+h)/2-n)/a),[l,c,R,L]=o(this,bt).subarray(14,18),o(this,vn).push(NaN,NaN,NaN,NaN,((R+l)/2-i)/s,((L+c)/2-n)/a),!0):([R,L,l,c,d,h]=o(this,bt).subarray(0,6),o(this,Ii).push(((R+5*l)/6-i)/s,((L+5*c)/6-n)/a,((5*l+d)/6-i)/s,((5*c+h)/6-n)/a,((l+d)/2-i)/s,((c+h)/2-n)/a),[d,h,l,c,R,L]=o(this,bt).subarray(12,18),o(this,vn).push(((R+5*l)/6-i)/s,((L+5*c)/6-n)/a,((5*l+d)/6-i)/s,((5*c+h)/6-n)/a,((l+d)/2-i)/s,((c+h)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=o(this,Ii),e=o(this,vn),i=o(this,bt).subarray(4,6),n=o(this,bt).subarray(16,18),[s,a,l,c]=o(this,ki),[d,h,p,g]=A(this,Mc,cg).call(this);if(isNaN(o(this,bt)[6])&&!this.isEmpty())return`M${(o(this,bt)[2]-s)/l} ${(o(this,bt)[3]-a)/c} L${(o(this,bt)[4]-s)/l} ${(o(this,bt)[5]-a)/c} L${d} ${h} L${p} ${g} L${(o(this,bt)[16]-s)/l} ${(o(this,bt)[17]-a)/c} L${(o(this,bt)[14]-s)/l} ${(o(this,bt)[15]-a)/c} Z`;const v=[];v.push(`M${t[4]} ${t[5]}`);for(let b=6;b<t.length;b+=6)isNaN(t[b])?v.push(`L${t[b+4]} ${t[b+5]}`):v.push(`C${t[b]} ${t[b+1]} ${t[b+2]} ${t[b+3]} ${t[b+4]} ${t[b+5]}`);v.push(`L${(i[0]-s)/l} ${(i[1]-a)/c} L${d} ${h} L${p} ${g} L${(n[0]-s)/l} ${(n[1]-a)/c}`);for(let b=e.length-6;b>=6;b-=6)isNaN(e[b])?v.push(`L${e[b+4]} ${e[b+5]}`):v.push(`C${e[b]} ${e[b+1]} ${e[b+2]} ${e[b+3]} ${e[b+4]} ${e[b+5]}`);return v.push(`L${e[4]} ${e[5]} Z`),v.join(" ")}getOutlines(){var _;const t=o(this,Ii),e=o(this,vn),i=o(this,bt),n=i.subarray(4,6),s=i.subarray(16,18),[a,l,c,d]=o(this,ki),h=new Float64Array((((_=o(this,Qn))==null?void 0:_.length)??0)+2);for(let R=0,L=h.length-2;R<L;R+=2)h[R]=(o(this,Qn)[R]-a)/c,h[R+1]=(o(this,Qn)[R+1]-l)/d;h[h.length-2]=(o(this,rr)-a)/c,h[h.length-1]=(o(this,ar)-l)/d;const[p,g,v,b]=A(this,Mc,cg).call(this);if(isNaN(i[6])&&!this.isEmpty()){const R=new Float64Array(36);return R.set([NaN,NaN,NaN,NaN,(i[2]-a)/c,(i[3]-l)/d,NaN,NaN,NaN,NaN,(i[4]-a)/c,(i[5]-l)/d,NaN,NaN,NaN,NaN,p,g,NaN,NaN,NaN,NaN,v,b,NaN,NaN,NaN,NaN,(i[16]-a)/c,(i[17]-l)/d,NaN,NaN,NaN,NaN,(i[14]-a)/c,(i[15]-l)/d],0),new hg(R,h,o(this,ki),o(this,Ka),o(this,Xa),o(this,Ya))}const E=new Float64Array(o(this,Ii).length+24+o(this,vn).length);let C=t.length;for(let R=0;R<C;R+=2){if(isNaN(t[R])){E[R]=E[R+1]=NaN;continue}E[R]=t[R],E[R+1]=t[R+1]}E.set([NaN,NaN,NaN,NaN,(n[0]-a)/c,(n[1]-l)/d,NaN,NaN,NaN,NaN,p,g,NaN,NaN,NaN,NaN,v,b,NaN,NaN,NaN,NaN,(s[0]-a)/c,(s[1]-l)/d],C),C+=24;for(let R=e.length-6;R>=6;R-=6)for(let L=0;L<6;L+=2){if(isNaN(e[R+L])){E[C]=E[C+1]=NaN,C+=2;continue}E[C]=e[R+L],E[C+1]=e[R+L+1],C+=2}return E.set([NaN,NaN,NaN,NaN,e[4],e[5]],C),new hg(E,h,o(this,ki),o(this,Ka),o(this,Xa),o(this,Ya))}};ki=new WeakMap,vn=new WeakMap,Xa=new WeakMap,Ya=new WeakMap,Ii=new WeakMap,bt=new WeakMap,rr=new WeakMap,ar=new WeakMap,kc=new WeakMap,Ic=new WeakMap,Ka=new WeakMap,Za=new WeakMap,Qn=new WeakMap,Fc=new WeakMap,Pu=new WeakMap,Ru=new WeakMap,Mc=new WeakSet,cg=function(){const t=o(this,bt).subarray(4,6),e=o(this,bt).subarray(16,18),[i,n,s,a]=o(this,ki);return[(o(this,rr)+(t[0]-e[0])/2-i)/s,(o(this,ar)+(t[1]-e[1])/2-n)/a,(o(this,rr)+(e[0]-t[0])/2-i)/s,(o(this,ar)+(e[1]-t[1])/2-n)/a]},m(Xi,Fc,8),m(Xi,Pu,2),m(Xi,Ru,o(Xi,Fc)+o(Xi,Pu));let Ad=Xi;var Ja,or,bn,Dc,Ge,Oc,qt,lr,Do,cr,Oo,Lu,Rb;class hg extends Pb{constructor(e,i,n,s,a,l){super();m(this,lr);m(this,cr);m(this,Lu);m(this,Ja,void 0);m(this,or,null);m(this,bn,void 0);m(this,Dc,void 0);m(this,Ge,void 0);m(this,Oc,void 0);m(this,qt,void 0);w(this,qt,e),w(this,Ge,i),w(this,Ja,n),w(this,Oc,s),w(this,bn,a),w(this,Dc,l),A(this,Lu,Rb).call(this,l);const{x:c,y:d,width:h,height:p}=o(this,or);for(let g=0,v=e.length;g<v;g+=2)e[g]=(e[g]-c)/h,e[g+1]=(e[g+1]-d)/p;for(let g=0,v=i.length;g<v;g+=2)i[g]=(i[g]-c)/h,i[g+1]=(i[g+1]-d)/p}toSVGPath(){const e=[`M${o(this,qt)[4]} ${o(this,qt)[5]}`];for(let i=6,n=o(this,qt).length;i<n;i+=6){if(isNaN(o(this,qt)[i])){e.push(`L${o(this,qt)[i+4]} ${o(this,qt)[i+5]}`);continue}e.push(`C${o(this,qt)[i]} ${o(this,qt)[i+1]} ${o(this,qt)[i+2]} ${o(this,qt)[i+3]} ${o(this,qt)[i+4]} ${o(this,qt)[i+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,i,n,s],a){const l=n-e,c=s-i;let d,h;switch(a){case 0:d=A(this,lr,Do).call(this,o(this,qt),e,s,l,-c),h=A(this,lr,Do).call(this,o(this,Ge),e,s,l,-c);break;case 90:d=A(this,cr,Oo).call(this,o(this,qt),e,i,l,c),h=A(this,cr,Oo).call(this,o(this,Ge),e,i,l,c);break;case 180:d=A(this,lr,Do).call(this,o(this,qt),n,i,-l,c),h=A(this,lr,Do).call(this,o(this,Ge),n,i,-l,c);break;case 270:d=A(this,cr,Oo).call(this,o(this,qt),n,s,-l,-c),h=A(this,cr,Oo).call(this,o(this,Ge),n,s,-l,-c);break}return{outline:Array.from(d),points:[Array.from(h)]}}get box(){return o(this,or)}getNewOutline(e,i){const{x:n,y:s,width:a,height:l}=o(this,or),[c,d,h,p]=o(this,Ja),g=a*h,v=l*p,b=n*h+c,E=s*p+d,C=new Ad({x:o(this,Ge)[0]*g+b,y:o(this,Ge)[1]*v+E},o(this,Ja),o(this,Oc),e,o(this,Dc),i??o(this,bn));for(let _=2;_<o(this,Ge).length;_+=2)C.add({x:o(this,Ge)[_]*g+b,y:o(this,Ge)[_+1]*v+E});return C.getOutlines()}}Ja=new WeakMap,or=new WeakMap,bn=new WeakMap,Dc=new WeakMap,Ge=new WeakMap,Oc=new WeakMap,qt=new WeakMap,lr=new WeakSet,Do=function(e,i,n,s,a){const l=new Float64Array(e.length);for(let c=0,d=e.length;c<d;c+=2)l[c]=i+e[c]*s,l[c+1]=n+e[c+1]*a;return l},cr=new WeakSet,Oo=function(e,i,n,s,a){const l=new Float64Array(e.length);for(let c=0,d=e.length;c<d;c+=2)l[c]=i+e[c+1]*s,l[c+1]=n+e[c]*a;return l},Lu=new WeakSet,Rb=function(e){const i=o(this,qt);let n=i[4],s=i[5],a=n,l=s,c=n,d=s,h=n,p=s;const g=e?Math.max:Math.min;for(let _=6,R=i.length;_<R;_+=6){if(isNaN(i[_]))a=Math.min(a,i[_+4]),l=Math.min(l,i[_+5]),c=Math.max(c,i[_+4]),d=Math.max(d,i[_+5]),p<i[_+5]?(h=i[_+4],p=i[_+5]):p===i[_+5]&&(h=g(h,i[_+4]));else{const L=J.bezierBoundingBox(n,s,...i.slice(_,_+6));a=Math.min(a,L[0]),l=Math.min(l,L[1]),c=Math.max(c,L[2]),d=Math.max(d,L[3]),p<L[3]?(h=L[2],p=L[3]):p===L[3]&&(h=g(h,L[2]))}n=i[_+4],s=i[_+5]}const v=a-o(this,bn),b=l-o(this,bn),E=c-a+2*o(this,bn),C=d-l+2*o(this,bn);w(this,or,{x:v,y:b,width:E,height:C,lastPoint:[h,p]})};var Nc,Bc,fi,hr,Qa,Qt,$c,to,jc,Uc,ts,eo,Hc,dg,zc,ug,ku,Lb,yn,bs,Iu,kb,Fi,Dn;const Yi=class Yi{constructor({editor:t=null,uiManager:e=null}){m(this,Hc);m(this,zc);m(this,ku);m(this,yn);m(this,Iu);m(this,Fi);m(this,Nc,A(this,ku,Lb).bind(this));m(this,Bc,A(this,Iu,kb).bind(this));m(this,fi,null);m(this,hr,null);m(this,Qa,void 0);m(this,Qt,null);m(this,$c,!1);m(this,to,!1);m(this,jc,null);m(this,Uc,void 0);m(this,ts,null);m(this,eo,void 0);var i;t?(w(this,to,!1),w(this,eo,lt.HIGHLIGHT_COLOR),w(this,jc,t)):(w(this,to,!0),w(this,eo,lt.HIGHLIGHT_DEFAULT_COLOR)),w(this,ts,(t==null?void 0:t._uiManager)||e),w(this,Uc,o(this,ts)._eventBus),w(this,Qa,(t==null?void 0:t.color)||((i=o(this,ts))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return Et(this,"_keyboardManager",new Ah([[["Escape","mac+Escape"],Yi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Yi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Yi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Yi.prototype._moveToPrevious],[["Home","mac+Home"],Yi.prototype._moveToBeginning],[["End","mac+End"],Yi.prototype._moveToEnd]]))}renderButton(){const t=w(this,fi,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0),t.addEventListener("click",A(this,yn,bs).bind(this)),t.addEventListener("keydown",o(this,Nc));const e=w(this,hr,document.createElement("span"));return e.className="swatch",e.setAttribute("aria-hidden",!0),e.style.backgroundColor=o(this,Qa),t.append(e),t}renderMainDropdown(){const t=w(this,Qt,A(this,Hc,dg).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===o(this,fi)){A(this,yn,bs).call(this,t);return}const e=t.target.getAttribute("data-color");e&&A(this,zc,ug).call(this,e,t)}_moveToNext(t){var e,i;if(!o(this,Fi,Dn)){A(this,yn,bs).call(this,t);return}if(t.target===o(this,fi)){(e=o(this,Qt).firstChild)==null||e.focus();return}(i=t.target.nextSibling)==null||i.focus()}_moveToPrevious(t){var e,i;if(t.target===((e=o(this,Qt))==null?void 0:e.firstChild)||t.target===o(this,fi)){o(this,Fi,Dn)&&this._hideDropdownFromKeyboard();return}o(this,Fi,Dn)||A(this,yn,bs).call(this,t),(i=t.target.previousSibling)==null||i.focus()}_moveToBeginning(t){var e;if(!o(this,Fi,Dn)){A(this,yn,bs).call(this,t);return}(e=o(this,Qt).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!o(this,Fi,Dn)){A(this,yn,bs).call(this,t);return}(e=o(this,Qt).lastChild)==null||e.focus()}hideDropdown(){var t;(t=o(this,Qt))==null||t.classList.add("hidden"),window.removeEventListener("pointerdown",o(this,Bc))}_hideDropdownFromKeyboard(){var t;if(!o(this,to)){if(!o(this,Fi,Dn)){(t=o(this,jc))==null||t.unselect();return}this.hideDropdown(),o(this,fi).focus({preventScroll:!0,focusVisible:o(this,$c)})}}updateColor(t){if(o(this,hr)&&(o(this,hr).style.backgroundColor=t),!o(this,Qt))return;const e=o(this,ts).highlightColors.values();for(const i of o(this,Qt).children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=o(this,fi))==null||t.remove(),w(this,fi,null),w(this,hr,null),(e=o(this,Qt))==null||e.remove(),w(this,Qt,null)}};Nc=new WeakMap,Bc=new WeakMap,fi=new WeakMap,hr=new WeakMap,Qa=new WeakMap,Qt=new WeakMap,$c=new WeakMap,to=new WeakMap,jc=new WeakMap,Uc=new WeakMap,ts=new WeakMap,eo=new WeakMap,Hc=new WeakSet,dg=function(){const t=document.createElement("div");t.addEventListener("contextmenu",Ne),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[e,i]of o(this,ts).highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",i),n.title=e,n.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${e}`);const s=document.createElement("span");n.append(s),s.className="swatch",s.style.backgroundColor=i,n.setAttribute("aria-selected",i===o(this,Qa)),n.addEventListener("click",A(this,zc,ug).bind(this,i)),t.append(n)}return t.addEventListener("keydown",o(this,Nc)),t},zc=new WeakSet,ug=function(t,e){e.stopPropagation(),o(this,Uc).dispatch("switchannotationeditorparams",{source:this,type:o(this,eo),value:t})},ku=new WeakSet,Lb=function(t){Yi._keyboardManager.exec(this,t)},yn=new WeakSet,bs=function(t){if(o(this,Fi,Dn)){this.hideDropdown();return}if(w(this,$c,t.detail===0),window.addEventListener("pointerdown",o(this,Bc)),o(this,Qt)){o(this,Qt).classList.remove("hidden");return}const e=w(this,Qt,A(this,Hc,dg).call(this));o(this,fi).append(e)},Iu=new WeakSet,kb=function(t){var e;(e=o(this,Qt))!=null&&e.contains(t.target)||this.hideDropdown()},Fi=new WeakSet,Dn=function(){return o(this,Qt)&&!o(this,Qt).classList.contains("hidden")};let Ed=Yi;var io,Gc,es,dr,no,ti,Vc,Wc,ur,pi,Ce,Ve,Fu,so,fr,te,ro,Mi,qc,Xc,fg,Yc,pg,Mu,Ib,Du,Fb,Ou,Mb,Kc,gg,pr,No,is,Wr,Nu,Db,ao,nd,gr,Bo,Bu,Ob,$u,Nb,ju,Bb,Uu,$b;const At=class At extends Lt{constructor(e){super({...e,name:"highlightEditor"});m(this,Xc);m(this,Yc);m(this,Mu);m(this,Du);m(this,Ou);m(this,Kc);m(this,pr);m(this,Nu);m(this,ao);m(this,gr);m(this,Bu);m(this,$u);m(this,io,null);m(this,Gc,0);m(this,es,void 0);m(this,dr,null);m(this,no,null);m(this,ti,null);m(this,Vc,null);m(this,Wc,0);m(this,ur,null);m(this,pi,null);m(this,Ce,null);m(this,Ve,!1);m(this,Fu,A(this,Nu,Db).bind(this));m(this,so,null);m(this,fr,void 0);m(this,te,null);m(this,ro,"");m(this,Mi,void 0);m(this,qc,"");this.color=e.color||At._defaultColor,w(this,Mi,e.thickness||At._defaultThickness),w(this,fr,e.opacity||At._defaultOpacity),w(this,es,e.boxes||null),w(this,qc,e.methodOfCreation||""),w(this,ro,e.text||""),this._isDraggable=!1,e.highlightId>-1?(w(this,Ve,!0),A(this,Yc,pg).call(this,e),A(this,pr,No).call(this)):(w(this,io,e.anchorNode),w(this,Gc,e.anchorOffset),w(this,Vc,e.focusNode),w(this,Wc,e.focusOffset),A(this,Xc,fg).call(this),A(this,pr,No).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=At.prototype;return Et(this,"_keyboardManager",new Ah([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:o(this,Ve)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:o(this,Mi),methodOfCreation:o(this,qc)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,i){var n;Lt.initialize(e,i),At._defaultColor||(At._defaultColor=((n=i.highlightColors)==null?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(e,i){switch(e){case lt.HIGHLIGHT_DEFAULT_COLOR:At._defaultColor=i;break;case lt.HIGHLIGHT_THICKNESS:At._defaultThickness=i;break}}translateInPage(e,i){}get toolbarPosition(){return o(this,so)}updateParams(e,i){switch(e){case lt.HIGHLIGHT_COLOR:A(this,Mu,Ib).call(this,i);break;case lt.HIGHLIGHT_THICKNESS:A(this,Du,Fb).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[lt.HIGHLIGHT_DEFAULT_COLOR,At._defaultColor],[lt.HIGHLIGHT_THICKNESS,At._defaultThickness]]}get propertiesToUpdate(){return[[lt.HIGHLIGHT_COLOR,this.color||At._defaultColor],[lt.HIGHLIGHT_THICKNESS,o(this,Mi)||At._defaultThickness],[lt.HIGHLIGHT_FREE,o(this,Ve)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(w(this,no,new Ed({editor:this})),e.addColorPicker(o(this,no))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,gr,Bo).call(this))}getBaseTranslation(){return[0,0]}getRect(e,i){return super.getRect(e,i,A(this,gr,Bo).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){A(this,Kc,gg).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,pr,No).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var n;let i=!1;this.parent&&!e?A(this,Kc,gg).call(this):e&&(A(this,pr,No).call(this,e),i=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),i&&this.select()}rotate(e){var s,a,l;const{drawLayer:i}=this.parent;let n;o(this,Ve)?(e=(e-this.rotation+360)%360,n=A(s=At,is,Wr).call(s,o(this,pi).box,e)):n=A(a=At,is,Wr).call(a,this,e),i.rotate(o(this,Ce),e),i.rotate(o(this,te),e),i.updateBox(o(this,Ce),n),i.updateBox(o(this,te),A(l=At,is,Wr).call(l,o(this,ti).box,e))}render(){if(this.div)return this.div;const e=super.render();o(this,ro)&&(e.setAttribute("aria-label",o(this,ro)),e.setAttribute("role","mark")),o(this,Ve)?e.classList.add("free"):this.div.addEventListener("keydown",o(this,Fu));const i=w(this,ur,document.createElement("div"));e.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=o(this,dr);const[n,s]=this.parentDimensions;return this.setDims(this.width*n,this.height*s),vd(this,o(this,ur),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.parent.drawLayer.addClass(o(this,te),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(o(this,te),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:A(this,ao,nd).call(this,!0);break;case 1:case 3:A(this,ao,nd).call(this,!1);break}}select(){var e,i;super.select(),o(this,te)&&((e=this.parent)==null||e.drawLayer.removeClass(o(this,te),"hovered"),(i=this.parent)==null||i.drawLayer.addClass(o(this,te),"selected"))}unselect(){var e;super.unselect(),o(this,te)&&((e=this.parent)==null||e.drawLayer.removeClass(o(this,te),"selected"),o(this,Ve)||A(this,ao,nd).call(this,!1))}get _mustFixPosition(){return!o(this,Ve)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(o(this,Ce),e),this.parent.drawLayer.show(o(this,te),e))}static startHighlighting(e,i,{target:n,x:s,y:a}){const{x:l,y:c,width:d,height:h}=n.getBoundingClientRect(),p=E=>{A(this,ju,Bb).call(this,e,E)},g={capture:!0,passive:!1},v=E=>{E.preventDefault(),E.stopPropagation()},b=E=>{n.removeEventListener("pointermove",p),window.removeEventListener("blur",b),window.removeEventListener("pointerup",b),window.removeEventListener("pointerdown",v,g),window.removeEventListener("contextmenu",Ne),A(this,Uu,$b).call(this,e,E)};window.addEventListener("blur",b),window.addEventListener("pointerup",b),window.addEventListener("pointerdown",v,g),window.addEventListener("contextmenu",Ne),n.addEventListener("pointermove",p),this._freeHighlight=new Ad({x:s,y:a},[l,c,d,h],e.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(e,i,n){var E;const s=super.deserialize(e,i,n),{rect:[a,l,c,d],color:h,quadPoints:p}=e;s.color=J.makeHexColor(...h),w(s,fr,e.opacity);const[g,v]=s.pageDimensions;s.width=(c-a)/g,s.height=(d-l)/v;const b=w(s,es,[]);for(let C=0;C<p.length;C+=8)b.push({x:(p[4]-c)/g,y:(d-(1-p[C+5]))/v,width:(p[C+2]-p[C])/g,height:(p[C+5]-p[C+1])/v});return A(E=s,Xc,fg).call(E),s}serialize(e=!1){if(this.isEmpty()||e)return null;const i=this.getRect(0,0),n=Lt._colorManager.convert(this.color);return{annotationType:yt.HIGHLIGHT,color:n,opacity:o(this,fr),thickness:o(this,Mi),quadPoints:A(this,Bu,Ob).call(this),outlines:A(this,$u,Nb).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:A(this,gr,Bo).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};io=new WeakMap,Gc=new WeakMap,es=new WeakMap,dr=new WeakMap,no=new WeakMap,ti=new WeakMap,Vc=new WeakMap,Wc=new WeakMap,ur=new WeakMap,pi=new WeakMap,Ce=new WeakMap,Ve=new WeakMap,Fu=new WeakMap,so=new WeakMap,fr=new WeakMap,te=new WeakMap,ro=new WeakMap,Mi=new WeakMap,qc=new WeakMap,Xc=new WeakSet,fg=function(){const e=new og(o(this,es),.001);w(this,pi,e.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=o(this,pi).box;const i=new og(o(this,es),.0025,.001,this._uiManager.direction==="ltr");w(this,ti,i.getOutlines());const{lastPoint:n}=o(this,ti).box;w(this,so,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])},Yc=new WeakSet,pg=function({highlightOutlines:e,highlightId:i,clipPathId:n}){var p,g;if(w(this,pi,e),w(this,ti,e.getNewOutline(o(this,Mi)/2+1.5,.0025)),i>=0)w(this,Ce,i),w(this,dr,n),this.parent.drawLayer.finalizeLine(i,e),w(this,te,this.parent.drawLayer.highlightOutline(o(this,ti)));else if(this.parent){const v=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(o(this,Ce),e),this.parent.drawLayer.updateBox(o(this,Ce),A(p=At,is,Wr).call(p,o(this,pi).box,(v-this.rotation+360)%360)),this.parent.drawLayer.updateLine(o(this,te),o(this,ti)),this.parent.drawLayer.updateBox(o(this,te),A(g=At,is,Wr).call(g,o(this,ti).box,v))}const{x:a,y:l,width:c,height:d}=e.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=c,this.height=d;break;case 90:{const[v,b]=this.parentDimensions;this.x=l,this.y=1-a,this.width=c*b/v,this.height=d*v/b;break}case 180:this.x=1-a,this.y=1-l,this.width=c,this.height=d;break;case 270:{const[v,b]=this.parentDimensions;this.x=1-l,this.y=a,this.width=c*b/v,this.height=d*v/b;break}}const{lastPoint:h}=o(this,ti).box;w(this,so,[(h[0]-a)/c,(h[1]-l)/d])},Mu=new WeakSet,Ib=function(e){const i=s=>{var a,l;this.color=s,(a=this.parent)==null||a.drawLayer.changeColor(o(this,Ce),s),(l=o(this,no))==null||l.updateColor(s)},n=this.color;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},Du=new WeakSet,Fb=function(e){const i=o(this,Mi),n=s=>{w(this,Mi,s),A(this,Ou,Mb).call(this,s)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},Ou=new WeakSet,Mb=function(e){if(!o(this,Ve))return;A(this,Yc,pg).call(this,{highlightOutlines:o(this,pi).getNewOutline(e/2)}),this.fixAndSetPosition();const[i,n]=this.parentDimensions;this.setDims(this.width*i,this.height*n)},Kc=new WeakSet,gg=function(){o(this,Ce)===null||!this.parent||(this.parent.drawLayer.remove(o(this,Ce)),w(this,Ce,null),this.parent.drawLayer.remove(o(this,te)),w(this,te,null))},pr=new WeakSet,No=function(e=this.parent){o(this,Ce)===null&&({id:Be(this,Ce)._,clipPathId:Be(this,dr)._}=e.drawLayer.highlight(o(this,pi),this.color,o(this,fr)),w(this,te,e.drawLayer.highlightOutline(o(this,ti))),o(this,ur)&&(o(this,ur).style.clipPath=o(this,dr)))},is=new WeakSet,Wr=function({x:e,y:i,width:n,height:s},a){switch(a){case 90:return{x:1-i-s,y:e,width:s,height:n};case 180:return{x:1-e-n,y:1-i-s,width:n,height:s};case 270:return{x:i,y:1-e-n,width:s,height:n}}return{x:e,y:i,width:n,height:s}},Nu=new WeakSet,Db=function(e){At._keyboardManager.exec(this,e)},ao=new WeakSet,nd=function(e){if(!o(this,io))return;const i=window.getSelection();e?i.setPosition(o(this,io),o(this,Gc)):i.setPosition(o(this,Vc),o(this,Wc))},gr=new WeakSet,Bo=function(){return o(this,Ve)?this.rotation:0},Bu=new WeakSet,Ob=function(){if(o(this,Ve))return null;const[e,i]=this.pageDimensions,n=o(this,es),s=new Array(n.length*8);let a=0;for(const{x:l,y:c,width:d,height:h}of n){const p=l*e,g=(1-c-h)*i;s[a]=s[a+4]=p,s[a+1]=s[a+3]=g,s[a+2]=s[a+6]=p+d*e,s[a+5]=s[a+7]=g+h*i,a+=8}return s},$u=new WeakSet,Nb=function(e){return o(this,pi).serialize(e,A(this,gr,Bo).call(this))},ju=new WeakSet,Bb=function(e,i){this._freeHighlight.add(i)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},Uu=new WeakSet,$b=function(e,i){this._freeHighlight.isEmpty()?e.drawLayer.removeFreeHighlight(this._freeHighlightId):e.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},m(At,is),m(At,ju),m(At,Uu),ct(At,"_defaultColor",null),ct(At,"_defaultOpacity",1),ct(At,"_defaultThickness",12),ct(At,"_l10nPromise"),ct(At,"_type","highlight"),ct(At,"_editorType",yt.HIGHLIGHT),ct(At,"_freeHighlightId",-1),ct(At,"_freeHighlight",null),ct(At,"_freeHighlightClipId","");let _d=At;var mr,vr,Zc,Jc,Qc,br,Di,wn,ei,yr,wr,Ar,Er,_r,ns,Hu,jb,zu,Ub,Gu,Hb,Vu,zb,th,vg,Wu,Gb,eh,bg,qu,Vb,Xu,Wb,Yu,qb,Ku,Xb,Zu,Yb,An,ys,ih,yg,oo,sd,lo,rd,ss,qr,nh,wg,co,ad,Ju,Kb,sh,Ag,Qu,Zb,tf,Jb,rh,Eg,ho,od,xr,$o;const Bt=class Bt extends Lt{constructor(e){super({...e,name:"inkEditor"});m(this,Hu);m(this,zu);m(this,Gu);m(this,Vu);m(this,th);m(this,Wu);m(this,eh);m(this,qu);m(this,Xu);m(this,Yu);m(this,Ku);m(this,Zu);m(this,An);m(this,ih);m(this,oo);m(this,lo);m(this,ss);m(this,nh);m(this,co);m(this,tf);m(this,rh);m(this,ho);m(this,xr);m(this,mr,0);m(this,vr,0);m(this,Zc,this.canvasPointermove.bind(this));m(this,Jc,this.canvasPointerleave.bind(this));m(this,Qc,this.canvasPointerup.bind(this));m(this,br,this.canvasPointerdown.bind(this));m(this,Di,null);m(this,wn,new Path2D);m(this,ei,!1);m(this,yr,!1);m(this,wr,!1);m(this,Ar,null);m(this,Er,0);m(this,_r,0);m(this,ns,null);this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,i){Lt.initialize(e,i)}static updateDefaultParams(e,i){switch(e){case lt.INK_THICKNESS:Bt._defaultThickness=i;break;case lt.INK_COLOR:Bt._defaultColor=i;break;case lt.INK_OPACITY:Bt._defaultOpacity=i/100;break}}updateParams(e,i){switch(e){case lt.INK_THICKNESS:A(this,Hu,jb).call(this,i);break;case lt.INK_COLOR:A(this,zu,Ub).call(this,i);break;case lt.INK_OPACITY:A(this,Gu,Hb).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[lt.INK_THICKNESS,Bt._defaultThickness],[lt.INK_COLOR,Bt._defaultColor||Lt._defaultLineColor],[lt.INK_OPACITY,Math.round(Bt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[lt.INK_THICKNESS,this.thickness||Bt._defaultThickness],[lt.INK_COLOR,this.color||Bt._defaultColor||Lt._defaultLineColor],[lt.INK_OPACITY,Math.round(100*(this.opacity??Bt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(A(this,oo,sd).call(this),A(this,lo,rd).call(this)),this.isAttachedToDOM||(this.parent.add(this),A(this,ss,qr).call(this)),A(this,xr,$o).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,o(this,Di)&&(clearTimeout(o(this,Di)),w(this,Di,null)),o(this,Ar).disconnect(),w(this,Ar,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,i]=this.parentDimensions,n=this.width*e,s=this.height*i;this.setDimensions(n,s)}enableEditMode(){o(this,ei)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",o(this,br)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",o(this,br)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){o(this,ei)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),w(this,ei,!0),this.div.classList.add("disabled"),A(this,xr,$o).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||o(this,ei)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),A(this,Wu,Gb).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),A(this,eh,bg).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),A(this,ih,yg).call(this,e)}canvasPointerleave(e){A(this,ih,yg).call(this,e)}get isResizable(){return!this.isEmpty()&&o(this,ei)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[n,s,a,l]=A(this,Vu,zb).call(this);if(this.setAt(n,s,0,0),this.setDims(a,l),A(this,oo,sd).call(this),this.width){const[c,d]=this.parentDimensions;this.setAspectRatio(this.width*c,this.height*d),this.setAt(e*c,i*d,this.width*c,this.height*d),w(this,wr,!0),A(this,ss,qr).call(this),this.setDims(this.width*c,this.height*d),A(this,An,ys).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return A(this,lo,rd).call(this),this.div}setDimensions(e,i){const n=Math.round(e),s=Math.round(i);if(o(this,Er)===n&&o(this,_r)===s)return;w(this,Er,n),w(this,_r,s),this.canvas.style.visibility="hidden";const[a,l]=this.parentDimensions;this.width=e/a,this.height=i/l,this.fixAndSetPosition(),o(this,ei)&&A(this,nh,wg).call(this,e,i),A(this,ss,qr).call(this),A(this,An,ys).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(e,i,n){var C,_,R;if(e instanceof vb)return null;const s=super.deserialize(e,i,n);s.thickness=e.thickness,s.color=J.makeHexColor(...e.color),s.opacity=e.opacity;const[a,l]=s.pageDimensions,c=s.width*a,d=s.height*l,h=s.parentScale,p=e.thickness/2;w(s,ei,!0),w(s,Er,Math.round(c)),w(s,_r,Math.round(d));const{paths:g,rect:v,rotation:b}=e;for(let{bezier:L}of g){L=A(C=Bt,Qu,Zb).call(C,L,v,b);const D=[];s.paths.push(D);let O=h*(L[0]-p),N=h*(L[1]-p);for(let S=2,T=L.length;S<T;S+=6){const F=h*(L[S]-p),k=h*(L[S+1]-p),U=h*(L[S+2]-p),H=h*(L[S+3]-p),G=h*(L[S+4]-p),K=h*(L[S+5]-p);D.push([[O,N],[F,k],[U,H],[G,K]]),O=G,N=K}const j=A(this,Ju,Kb).call(this,D);s.bezierPath2D.push(j)}const E=A(_=s,rh,Eg).call(_);return w(s,vr,Math.max(Lt.MIN_SIZE,E[2]-E[0])),w(s,mr,Math.max(Lt.MIN_SIZE,E[3]-E[1])),A(R=s,nh,wg).call(R,c,d),s}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),i=Lt._colorManager.convert(this.ctx.strokeStyle);return{annotationType:yt.INK,color:i,thickness:this.thickness,opacity:this.opacity,paths:A(this,tf,Jb).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};mr=new WeakMap,vr=new WeakMap,Zc=new WeakMap,Jc=new WeakMap,Qc=new WeakMap,br=new WeakMap,Di=new WeakMap,wn=new WeakMap,ei=new WeakMap,yr=new WeakMap,wr=new WeakMap,Ar=new WeakMap,Er=new WeakMap,_r=new WeakMap,ns=new WeakMap,Hu=new WeakSet,jb=function(e){const i=s=>{this.thickness=s,A(this,xr,$o).call(this)},n=this.thickness;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},zu=new WeakSet,Ub=function(e){const i=s=>{this.color=s,A(this,An,ys).call(this)},n=this.color;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Gu=new WeakSet,Hb=function(e){const i=s=>{this.opacity=s,A(this,An,ys).call(this)};e/=100;const n=this.opacity;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Vu=new WeakSet,zb=function(){const{parentRotation:e,parentDimensions:[i,n]}=this;switch(e){case 90:return[0,n,n,i];case 180:return[i,n,i,n];case 270:return[i,0,n,i];default:return[0,0,i,n]}},th=new WeakSet,vg=function(){const{ctx:e,color:i,opacity:n,thickness:s,parentScale:a,scaleFactor:l}=this;e.lineWidth=s*a/l,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${i}${_C(n)}`},Wu=new WeakSet,Gb=function(e,i){this.canvas.addEventListener("contextmenu",Ne),this.canvas.addEventListener("pointerleave",o(this,Jc)),this.canvas.addEventListener("pointermove",o(this,Zc)),this.canvas.addEventListener("pointerup",o(this,Qc)),this.canvas.removeEventListener("pointerdown",o(this,br)),this.isEditing=!0,o(this,wr)||(w(this,wr,!0),A(this,ss,qr).call(this),this.thickness||(this.thickness=Bt._defaultThickness),this.color||(this.color=Bt._defaultColor||Lt._defaultLineColor),this.opacity??(this.opacity=Bt._defaultOpacity)),this.currentPath.push([e,i]),w(this,yr,!1),A(this,th,vg).call(this),w(this,ns,()=>{A(this,Yu,qb).call(this),o(this,ns)&&window.requestAnimationFrame(o(this,ns))}),window.requestAnimationFrame(o(this,ns))},eh=new WeakSet,bg=function(e,i){const[n,s]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===n&&i===s)return;const a=this.currentPath;let l=o(this,wn);if(a.push([e,i]),w(this,yr,!0),a.length<=2){l.moveTo(...a[0]),l.lineTo(e,i);return}a.length===3&&(w(this,wn,l=new Path2D),l.moveTo(...a[0])),A(this,Ku,Xb).call(this,l,...a.at(-3),...a.at(-2),e,i)},qu=new WeakSet,Vb=function(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);o(this,wn).lineTo(...e)},Xu=new WeakSet,Wb=function(e,i){w(this,ns,null),e=Math.min(Math.max(e,0),this.canvas.width),i=Math.min(Math.max(i,0),this.canvas.height),A(this,eh,bg).call(this,e,i),A(this,qu,Vb).call(this);let n;if(this.currentPath.length!==1)n=A(this,Zu,Yb).call(this);else{const d=[e,i];n=[[d,d.slice(),d.slice(),d]]}const s=o(this,wn),a=this.currentPath;this.currentPath=[],w(this,wn,new Path2D);const l=()=>{this.allRawPaths.push(a),this.paths.push(n),this.bezierPath2D.push(s),this._uiManager.rebuild(this)},c=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(A(this,oo,sd).call(this),A(this,lo,rd).call(this)),A(this,xr,$o).call(this))};this.addCommands({cmd:l,undo:c,mustExec:!0})},Yu=new WeakSet,qb=function(){if(!o(this,yr))return;w(this,yr,!1);const e=Math.ceil(this.thickness*this.parentScale),i=this.currentPath.slice(-3),n=i.map(l=>l[0]),s=i.map(l=>l[1]);Math.min(...n)-e,Math.max(...n)+e,Math.min(...s)-e,Math.max(...s)+e;const{ctx:a}=this;a.save(),a.clearRect(0,0,this.canvas.width,this.canvas.height);for(const l of this.bezierPath2D)a.stroke(l);a.stroke(o(this,wn)),a.restore()},Ku=new WeakSet,Xb=function(e,i,n,s,a,l,c){const d=(i+s)/2,h=(n+a)/2,p=(s+l)/2,g=(a+c)/2;e.bezierCurveTo(d+2*(s-d)/3,h+2*(a-h)/3,p+2*(s-p)/3,g+2*(a-g)/3,p,g)},Zu=new WeakSet,Yb=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const i=[];let n,[s,a]=e[0];for(n=1;n<e.length-2;n++){const[v,b]=e[n],[E,C]=e[n+1],_=(v+E)/2,R=(b+C)/2,L=[s+2*(v-s)/3,a+2*(b-a)/3],D=[_+2*(v-_)/3,R+2*(b-R)/3];i.push([[s,a],L,D,[_,R]]),[s,a]=[_,R]}const[l,c]=e[n],[d,h]=e[n+1],p=[s+2*(l-s)/3,a+2*(c-a)/3],g=[d+2*(l-d)/3,h+2*(c-h)/3];return i.push([[s,a],p,g,[d,h]]),i},An=new WeakSet,ys=function(){if(this.isEmpty()){A(this,co,ad).call(this);return}A(this,th,vg).call(this);const{canvas:e,ctx:i}=this;i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),A(this,co,ad).call(this);for(const n of this.bezierPath2D)i.stroke(n)},ih=new WeakSet,yg=function(e){this.canvas.removeEventListener("pointerleave",o(this,Jc)),this.canvas.removeEventListener("pointermove",o(this,Zc)),this.canvas.removeEventListener("pointerup",o(this,Qc)),this.canvas.addEventListener("pointerdown",o(this,br)),o(this,Di)&&clearTimeout(o(this,Di)),w(this,Di,setTimeout(()=>{w(this,Di,null),this.canvas.removeEventListener("contextmenu",Ne)},10)),A(this,Xu,Wb).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},oo=new WeakSet,sd=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},lo=new WeakSet,rd=function(){w(this,Ar,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&this.setDimensions(i.width,i.height)})),o(this,Ar).observe(this.div)},ss=new WeakSet,qr=function(){if(!o(this,wr))return;const[e,i]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*i),A(this,co,ad).call(this)},nh=new WeakSet,wg=function(e,i){const n=A(this,ho,od).call(this),s=(e-n)/o(this,vr),a=(i-n)/o(this,mr);this.scaleFactor=Math.min(s,a)},co=new WeakSet,ad=function(){const e=A(this,ho,od).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},Ju=new WeakSet,Kb=function(e){const i=new Path2D;for(let n=0,s=e.length;n<s;n++){const[a,l,c,d]=e[n];n===0&&i.moveTo(...a),i.bezierCurveTo(l[0],l[1],c[0],c[1],d[0],d[1])}return i},sh=new WeakSet,Ag=function(e,i,n){const[s,a,l,c]=i;switch(n){case 0:for(let d=0,h=e.length;d<h;d+=2)e[d]+=s,e[d+1]=c-e[d+1];break;case 90:for(let d=0,h=e.length;d<h;d+=2){const p=e[d];e[d]=e[d+1]+s,e[d+1]=p+a}break;case 180:for(let d=0,h=e.length;d<h;d+=2)e[d]=l-e[d],e[d+1]+=a;break;case 270:for(let d=0,h=e.length;d<h;d+=2){const p=e[d];e[d]=l-e[d+1],e[d+1]=c-p}break;default:throw new Error("Invalid rotation")}return e},Qu=new WeakSet,Zb=function(e,i,n){const[s,a,l,c]=i;switch(n){case 0:for(let d=0,h=e.length;d<h;d+=2)e[d]-=s,e[d+1]=c-e[d+1];break;case 90:for(let d=0,h=e.length;d<h;d+=2){const p=e[d];e[d]=e[d+1]-a,e[d+1]=p-s}break;case 180:for(let d=0,h=e.length;d<h;d+=2)e[d]=l-e[d],e[d+1]-=a;break;case 270:for(let d=0,h=e.length;d<h;d+=2){const p=e[d];e[d]=c-e[d+1],e[d+1]=l-p}break;default:throw new Error("Invalid rotation")}return e},tf=new WeakSet,Jb=function(e,i,n,s){var h,p;const a=[],l=this.thickness/2,c=e*i+l,d=e*n+l;for(const g of this.paths){const v=[],b=[];for(let E=0,C=g.length;E<C;E++){const[_,R,L,D]=g[E];if(_[0]===D[0]&&_[1]===D[1]&&C===1){const H=e*_[0]+c,G=e*_[1]+d;v.push(H,G),b.push(H,G);break}const O=e*_[0]+c,N=e*_[1]+d,j=e*R[0]+c,S=e*R[1]+d,T=e*L[0]+c,F=e*L[1]+d,k=e*D[0]+c,U=e*D[1]+d;E===0&&(v.push(O,N),b.push(O,N)),v.push(j,S,T,F,k,U),b.push(j,S),E===C-1&&b.push(k,U)}a.push({bezier:A(h=Bt,sh,Ag).call(h,v,s,this.rotation),points:A(p=Bt,sh,Ag).call(p,b,s,this.rotation)})}return a},rh=new WeakSet,Eg=function(){let e=1/0,i=-1/0,n=1/0,s=-1/0;for(const a of this.paths)for(const[l,c,d,h]of a){const p=J.bezierBoundingBox(...l,...c,...d,...h);e=Math.min(e,p[0]),n=Math.min(n,p[1]),i=Math.max(i,p[2]),s=Math.max(s,p[3])}return[e,n,i,s]},ho=new WeakSet,od=function(){return o(this,ei)?Math.ceil(this.thickness*this.parentScale):0},xr=new WeakSet,$o=function(e=!1){if(this.isEmpty())return;if(!o(this,ei)){A(this,An,ys).call(this);return}const i=A(this,rh,Eg).call(this),n=A(this,ho,od).call(this);w(this,vr,Math.max(Lt.MIN_SIZE,i[2]-i[0])),w(this,mr,Math.max(Lt.MIN_SIZE,i[3]-i[1]));const s=Math.ceil(n+o(this,vr)*this.scaleFactor),a=Math.ceil(n+o(this,mr)*this.scaleFactor),[l,c]=this.parentDimensions;this.width=s/l,this.height=a/c,this.setAspectRatio(s,a);const d=this.translationX,h=this.translationY;this.translationX=-i[0],this.translationY=-i[1],A(this,ss,qr).call(this),A(this,An,ys).call(this),w(this,Er,s),w(this,_r,a),this.setDims(s,a);const p=e?n/this.scaleFactor/2:0;this.translate(d-this.translationX-p,h-this.translationY-p)},m(Bt,Ju),m(Bt,sh),m(Bt,Qu),ct(Bt,"_defaultColor",null),ct(Bt,"_defaultOpacity",1),ct(Bt,"_defaultThickness",1),ct(Bt,"_type","ink"),ct(Bt,"_editorType",yt.INK);let mg=Bt;var ge,me,rs,En,as,uo,Oi,Sr,Ni,gi,ah,Cr,jo,Tr,Uo,fo,ld,oh,xg,ef,Qb,nf,ty,lh,Sg,po,cd,sf,ey;const Go=class Go extends Lt{constructor(e){super({...e,name:"stampEditor"});m(this,Cr);m(this,Tr);m(this,fo);m(this,oh);m(this,ef);m(this,nf);m(this,lh);m(this,po);m(this,sf);m(this,ge,null);m(this,me,null);m(this,rs,null);m(this,En,null);m(this,as,null);m(this,uo,"");m(this,Oi,null);m(this,Sr,null);m(this,Ni,null);m(this,gi,!1);m(this,ah,!1);w(this,En,e.bitmapUrl),w(this,as,e.bitmapFile)}static initialize(e,i){Lt.initialize(e,i)}static get supportedTypes(){return Et(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return Et(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,i){i.pasteEditor(yt.STAMP,{bitmapFile:e.getAsFile()})}remove(){var e,i;o(this,me)&&(w(this,ge,null),this._uiManager.imageManager.deleteId(o(this,me)),(e=o(this,Oi))==null||e.remove(),w(this,Oi,null),(i=o(this,Sr))==null||i.disconnect(),w(this,Sr,null),o(this,Ni)&&(clearTimeout(o(this,Ni)),w(this,Ni,null))),super.remove()}rebuild(){if(!this.parent){o(this,me)&&A(this,fo,ld).call(this);return}super.rebuild(),this.div!==null&&(o(this,me)&&o(this,Oi)===null&&A(this,fo,ld).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(o(this,rs)||o(this,ge)||o(this,En)||o(this,as)||o(this,me))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,i;if(this.width&&(e=this.x,i=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),o(this,ge)?A(this,oh,xg).call(this):A(this,fo,ld).call(this),this.width){const[n,s]=this.parentDimensions;this.setAt(e*n,i*s,this.width*n,this.height*s)}return this.div}getImageForAltText(){return o(this,Oi)}static deserialize(e,i,n){if(e instanceof bb)return null;const s=super.deserialize(e,i,n),{rect:a,bitmapUrl:l,bitmapId:c,isSvg:d,accessibilityData:h}=e;c&&n.imageManager.isValidId(c)?w(s,me,c):w(s,En,l),w(s,gi,d);const[p,g]=s.pageDimensions;return s.width=(a[2]-a[0])/p,s.height=(a[3]-a[1])/g,h&&(s.altTextData=h),s}serialize(e=!1,i=null){if(this.isEmpty())return null;const n={annotationType:yt.STAMP,bitmapId:o(this,me),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:o(this,gi),structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=A(this,po,cd).call(this,!0),n.accessibilityData=this.altTextData,n;const{decorative:s,altText:a}=this.altTextData;if(!s&&a&&(n.accessibilityData={type:"Figure",alt:a}),i===null)return n;i.stamps||(i.stamps=new Map);const l=o(this,gi)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!i.stamps.has(o(this,me)))i.stamps.set(o(this,me),{area:l,serialized:n}),n.bitmap=A(this,po,cd).call(this,!1);else if(o(this,gi)){const c=i.stamps.get(o(this,me));l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=A(this,po,cd).call(this,!1))}return n}};ge=new WeakMap,me=new WeakMap,rs=new WeakMap,En=new WeakMap,as=new WeakMap,uo=new WeakMap,Oi=new WeakMap,Sr=new WeakMap,Ni=new WeakMap,gi=new WeakMap,ah=new WeakMap,Cr=new WeakSet,jo=function(e,i=!1){if(!e){this.remove();return}w(this,ge,e.bitmap),i||(w(this,me,e.id),w(this,gi,e.isSvg)),e.file&&w(this,uo,e.file.name),A(this,oh,xg).call(this)},Tr=new WeakSet,Uo=function(){w(this,rs,null),this._uiManager.enableWaiting(!1),o(this,Oi)&&this.div.focus()},fo=new WeakSet,ld=function(){if(o(this,me)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(o(this,me)).then(i=>A(this,Cr,jo).call(this,i,!0)).finally(()=>A(this,Tr,Uo).call(this));return}if(o(this,En)){const i=o(this,En);w(this,En,null),this._uiManager.enableWaiting(!0),w(this,rs,this._uiManager.imageManager.getFromUrl(i).then(n=>A(this,Cr,jo).call(this,n)).finally(()=>A(this,Tr,Uo).call(this)));return}if(o(this,as)){const i=o(this,as);w(this,as,null),this._uiManager.enableWaiting(!0),w(this,rs,this._uiManager.imageManager.getFromFile(i).then(n=>A(this,Cr,jo).call(this,n)).finally(()=>A(this,Tr,Uo).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Go.supportedTypesStr,w(this,rs,new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(e.files[0]);A(this,Cr,jo).call(this,n)}i()}),e.addEventListener("cancel",()=>{this.remove(),i()})}).finally(()=>A(this,Tr,Uo).call(this))),e.click()},oh=new WeakSet,xg=function(){const{div:e}=this;let{width:i,height:n}=o(this,ge);const[s,a]=this.pageDimensions,l=.75;if(this.width)i=this.width*s,n=this.height*a;else if(i>l*s||n>l*a){const p=Math.min(l*s/i,l*a/n);i*=p,n*=p}const[c,d]=this.parentDimensions;this.setDims(i*c/s,n*d/a),this._uiManager.enableWaiting(!1);const h=w(this,Oi,document.createElement("canvas"));e.append(h),e.hidden=!1,A(this,lh,Sg).call(this,i,n),A(this,sf,ey).call(this),o(this,ah)||(this.parent.addUndoableEditor(this),w(this,ah,!0)),this._reportTelemetry({action:"inserted_image"}),o(this,uo)&&h.setAttribute("aria-label",o(this,uo))},ef=new WeakSet,Qb=function(e,i){var l;const[n,s]=this.parentDimensions;this.width=e/n,this.height=i/s,this.setDims(e,i),(l=this._initialOptions)!=null&&l.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,o(this,Ni)!==null&&clearTimeout(o(this,Ni)),w(this,Ni,setTimeout(()=>{w(this,Ni,null),A(this,lh,Sg).call(this,e,i)},200))},nf=new WeakSet,ty=function(e,i){const{width:n,height:s}=o(this,ge);let a=n,l=s,c=o(this,ge);for(;a>2*e||l>2*i;){const d=a,h=l;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*i&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(a,l);p.getContext("2d").drawImage(c,0,0,d,h,0,0,a,l),c=p.transferToImageBitmap()}return c},lh=new WeakSet,Sg=function(e,i){e=Math.ceil(e),i=Math.ceil(i);const n=o(this,Oi);if(!n||n.width===e&&n.height===i)return;n.width=e,n.height=i;const s=o(this,gi)?o(this,ge):A(this,nf,ty).call(this,e,i);if(this._uiManager.hasMLManager&&!this.hasAltText()){const c=new OffscreenCanvas(e,i).getContext("2d");c.drawImage(s,0,0,s.width,s.height,0,0,e,i),this._uiManager.mlGuess({service:"image-to-text",request:{data:c.getImageData(0,0,e,i).data,width:e,height:i,channels:4}}).then(d=>{const h=(d==null?void 0:d.output)||"";this.parent&&h&&!this.hasAltText()&&(this.altTextData={altText:h,decorative:!1})})}const a=n.getContext("2d");a.filter=this._uiManager.hcmFilter,a.drawImage(s,0,0,s.width,s.height,0,0,e,i)},po=new WeakSet,cd=function(e){if(e){if(o(this,gi)){const s=this._uiManager.imageManager.getSvgUrl(o(this,me));if(s)return s}const i=document.createElement("canvas");return{width:i.width,height:i.height}=o(this,ge),i.getContext("2d").drawImage(o(this,ge),0,0),i.toDataURL()}if(o(this,gi)){const[i,n]=this.pageDimensions,s=Math.round(this.width*i*hs.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*hs.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,a);return l.getContext("2d").drawImage(o(this,ge),0,0,o(this,ge).width,o(this,ge).height,0,0,s,a),l.transferToImageBitmap()}return structuredClone(o(this,ge))},sf=new WeakSet,ey=function(){w(this,Sr,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&A(this,ef,Qb).call(this,i.width,i.height)})),o(this,Sr).observe(this.div)},ct(Go,"_type","stamp"),ct(Go,"_editorType",yt.STAMP);let _g=Go;var Pr,go,Bi,Rr,_n,xn,Sn,We,os,mo,vo,Te,st,ls,rf,iy,ch,Tg,hh,Pg,dh,Rg,bo,hd;const ni=class ni{constructor({uiManager:t,pageIndex:e,div:i,accessibilityManager:n,annotationLayer:s,drawLayer:a,textLayer:l,viewport:c,l10n:d}){m(this,rf);m(this,ch);m(this,hh);m(this,dh);m(this,bo);m(this,Pr,void 0);m(this,go,!1);m(this,Bi,null);m(this,Rr,null);m(this,_n,null);m(this,xn,null);m(this,Sn,null);m(this,We,new Map);m(this,os,!1);m(this,mo,!1);m(this,vo,!1);m(this,Te,null);m(this,st,void 0);const h=[...o(ni,ls).values()];if(!ni._initialized){ni._initialized=!0;for(const p of h)p.initialize(d,t)}t.registerEditorTypes(h),w(this,st,t),this.pageIndex=e,this.div=i,w(this,Pr,n),w(this,Bi,s),this.viewport=c,w(this,Te,l),this.drawLayer=a,o(this,st).addLayer(this)}get isEmpty(){return o(this,We).size===0}get isInvisible(){return this.isEmpty&&o(this,st).getMode()===yt.NONE}updateToolbar(t){o(this,st).updateToolbar(t)}updateMode(t=o(this,st).getMode()){switch(A(this,bo,hd).call(this),t){case yt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case yt.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case yt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of o(ni,ls).values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=o(this,Te))==null?void 0:e.div)}addInkEditorIfNeeded(t){if(o(this,st).getMode()!==yt.INK)return;if(!t){for(const i of o(this,We).values())if(i.isEmpty()){i.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){o(this,st).setEditingState(t)}addCommands(t){o(this,st).addCommands(t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=o(this,Bi))==null||e.div.classList.toggle("disabled",!t)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of o(this,We).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(o(this,st).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!o(this,Bi))return;const e=o(this,Bi).getEditableAnnotations();for(const i of e){if(i.hide(),o(this,st).isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const n=this.deserialize(i);n&&(this.addOrRebuild(n),n.enableEditing())}}disable(){var n;w(this,vo,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const s of o(this,We).values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else e.set(s.annotationElementId,s);(n=this.getEditableAnnotation(s.annotationElementId))==null||n.show(),s.remove()}if(o(this,Bi)){const s=o(this,Bi).getEditableAnnotations();for(const a of s){const{id:l}=a.data;if(o(this,st).isDeletedAnnotationElement(l))continue;let c=e.get(l);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=t.get(l),c&&(o(this,st).addChangedExistingAnnotation(c),c.renderAnnotationElement(a),c.show(!1)),a.show()}}A(this,bo,hd).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of o(ni,ls).values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),w(this,vo,!1)}getEditableAnnotation(t){var e;return((e=o(this,Bi))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){o(this,st).getActive()!==t&&o(this,st).setActiveEditor(t)}enableTextSelection(){var t;this.div.tabIndex=-1,(t=o(this,Te))!=null&&t.div&&!o(this,xn)&&(w(this,xn,A(this,rf,iy).bind(this)),o(this,Te).div.addEventListener("pointerdown",o(this,xn)),o(this,Te).div.classList.add("highlighting"))}disableTextSelection(){var t;this.div.tabIndex=0,(t=o(this,Te))!=null&&t.div&&o(this,xn)&&(o(this,Te).div.removeEventListener("pointerdown",o(this,xn)),w(this,xn,null),o(this,Te).div.classList.remove("highlighting"))}enableClick(){o(this,_n)||(w(this,_n,this.pointerdown.bind(this)),w(this,Rr,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",o(this,_n)),this.div.addEventListener("pointerup",o(this,Rr)))}disableClick(){o(this,_n)&&(this.div.removeEventListener("pointerdown",o(this,_n)),this.div.removeEventListener("pointerup",o(this,Rr)),w(this,_n,null),w(this,Rr,null))}attach(t){o(this,We).set(t.id,t);const{annotationElementId:e}=t;e&&o(this,st).isDeletedAnnotationElement(e)&&o(this,st).removeDeletedAnnotationElement(t)}detach(t){var e;o(this,We).delete(t.id),(e=o(this,Pr))==null||e.removePointerInTextLayer(t.contentDiv),!o(this,vo)&&t.annotationElementId&&o(this,st).addDeletedAnnotationElement(t)}remove(t){this.detach(t),o(this,st).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,o(this,mo)||this.addInkEditorIfNeeded(!1)}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(o(this,st).addDeletedAnnotationElement(t.annotationElementId),Lt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),o(this,st).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),o(this,st).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var i;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!o(this,Sn)&&(t._focusEventsAllowed=!1,w(this,Sn,setTimeout(()=>{w(this,Sn,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0}),e.focus())},0))),t._structTreeParentId=(i=o(this,Pr))==null?void 0:i.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return o(this,st).getId()}canCreateNewEmptyEditor(){var t;return(t=o(this,ch,Tg))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){o(this,st).updateToolbar(t),o(this,st).updateMode(t);const{offsetX:i,offsetY:n}=A(this,dh,Rg).call(this),s=this.getNextId(),a=A(this,hh,Pg).call(this,{parent:this,id:s,x:i,y:n,uiManager:o(this,st),isCentered:!0,...e});a&&this.add(a)}deserialize(t){var e;return((e=o(ni,ls).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,o(this,st)))||null}createAndAddNewEditor(t,e,i={}){const n=this.getNextId(),s=A(this,hh,Pg).call(this,{parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:o(this,st),isCentered:e,...i});return s&&this.add(s),s}addNewEditor(){this.createAndAddNewEditor(A(this,dh,Rg).call(this),!0)}setSelected(t){o(this,st).setSelected(t)}toggleSelected(t){o(this,st).toggleSelected(t)}isSelected(t){return o(this,st).isSelected(t)}unselect(t){o(this,st).unselect(t)}pointerup(t){const{isMac:e}=Oe.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&o(this,os)){if(w(this,os,!1),!o(this,go)){w(this,go,!0);return}if(o(this,st).getMode()===yt.STAMP){o(this,st).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(o(this,st).getMode()===yt.HIGHLIGHT&&this.enableTextSelection(),o(this,os)){w(this,os,!1);return}const{isMac:e}=Oe.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;w(this,os,!0);const i=o(this,st).getActive();w(this,go,!i||i.isEmpty())}findNewParent(t,e,i){const n=o(this,st).findParent(e,i);return n===null||n===this?!1:(n.changeParent(t),!0)}destroy(){var t,e;((t=o(this,st).getActive())==null?void 0:t.parent)===this&&(o(this,st).commitOrRemove(),o(this,st).setActiveEditor(null)),o(this,Sn)&&(clearTimeout(o(this,Sn)),w(this,Sn,null));for(const i of o(this,We).values())(e=o(this,Pr))==null||e.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,o(this,We).clear(),o(this,st).removeLayer(this)}render({viewport:t}){this.viewport=t,Lr(this.div,t);for(const e of o(this,st).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){o(this,st).commitOrRemove(),A(this,bo,hd).call(this);const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Lr(this.div,{rotation:i}),e!==i)for(const n of o(this,We).values())n.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return o(this,st).viewParameters.realScale}};Pr=new WeakMap,go=new WeakMap,Bi=new WeakMap,Rr=new WeakMap,_n=new WeakMap,xn=new WeakMap,Sn=new WeakMap,We=new WeakMap,os=new WeakMap,mo=new WeakMap,vo=new WeakMap,Te=new WeakMap,st=new WeakMap,ls=new WeakMap,rf=new WeakSet,iy=function(t){if(o(this,st).unselectAll(),t.target===o(this,Te).div){const{isMac:e}=Oe.platform;if(t.button!==0||t.ctrlKey&&e)return;o(this,st).showAllEditors("highlight",!0,!0),o(this,Te).div.classList.add("free"),_d.startHighlighting(this,o(this,st).direction==="ltr",t),o(this,Te).div.addEventListener("pointerup",()=>{o(this,Te).div.classList.remove("free")},{once:!0}),t.preventDefault()}},ch=new WeakSet,Tg=function(){return o(ni,ls).get(o(this,st).getMode())},hh=new WeakSet,Pg=function(t){const e=o(this,ch,Tg);return e?new e.prototype.constructor(t):null},dh=new WeakSet,Rg=function(){const{x:t,y:e,width:i,height:n}=this.div.getBoundingClientRect(),s=Math.max(0,t),a=Math.max(0,e),l=Math.min(window.innerWidth,t+i),c=Math.min(window.innerHeight,e+n),d=(s+l)/2-t,h=(a+c)/2-e,[p,g]=this.viewport.rotation%180===0?[d,h]:[h,d];return{offsetX:p,offsetY:g}},bo=new WeakSet,hd=function(){w(this,mo,!0);for(const t of o(this,We).values())t.isEmpty()&&t.remove();w(this,mo,!1)},ct(ni,"_initialized",!1),m(ni,ls,new Map([rg,mg,_g,_d].map(t=>[t._editorType,t])));let Cg=ni;var $i,uh,ee,cs,fh,kg,ph,Ig,af,ny;const ce=class ce{constructor({pageIndex:t}){m(this,ph);m(this,af);m(this,$i,null);m(this,uh,0);m(this,ee,new Map);m(this,cs,new Map);this.pageIndex=t}setParent(t){if(!o(this,$i)){w(this,$i,t);return}if(o(this,$i)!==t){if(o(this,ee).size>0)for(const e of o(this,ee).values())e.remove(),t.append(e);w(this,$i,t)}}static get _svgFactory(){return Et(this,"_svgFactory",new Jg)}highlight(t,e,i,n=!1){const s=Be(this,uh)._++,a=A(this,ph,Ig).call(this,t.box);a.classList.add("highlight"),t.free&&a.classList.add("free");const l=ce._svgFactory.createElement("defs");a.append(l);const c=ce._svgFactory.createElement("path");l.append(c);const d=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",d),c.setAttribute("d",t.toSVGPath()),n&&o(this,cs).set(s,c);const h=A(this,af,ny).call(this,l,d),p=ce._svgFactory.createElement("use");return a.append(p),a.setAttribute("fill",e),a.setAttribute("fill-opacity",i),p.setAttribute("href",`#${d}`),o(this,ee).set(s,a),{id:s,clipPathId:`url(#${h})`}}highlightOutline(t){const e=Be(this,uh)._++,i=A(this,ph,Ig).call(this,t.box);i.classList.add("highlightOutline");const n=ce._svgFactory.createElement("defs");i.append(n);const s=ce._svgFactory.createElement("path");n.append(s);const a=`path_p${this.pageIndex}_${e}`;s.setAttribute("id",a),s.setAttribute("d",t.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke");let l;if(t.free){i.classList.add("free");const h=ce._svgFactory.createElement("mask");n.append(h),l=`mask_p${this.pageIndex}_${e}`,h.setAttribute("id",l),h.setAttribute("maskUnits","objectBoundingBox");const p=ce._svgFactory.createElement("rect");h.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const g=ce._svgFactory.createElement("use");h.append(g),g.setAttribute("href",`#${a}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const c=ce._svgFactory.createElement("use");i.append(c),c.setAttribute("href",`#${a}`),l&&c.setAttribute("mask",`url(#${l})`);const d=c.cloneNode();return i.append(d),c.classList.add("mainOutline"),d.classList.add("secondaryOutline"),o(this,ee).set(e,i),e}finalizeLine(t,e){const i=o(this,cs).get(t);o(this,cs).delete(t),this.updateBox(t,e.box),i.setAttribute("d",e.toSVGPath())}updateLine(t,e){o(this,ee).get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}removeFreeHighlight(t){this.remove(t),o(this,cs).delete(t)}updatePath(t,e){o(this,cs).get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){var i;A(i=ce,fh,kg).call(i,o(this,ee).get(t),e)}show(t,e){o(this,ee).get(t).classList.toggle("hidden",!e)}rotate(t,e){o(this,ee).get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){o(this,ee).get(t).setAttribute("fill",e)}changeOpacity(t,e){o(this,ee).get(t).setAttribute("fill-opacity",e)}addClass(t,e){o(this,ee).get(t).classList.add(e)}removeClass(t,e){o(this,ee).get(t).classList.remove(e)}remove(t){o(this,$i)!==null&&(o(this,ee).get(t).remove(),o(this,ee).delete(t))}destroy(){w(this,$i,null);for(const t of o(this,ee).values())t.remove();o(this,ee).clear()}};$i=new WeakMap,uh=new WeakMap,ee=new WeakMap,cs=new WeakMap,fh=new WeakSet,kg=function(t,{x:e=0,y:i=0,width:n=1,height:s=1}={}){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*n}%`,a.height=`${100*s}%`},ph=new WeakSet,Ig=function(t){var i;const e=ce._svgFactory.create(1,1,!0);return o(this,$i).append(e),e.setAttribute("aria-hidden",!0),A(i=ce,fh,kg).call(i,e,t),e},af=new WeakSet,ny=function(t,e){const i=ce._svgFactory.createElement("clipPath");t.append(i);const n=`clip_${e}`;i.setAttribute("id",n),i.setAttribute("clipPathUnits","objectBoundingBox");const s=ce._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),n},m(ce,fh);let Lg=ce;var tP=rt.AbortException,eP=rt.AnnotationEditorLayer,iP=rt.AnnotationEditorParamsType,nP=rt.AnnotationEditorType,sP=rt.AnnotationEditorUIManager,sy=rt.AnnotationLayer,ry=rt.AnnotationMode,rP=rt.CMapCompressionType,aP=rt.ColorPicker,oP=rt.DOMSVGFactory,lP=rt.DrawLayer,cP=rt.FeatureTest,am=rt.GlobalWorkerOptions,hP=rt.ImageKind,dP=rt.InvalidPDFException,uP=rt.MissingPDFException,fP=rt.OPS,pP=rt.Outliner,gP=rt.PDFDataRangeTransport,mP=rt.PDFDateString,vP=rt.PDFWorker,bP=rt.PasswordResponses,yP=rt.PermissionFlag,wP=rt.PixelsPerInch,AP=rt.RenderingCancelledException,ay=rt.TextLayer,EP=rt.UnexpectedResponseException,_P=rt.Util,xP=rt.VerbosityLevel,SP=rt.XfaLayer,CP=rt.build,TP=rt.createValidAbsoluteUrl,PP=rt.fetchData,oy=rt.getDocument,RP=rt.getFilenameFromUrl,LP=rt.getPdfFilenameFromUrl,kP=rt.getXfaPageViewport,IP=rt.isDataScheme,FP=rt.isPdfFile,MP=rt.noContextMenu,DP=rt.normalizeUnicode,OP=rt.renderTextLayer,NP=rt.setLayerDimensions,BP=rt.shadow,$P=rt.updateTextLayer,ly=rt.version;const jP=Object.freeze(Object.defineProperty({__proto__:null,AbortException:tP,AnnotationEditorLayer:eP,AnnotationEditorParamsType:iP,AnnotationEditorType:nP,AnnotationEditorUIManager:sP,AnnotationLayer:sy,AnnotationMode:ry,CMapCompressionType:rP,ColorPicker:aP,DOMSVGFactory:oP,DrawLayer:lP,FeatureTest:cP,GlobalWorkerOptions:am,ImageKind:hP,InvalidPDFException:dP,MissingPDFException:uP,OPS:fP,Outliner:pP,PDFDataRangeTransport:gP,PDFDateString:mP,PDFWorker:vP,PasswordResponses:bP,PermissionFlag:yP,PixelsPerInch:wP,RenderingCancelledException:AP,TextLayer:ay,UnexpectedResponseException:EP,Util:_P,VerbosityLevel:xP,XfaLayer:SP,build:CP,createValidAbsoluteUrl:TP,fetchData:PP,getDocument:oy,getFilenameFromUrl:RP,getPdfFilenameFromUrl:LP,getXfaPageViewport:kP,isDataScheme:IP,isPdfFile:FP,noContextMenu:MP,normalizeUnicode:DP,renderTextLayer:OP,setLayerDimensions:NP,shadow:BP,updateTextLayer:$P,version:ly},Symbol.toStringTag,{value:"Module"}));var re=function(r,t,e){if(e||arguments.length===2)for(var i=0,n=t.length,s;i<n;i++)(s||!(i in t))&&(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return r.concat(s||Array.prototype.slice.call(t))},UP=["onCopy","onCut","onPaste"],HP=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],zP=["onFocus","onBlur"],GP=["onInput","onInvalid","onReset","onSubmit"],VP=["onLoad","onError"],WP=["onKeyDown","onKeyPress","onKeyUp"],qP=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],XP=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],YP=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],KP=["onSelect"],ZP=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],JP=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],QP=["onScroll"],tR=["onWheel"],eR=["onAnimationStart","onAnimationEnd","onAnimationIteration"],iR=["onTransitionEnd"],nR=["onToggle"],sR=["onChange"],rR=re(re(re(re(re(re(re(re(re(re(re(re(re(re(re(re(re(re([],UP,!0),HP,!0),zP,!0),GP,!0),VP,!0),WP,!0),qP,!0),XP,!0),YP,!0),KP,!0),ZP,!0),JP,!0),QP,!0),tR,!0),eR,!0),iR,!0),sR,!0),nR,!0);function cy(r,t){var e={};return rR.forEach(function(i){var n=r[i];n&&(t?e[i]=function(s){return n(s,t(i))}:e[i]=n)}),e}function xh(r){var t=!1,e=new Promise(function(i,n){r.then(function(s){return!t&&i(s)}).catch(function(s){return!t&&n(s)})});return{promise:e,cancel:function(){t=!0}}}function hy(r){var t,e,i="";if(typeof r=="string"||typeof r=="number")i+=r;else if(typeof r=="object")if(Array.isArray(r))for(t=0;t<r.length;t++)r[t]&&(e=hy(r[t]))&&(i&&(i+=" "),i+=e);else for(t in r)r[t]&&(i&&(i+=" "),i+=t);return i}function xf(){for(var r,t,e=0,i="";e<arguments.length;)(r=arguments[e++])&&(t=hy(r))&&(i&&(i+=" "),i+=t);return i}var aR=Ki.env.NODE_ENV==="production",sp="Invariant failed";function Ot(r,t){if(!r){if(aR)throw new Error(sp);var e=typeof t=="function"?t():t,i=e?"".concat(sp,": ").concat(e):sp;throw new Error(i)}}var oR=Ki.env.NODE_ENV!=="production",dy=function(){};if(oR){var lR=function(t,e){var i=arguments.length;e=new Array(i>1?i-1:0);for(var n=1;n<i;n++)e[n-1]=arguments[n];var s=0,a="Warning: "+t.replace(/%s/g,function(){return e[s++]});typeof console<"u"&&console.error(a);try{throw new Error(a)}catch{}};dy=function(r,t,e){var i=arguments.length;e=new Array(i>2?i-2:0);for(var n=2;n<i;n++)e[n-2]=arguments[n];if(t===void 0)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");r||lR.apply(null,[t].concat(e))}}var cR=dy;const we=Dg(cR);var e0=Object.prototype.hasOwnProperty;function i0(r,t,e){for(e of r.keys())if(ta(e,t))return e}function ta(r,t){var e,i,n;if(r===t)return!0;if(r&&t&&(e=r.constructor)===t.constructor){if(e===Date)return r.getTime()===t.getTime();if(e===RegExp)return r.toString()===t.toString();if(e===Array){if((i=r.length)===t.length)for(;i--&&ta(r[i],t[i]););return i===-1}if(e===Set){if(r.size!==t.size)return!1;for(i of r)if(n=i,n&&typeof n=="object"&&(n=i0(t,n),!n)||!t.has(n))return!1;return!0}if(e===Map){if(r.size!==t.size)return!1;for(i of r)if(n=i[0],n&&typeof n=="object"&&(n=i0(t,n),!n)||!ta(i[1],t.get(n)))return!1;return!0}if(e===ArrayBuffer)r=new Uint8Array(r),t=new Uint8Array(t);else if(e===DataView){if((i=r.byteLength)===t.byteLength)for(;i--&&r.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(r)){if((i=r.byteLength)===t.byteLength)for(;i--&&r[i]===t[i];);return i===-1}if(!e||typeof r=="object"){i=0;for(e in r)if(e0.call(r,e)&&++i&&!e0.call(t,e)||!(e in t)||!ta(r[e],t[e]))return!1;return Object.keys(t).length===i}}return r!==r&&t!==t}const uy=z.createContext(null);function ea({children:r,type:t}){return I.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:r})}const hR="noopener noreferrer nofollow";class dR{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Ot(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(t){Ot(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{Ot(this.pdfDocument,"PDF document not loaded."),Ot(t,"Destination is not specified."),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{Ot(Array.isArray(e),`"${e}" is not a valid destination array.`);const i=e[0];new Promise(n=>{Ot(this.pdfDocument,"PDF document not loaded."),i instanceof Object?this.pdfDocument.getPageIndex(i).then(s=>{n(s)}).catch(()=>{Ot(!1,`"${i}" is not a valid page reference.`)}):typeof i=="number"?n(i):Ot(!1,`"${i}" is not a valid destination reference.`)}).then(n=>{const s=n+1;Ot(this.pdfViewer,"PDF viewer is not initialized."),Ot(s>=1&&s<=this.pagesCount,`"${s}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:n,pageNumber:s})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;Ot(this.pdfViewer,"PDF viewer is not initialized."),Ot(t>=1&&t<=this.pagesCount,`"${t}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||hR,t.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const n0={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Sf=typeof document<"u",fy=Sf&&window.location.protocol==="file:";function uR(r){return typeof r<"u"}function gs(r){return uR(r)&&r!==null}function fR(r){return typeof r=="string"}function pR(r){return r instanceof ArrayBuffer}function gR(r){return Ot(Sf,"isBlob can only be used in a browser environment"),r instanceof Blob}function Fg(r){return fR(r)&&/^data:/.test(r)}function s0(r){Ot(Fg(r),"Invalid data URI.");const[t="",e=""]=r.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function mR(){return Sf&&window.devicePixelRatio||1}const py="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function r0(){we(!fy,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${py}`)}function vR(){we(!fy,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${py}`)}function Fr(r){r&&r.cancel&&r.cancel()}function Mg(r,t){return Object.defineProperty(r,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(r,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(r,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(r,"originalHeight",{get(){return this.view[3]},configurable:!0}),r}function bR(r){return r.name==="RenderingCancelledException"}function yR(r){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=n=>{if(!n.target)return e(new Error("Error while reading a file."));const{error:s}=n.target;if(!s)return e(new Error("Error while reading a file."));switch(s.code){case s.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case s.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case s.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(r)})}function wR(r,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return r}}function wo(){return z.useReducer(wR,{value:void 0,error:void 0})}var AR=function(r,t,e,i){function n(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function l(h){try{d(i.next(h))}catch(p){a(p)}}function c(h){try{d(i.throw(h))}catch(p){a(p)}}function d(h){h.done?s(h.value):n(h.value).then(l,c)}d((i=i.apply(r,t||[])).next())})},a0=function(r,t){var e={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(e[i[n]]=r[i[n]]);return e};const{PDFDataRangeTransport:ER}=jP,_R=(r,t)=>{switch(t){case n0.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");r(e);break}case n0.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");r(e);break}}};function o0(r){return typeof r=="object"&&r!==null&&("data"in r||"range"in r||"url"in r)}const xR=z.forwardRef(function(t,e){var{children:i,className:n,error:s="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:l,file:c,inputRef:d,imageResourcesPath:h,loading:p="Loading PDF…",noData:g="No PDF file specified.",onItemClick:v,onLoadError:b,onLoadProgress:E,onLoadSuccess:C,onPassword:_=_R,onSourceError:R,onSourceSuccess:L,options:D,renderMode:O,rotate:N}=t,j=a0(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[S,T]=wo(),{value:F,error:k}=S,[U,H]=wo(),{value:G,error:K}=U,Z=z.useRef(new dR),B=z.useRef([]),W=z.useRef(void 0),q=z.useRef(void 0);c&&c!==W.current&&o0(c)&&(we(!ta(c,W.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),W.current=c),D&&D!==q.current&&(we(!ta(D,q.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),q.current=D);const xt=z.useRef({scrollPageIntoView:X=>{const{dest:ft,pageNumber:Ct,pageIndex:Nt=Ct-1}=X;if(v){v({dest:ft,pageIndex:Nt,pageNumber:Ct});return}const Wt=B.current[Nt];if(Wt){Wt.scrollIntoView();return}we(!1,`An internal link leading to page ${Ct} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});z.useImperativeHandle(e,()=>({linkService:Z,pages:B,viewer:xt}),[]);function vt(){L&&L()}function V(){k&&(we(!1,k.toString()),R&&R(k))}function it(){T({type:"RESET"})}z.useEffect(it,[c,T]);const et=z.useCallback(()=>AR(this,void 0,void 0,function*(){if(!c)return null;if(typeof c=="string")return Fg(c)?{data:s0(c)}:(r0(),{url:c});if(c instanceof ER)return{range:c};if(pR(c))return{data:c};if(Sf&&gR(c))return{data:yield yR(c)};if(Ot(typeof c=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),Ot(o0(c),"Invalid parameter object: need either .data, .range or .url"),"url"in c&&typeof c.url=="string"){if(Fg(c.url)){const{url:X}=c,ft=a0(c,["url"]),Ct=s0(X);return Object.assign({data:Ct},ft)}r0()}return c}),[c]);z.useEffect(()=>{const X=xh(et());return X.promise.then(ft=>{T({type:"RESOLVE",value:ft})}).catch(ft=>{T({type:"REJECT",error:ft})}),()=>{Fr(X)}},[et,T]),z.useEffect(()=>{if(!(typeof F>"u")){if(F===!1){V();return}vt()}},[F]);function nt(){G&&(C&&C(G),B.current=new Array(G.numPages),Z.current.setDocument(G))}function dt(){K&&(we(!1,K.toString()),b&&b(K))}function Q(){H({type:"RESET"})}z.useEffect(Q,[H,F]);function _t(){if(!F)return;const X=Object.assign(Object.assign({},F),D),ft=oy(X);E&&(ft.onProgress=E),_&&(ft.onPassword=_);const Ct=ft;return Ct.promise.then(Nt=>{H({type:"RESOLVE",value:Nt})}).catch(Nt=>{Ct.destroyed||H({type:"REJECT",error:Nt})}),()=>{Ct.destroy()}}z.useEffect(_t,[D,H,F]),z.useEffect(()=>{if(!(typeof G>"u")){if(G===!1){dt();return}nt()}},[G]);function Y(){Z.current.setViewer(xt.current),Z.current.setExternalLinkRel(a),Z.current.setExternalLinkTarget(l)}z.useEffect(Y,[a,l]);function tt(X,ft){B.current[X]=ft}function ut(X){delete B.current[X]}const St=z.useMemo(()=>({imageResourcesPath:h,linkService:Z.current,onItemClick:v,pdf:G,registerPage:tt,renderMode:O,rotate:N,unregisterPage:ut}),[h,v,G,O,N]),at=z.useMemo(()=>cy(j,()=>G),[j,G]);function wt(){return I.jsx(uy.Provider,{value:St,children:i})}function gt(){return c?G==null?I.jsx(ea,{type:"loading",children:typeof p=="function"?p():p}):G===!1?I.jsx(ea,{type:"error",children:typeof s=="function"?s():s}):wt():I.jsx(ea,{type:"no-data",children:typeof g=="function"?g():g})}return I.jsx("div",Object.assign({className:xf("react-pdf__Document",n),ref:d,style:{"--scale-factor":"1"}},at,{children:gt()}))});function gy(){return z.useContext(uy)}function my(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=r.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(s){e.forEach(function(a){typeof a=="function"?a(s):a&&(a.current=s)})}}const vy=z.createContext(null),by={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},SR=/^H(\d+)$/;function CR(r){return r in by}function Cf(r){return"children"in r}function yy(r){return Cf(r)?r.children.length===1&&0 in r.children&&"id"in r.children[0]:!1}function TR(r){const t={};if(Cf(r)){const{role:e}=r,i=e.match(SR);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(CR(e)){const n=by[e];n&&(t.role=n)}}return t}function wy(r){const t={};if(Cf(r)){if(r.alt!==void 0&&(t["aria-label"]=r.alt),r.lang!==void 0&&(t.lang=r.lang),yy(r)){const[e]=r.children;if(e){const i=wy(e);return Object.assign(Object.assign({},t),i)}}}else"id"in r&&(t["aria-owns"]=r.id);return t}function PR(r){return r?Object.assign(Object.assign({},TR(r)),wy(r)):null}function Ay({className:r,node:t}){const e=z.useMemo(()=>PR(t),[t]),i=z.useMemo(()=>!Cf(t)||yy(t)?null:t.children.map((n,s)=>I.jsx(Ay,{node:n},s)),[t]);return I.jsx("span",Object.assign({className:r},e,{children:i}))}function Tf(){return z.useContext(vy)}function RR(){const r=Tf();Ot(r,"Unable to find Page context.");const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=r,[i,n]=wo(),{value:s,error:a}=i,{customTextRenderer:l,page:c}=r;function d(){s&&e&&e(s)}function h(){a&&(we(!1,a.toString()),t&&t(a))}function p(){n({type:"RESET"})}z.useEffect(p,[n,c]);function g(){if(l||!c)return;const v=xh(c.getStructTree()),b=v;return v.promise.then(E=>{n({type:"RESOLVE",value:E})}).catch(E=>{n({type:"REJECT",error:E})}),()=>Fr(b)}return z.useEffect(g,[l,c,n]),z.useEffect(()=>{if(s!==void 0){if(s===!1){h();return}d()}},[s]),s?I.jsx(Ay,{className:"react-pdf__Page__structTree structTree",node:s}):null}const l0=ry;function LR(r){const t=Tf();Ot(t,"Unable to find Page context.");const e=Object.assign(Object.assign({},t),r),{_className:i,canvasBackground:n,devicePixelRatio:s=mR(),onRenderError:a,onRenderSuccess:l,page:c,renderForms:d,renderTextLayer:h,rotate:p,scale:g}=e,{canvasRef:v}=r;Ot(c,"Attempted to render page canvas, but no page was specified.");const b=z.useRef(null);function E(){c&&l&&l(Mg(c,g))}function C(O){bR(O)||(we(!1,O.toString()),a&&a(O))}const _=z.useMemo(()=>c.getViewport({scale:g*s,rotation:p}),[s,c,p,g]),R=z.useMemo(()=>c.getViewport({scale:g,rotation:p}),[c,p,g]);function L(){if(!c)return;c.cleanup();const{current:O}=b;if(!O)return;O.width=_.width,O.height=_.height,O.style.width=`${Math.floor(R.width)}px`,O.style.height=`${Math.floor(R.height)}px`,O.style.visibility="hidden";const N={annotationMode:d?l0.ENABLE_FORMS:l0.ENABLE,canvasContext:O.getContext("2d",{alpha:!1}),viewport:_};n&&(N.background=n);const j=c.render(N),S=j;return j.promise.then(()=>{O.style.visibility="",E()}).catch(C),()=>Fr(S)}z.useEffect(L,[n,b,s,c,d,_,R]);const D=z.useCallback(()=>{const{current:O}=b;O&&(O.width=0,O.height=0)},[b]);return z.useEffect(()=>D,[D]),I.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:my(v,b),style:{display:"block",userSelect:"none"},children:h?I.jsx(RR,{}):null})}function kR(r){return"str"in r}function IR(){const r=Tf();Ot(r,"Unable to find Page context.");const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:n,onRenderTextLayerSuccess:s,page:a,pageIndex:l,pageNumber:c,rotate:d,scale:h}=r;Ot(a,"Attempted to load page text content, but no page was specified.");const[p,g]=wo(),{value:v,error:b}=p,E=z.useRef(null),C=z.useRef(void 0);we(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function _(){v&&i&&i(v)}function R(){b&&(we(!1,b.toString()),e&&e(b))}function L(){g({type:"RESET"})}z.useEffect(L,[a,g]);function D(){if(!a)return;const k=xh(a.getTextContent()),U=k;return k.promise.then(H=>{g({type:"RESOLVE",value:H})}).catch(H=>{g({type:"REJECT",error:H})}),()=>Fr(U)}z.useEffect(D,[a,g]),z.useEffect(()=>{if(v!==void 0){if(v===!1){R();return}_()}},[v]);const O=z.useCallback(()=>{s&&s()},[s]),N=z.useCallback(k=>{we(!1,k.toString()),n&&n(k)},[n]);function j(){const k=C.current;k&&k.classList.add("active")}function S(){const k=C.current;k&&k.classList.remove("active")}const T=z.useMemo(()=>a.getViewport({scale:h,rotation:d}),[a,d,h]);function F(){if(!a||!v)return;const{current:k}=E;if(!k)return;k.innerHTML="";const U=a.streamTextContent({includeMarkedContent:!0}),H={container:k,textContentSource:U,viewport:T},G=new ay(H),K=G;return G.render().then(()=>{const Z=document.createElement("div");Z.className="endOfContent",k.append(Z),C.current=Z;const B=k.querySelectorAll('[role="presentation"]');if(t){let W=0;v.items.forEach((q,xt)=>{if(!kR(q))return;const vt=B[W];if(!vt)return;const V=t(Object.assign({pageIndex:l,pageNumber:c,itemIndex:xt},q));vt.innerHTML=V,W+=q.str&&q.hasEOL?2:1})}O()}).catch(N),()=>Fr(K)}return z.useLayoutEffect(F,[t,N,O,a,l,c,v,T]),I.jsx("div",{className:xf("react-pdf__Page__textContent","textLayer"),onMouseUp:S,onMouseDown:j,ref:E})}function FR(){const r=gy(),t=Tf();Ot(t,"Unable to find Page context.");const e=Object.assign(Object.assign({},r),t),{imageResourcesPath:i,linkService:n,onGetAnnotationsError:s,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:c,page:d,pdf:h,renderForms:p,rotate:g,scale:v=1}=e;Ot(h,"Attempted to load page annotations, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop."),Ot(d,"Attempted to load page annotations, but no page was specified."),Ot(n,"Attempted to load page annotations, but no linkService was specified.");const[b,E]=wo(),{value:C,error:_}=b,R=z.useRef(null);we(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function L(){C&&a&&a(C)}function D(){_&&(we(!1,_.toString()),s&&s(_))}function O(){E({type:"RESET"})}z.useEffect(O,[E,d]);function N(){if(!d)return;const k=xh(d.getAnnotations()),U=k;return k.promise.then(H=>{E({type:"RESOLVE",value:H})}).catch(H=>{E({type:"REJECT",error:H})}),()=>{Fr(U)}}z.useEffect(N,[E,d,p]),z.useEffect(()=>{if(C!==void 0){if(C===!1){D();return}L()}},[C]);function j(){c&&c()}function S(k){we(!1,`${k}`),l&&l(k)}const T=z.useMemo(()=>d.getViewport({scale:v,rotation:g}),[d,g,v]);function F(){if(!h||!d||!n||!C)return;const{current:k}=R;if(!k)return;const U=T.clone({dontFlip:!0}),H={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:k,l10n:null,page:d,viewport:U},G={annotations:C,annotationStorage:h.annotationStorage,div:k,imageResourcesPath:i,linkService:n,page:d,renderForms:p,viewport:U};k.innerHTML="";try{new sy(H).render(G),j()}catch(K){S(K)}return()=>{}}return z.useEffect(F,[C,i,n,d,p,T]),I.jsx("div",{className:xf("react-pdf__Page__annotations","annotationLayer"),ref:R})}var MR=function(r,t){var e={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(e[i[n]]=r[i[n]]);return e};const c0=1;function DR(r){const t=gy(),e=Object.assign(Object.assign({},t),r),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:n=!0,canvasBackground:s,canvasRef:a,children:l,className:c,customRenderer:d,customTextRenderer:h,devicePixelRatio:p,error:g="Failed to load the page.",height:v,inputRef:b,loading:E="Loading page…",noData:C="No page specified.",onGetAnnotationsError:_,onGetAnnotationsSuccess:R,onGetStructTreeError:L,onGetStructTreeSuccess:D,onGetTextError:O,onGetTextSuccess:N,onLoadError:j,onLoadSuccess:S,onRenderAnnotationLayerError:T,onRenderAnnotationLayerSuccess:F,onRenderError:k,onRenderSuccess:U,onRenderTextLayerError:H,onRenderTextLayerSuccess:G,pageIndex:K,pageNumber:Z,pdf:B,registerPage:W,renderAnnotationLayer:q=!0,renderForms:xt=!1,renderMode:vt="canvas",renderTextLayer:V=!0,rotate:it,scale:et=c0,unregisterPage:nt,width:dt}=e,Q=MR(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[_t,Y]=wo(),{value:tt,error:ut}=_t,St=z.useRef(null);Ot(B,"Attempted to load a page, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop.");const at=gs(Z)?Z-1:K??null,wt=Z??(gs(K)?K+1:null),gt=it??(tt?tt.rotate:null),X=z.useMemo(()=>{if(!tt)return null;let y=1;const u=et??c0;if(dt||v){const f=tt.getViewport({scale:1,rotation:gt});dt?y=dt/f.width:v&&(y=v/f.height)}return u*y},[v,tt,gt,et,dt]);function ft(){return()=>{gs(at)&&n&&nt&&nt(at)}}z.useEffect(ft,[n,B,at,nt]);function Ct(){if(S){if(!tt||!X)return;S(Mg(tt,X))}if(n&&W){if(!gs(at)||!St.current)return;W(at,St.current)}}function Nt(){ut&&(we(!1,ut.toString()),j&&j(ut))}function Wt(){Y({type:"RESET"})}z.useEffect(Wt,[Y,B,at]);function Ut(){if(!B||!wt)return;const y=xh(B.getPage(wt)),u=y;return y.promise.then(f=>{Y({type:"RESOLVE",value:f})}).catch(f=>{Y({type:"REJECT",error:f})}),()=>Fr(u)}z.useEffect(Ut,[Y,B,at,wt,W]),z.useEffect(()=>{if(tt!==void 0){if(tt===!1){Nt();return}Ct()}},[tt,X]);const Tt=z.useMemo(()=>tt&&gs(at)&&wt&&gs(gt)&&gs(X)?{_className:i,canvasBackground:s,customTextRenderer:h,devicePixelRatio:p,onGetAnnotationsError:_,onGetAnnotationsSuccess:R,onGetStructTreeError:L,onGetStructTreeSuccess:D,onGetTextError:O,onGetTextSuccess:N,onRenderAnnotationLayerError:T,onRenderAnnotationLayerSuccess:F,onRenderError:k,onRenderSuccess:U,onRenderTextLayerError:H,onRenderTextLayerSuccess:G,page:tt,pageIndex:at,pageNumber:wt,renderForms:xt,renderTextLayer:V,rotate:gt,scale:X}:null,[i,s,h,p,_,R,L,D,O,N,T,F,k,U,H,G,tt,at,wt,xt,V,gt,X]),Pt=z.useMemo(()=>cy(Q,()=>tt&&(X?Mg(tt,X):void 0)),[Q,tt,X]),Ht=`${at}@${X}/${gt}`;function ot(){switch(vt){case"custom":return Ot(d,'renderMode was set to "custom", but no customRenderer was passed.'),I.jsx(d,{},`${Ht}_custom`);case"none":return null;case"canvas":default:return I.jsx(LR,{canvasRef:a},`${Ht}_canvas`)}}function Ee(){return V?I.jsx(IR,{},`${Ht}_text`):null}function _e(){return q?I.jsx(FR,{},`${Ht}_annotations`):null}function se(){return I.jsxs(vy.Provider,{value:Tt,children:[ot(),Ee(),_e(),l]})}function Ye(){return wt?B===null||tt===void 0||tt===null?I.jsx(ea,{type:"loading",children:typeof E=="function"?E():E}):B===!1||tt===!1?I.jsx(ea,{type:"error",children:typeof g=="function"?g():g}):se():I.jsx(ea,{type:"no-data",children:typeof C=="function"?C():C})}return I.jsx("div",Object.assign({className:xf(i,c),"data-page-number":wt,ref:my(b,St),style:{"--scale-factor":`${X}`,backgroundColor:s||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Pt,{children:Ye()}))}vR();am.workerSrc="pdf.worker.mjs";const Ey="SET_ZOOM_LEVEL",rp=r=>({type:Ey,value:r}),_y="SET_PDF_PAGINATED",OR=r=>({type:_y,value:r}),xy="SET_NUM_PAGES",h0=r=>({type:xy,value:r}),Sy="SET_CURRENT_PAGE",Cy="SET_CURRENT_MAIN_STATE",d0=r=>({type:Sy,value:r}),Nn={defaultZoomLevel:1,zoomLevel:1,zoomJump:.1,paginated:!0,numPages:0,currentPage:1},NR=(r=Nn,t)=>{switch(t.type){case Ey:{const{value:e}=t;return{...r,zoomLevel:e}}case _y:{const{value:e}=t;return{...r,paginated:e}}case xy:{const{value:e}=t;return{...r,numPages:e}}case Sy:{const{value:e}=t;return{...r,currentPage:e}}case Cy:{const{value:e}=t;return{...r,mainState:e}}default:return r}},Eo=z.createContext({state:Nn,dispatch:()=>null}),BR=({children:r,mainState:t})=>{var n,s,a,l,c,d,h;const[e,i]=z.useReducer(NR,{...Nn,defaultZoomLevel:((s=(n=t.config)==null?void 0:n.pdfZoom)==null?void 0:s.defaultZoom)??Nn.defaultZoomLevel,zoomLevel:((l=(a=t.config)==null?void 0:a.pdfZoom)==null?void 0:l.defaultZoom)??Nn.zoomLevel,zoomJump:((d=(c=t.config)==null?void 0:c.pdfZoom)==null?void 0:d.zoomJump)??Nn.zoomJump,paginated:(h=t.config)!=null&&h.pdfVerticalScrollByDefault?!1:Nn.paginated,mainState:t});return z.useEffect(()=>{i({type:Cy,value:t})},[t]),I.jsx(Eo.Provider,{value:{state:e,dispatch:i},children:r})},Ty=({pageNum:r})=>{const{state:{mainState:t,paginated:e,zoomLevel:i,numPages:n,currentPage:s}}=z.useContext(Eo),{t:a}=Or(),l=(t==null?void 0:t.rendererRect)||null,c=r??s;return I.jsxs($R,{id:"pdf-page-wrapper",$lastPage:c>=n,children:[!e&&I.jsx(jR,{id:"pdf-page-info",children:a("pdfPluginPageNumber",{currentPage:c,allPagesCount:n})}),I.jsx(DR,{pageNumber:c||s,scale:i,height:((l==null?void 0:l.height)??100)-100,width:((l==null?void 0:l.width)??100)-100,loading:a("pdfPluginLoading")})]})},$R=ht.div`
  margin: ${r=>r.$lastPage?"20px 0":void 0};
`,jR=ht.div`
  padding: 0 0 10px 10px;
  color: ${r=>r.theme.textTertiary};
  font-size: 14px;
  text-align: left;

  @media (max-width: 768px) {
    font-size: 10px;
  }
`,UR=()=>{const{state:{numPages:r}}=z.useContext(Eo),t=[];for(let e=0;e<r;e++)t.push(I.jsx(Ty,{pageNum:e+1},e+1));return I.jsx(I.Fragment,{children:t})},HR=()=>{const{state:{mainState:r,paginated:t},dispatch:e}=z.useContext(Eo),{t:i}=Or(),n=(r==null?void 0:r.currentDocument)||null;return z.useEffect(()=>{e(h0(Nn.numPages))},[n]),!n||n.fileData===void 0?null:I.jsx(zR,{file:n.fileData,onLoadSuccess:({numPages:s})=>e(h0(s)),loading:I.jsx("span",{children:i("pdfPluginLoading")}),children:t?I.jsx(Ty,{}):I.jsx(UR,{})})},zR=ht(xR)`
  display: flex;
  flex-direction: column;
  margin: 0 auto;
`,GR=r=>I.jsx(Py,{...r,reverse:!0}),VR=r=>I.jsx(Py,{...r}),Py=r=>{const{color:t,size:e,reverse:i}=r;return I.jsx("svg",{width:e||"100%",height:e||"100%",style:{transform:`${i?"rotate(180deg)":""}`},viewBox:"0 0 12 12",version:"1.1",children:I.jsx("g",{id:"Icons",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:I.jsx("g",{id:"Rounded",transform:"translate(-548.000000, -1000.000000)",children:I.jsx("g",{id:"AV",transform:"translate(100.000000, 852.000000)",children:I.jsx("g",{id:"-Round-/-AV-/-skip_next",transform:"translate(442.000000, 142.000000)",children:I.jsxs("g",{children:[I.jsx("rect",{id:"Rectangle-Copy-52",x:"0",y:"0",width:"24",height:"24"}),I.jsx("path",{d:"M7.58,16.89 L13.35,12.82 C13.91,12.42 13.91,11.58 13.35,11.19 L7.58,7.11 C6.91,6.65 6,7.12 6,7.93 L6,16.07 C6,16.88 6.91,17.35 7.58,16.89 Z M16,7 L16,17 C16,17.55 16.45,18 17,18 C17.55,18 18,17.55 18,17 L18,7 C18,6.45 17.55,6 17,6 C16.45,6 16,6.45 16,7 Z",id:"icon_color",fill:t||"#aaa"})]})})})})})})},WR=r=>{const{color:t,size:e,reverse:i}=r;return I.jsxs("svg",{width:e||"100%",height:e||"100%",style:{transform:`${i?"rotate(180deg)":""}`},id:"Layer_1",viewBox:"0 0 24 24",children:[I.jsx("path",{d:"M20.57,9.43A8,8,0,0,0,5.26,10,5,5,0,1,0,5,20h5V18H5a3,3,0,0,1,0-6,3.1,3.1,0,0,1,.79.12l1.12.31.14-1.15a6,6,0,0,1,11.74-.82l.15.54.54.16A3.46,3.46,0,0,1,22,14.5,3.5,3.5,0,0,1,18.5,18H16v2h2.5A5.48,5.48,0,0,0,20.57,9.43Z",fill:t||"#aaa"}),I.jsx("polygon",{points:"12 11 12 15.59 10.71 14.29 9.29 15.71 13 19.41 16.71 15.71 15.29 14.29 14 15.59 14 11 12 11",fill:t||"#aaa"})]})},qR=r=>I.jsx(Ry,{...r}),XR=r=>I.jsx(Ry,{...r,reverse:!0}),Ry=r=>{const{color:t,size:e,reverse:i}=r;return I.jsx("svg",{width:e||"100%",height:e||"100%",viewBox:"0 0 32 32",version:"1.1",children:I.jsx("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:I.jsx("g",{id:"search-plus-icon",fill:t||"#aaa",children:I.jsx("path",{id:"search-plus",d:i?"M 13 13 L 16 13 L 19 13 L 19 16 L 16 16 L 13 16 L 10 16 L 10 13 Z M 19.4271 21.4271 C 18.0372 22.4175 16.3367 23 14.5 23 C 9.8056 23 6 19.1944 6 14.5 C 6 9.8056 9.8056 6 14.5 6 C 19.1944 6 23 9.8056 23 14.5 C 23 16.3367 22.4175 18.0372 21.4271 19.4271 L 27.0119 25.0119 C 27.5621 25.5621 27.5575 26.4425 27.0117 26.9883 L 26.9883 27.0117 C 26.4439 27.5561 25.5576 27.5576 25.0119 27.0119 L 19.4271 21.4271 L 19.4271 21.4271 L 19.4271 21.4271 Z M 14.5 21 C 18.0899 21 21 18.0899 21 14.5 C 21 10.9101 18.0899 8 14.5 8 C 10.9101 8 8 10.9101 8 14.5 C 8 18.0899 10.9101 21 14.5 21 L 14.5 21 Z":"M 13 13 L 13 10 L 16 10 L 16 13 L 19 13 L 19 16 L 16 16 L 16 19 L 13 19 L 13 16 L 10 16 L 10 13 Z M 19.4271 21.4271 C 18.0372 22.4175 16.3367 23 14.5 23 C 9.8056 23 6 19.1944 6 14.5 C 6 9.8056 9.8056 6 14.5 6 C 19.1944 6 23 9.8056 23 14.5 C 23 16.3367 22.4175 18.0372 21.4271 19.4271 L 27.0119 25.0119 C 27.5621 25.5621 27.5575 26.4425 27.0117 26.9883 L 26.9883 27.0117 C 26.4439 27.5561 25.5576 27.5576 25.0119 27.0119 L 19.4271 21.4271 L 19.4271 21.4271 L 19.4271 21.4271 Z M 14.5 21 C 18.0899 21 21 18.0899 21 14.5 C 21 10.9101 18.0899 8 14.5 8 C 10.9101 8 8 10.9101 8 14.5 C 8 18.0899 10.9101 21 14.5 21 L 14.5 21 Z"})})})})},YR=r=>{const{color:t,size:e}=r;return I.jsx("svg",{width:e||"100%",height:e||"100%",viewBox:"0 0 24 24",children:I.jsx("path",{fill:t||"#aaa",d:"M9.29,13.29,4,18.59V17a1,1,0,0,0-2,0v4a1,1,0,0,0,.08.38,1,1,0,0,0,.54.54A1,1,0,0,0,3,22H7a1,1,0,0,0,0-2H5.41l5.3-5.29a1,1,0,0,0-1.42-1.42ZM5.41,4H7A1,1,0,0,0,7,2H3a1,1,0,0,0-.38.08,1,1,0,0,0-.54.54A1,1,0,0,0,2,3V7A1,1,0,0,0,4,7V5.41l5.29,5.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42ZM21,16a1,1,0,0,0-1,1v1.59l-5.29-5.3a1,1,0,0,0-1.42,1.42L18.59,20H17a1,1,0,0,0,0,2h4a1,1,0,0,0,.38-.08,1,1,0,0,0,.54-.54A1,1,0,0,0,22,21V17A1,1,0,0,0,21,16Zm.92-13.38a1,1,0,0,0-.54-.54A1,1,0,0,0,21,2H17a1,1,0,0,0,0,2h1.59l-5.3,5.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L20,5.41V7a1,1,0,0,0,2,0V3A1,1,0,0,0,21.92,2.62Z"})})},KR=r=>{const{color:t,size:e,reverse:i}=r;return I.jsx("svg",{width:e||"100%",height:e||"100%",style:{transform:`${i?"rotate(90deg)":""}`},version:"1.1",id:"Scroll_1",viewBox:"0 0 297 297",xmlSpace:"preserve",children:I.jsx("path",{fill:t||"#aaa",d:`M206.004,200.723h-31.231V96.277h31.231c0.005,0,0.014,0,0.019,0c5.289,0,9.575-4.287,9.575-9.574
  c0-2.342-0.841-4.488-2.236-6.151L156.168,3.851C154.36,1.428,151.515,0,148.492,0c-3.023,0-5.868,1.428-7.675,3.851L83.302,80.98
  c-2.166,2.902-2.507,6.779-0.883,10.017c1.624,3.236,4.936,5.28,8.559,5.28h31.231v104.445H90.978c-3.623,0-6.934,2.044-8.559,5.28
  c-1.624,3.237-1.283,7.114,0.883,10.017l57.513,77.129c1.808,2.424,4.652,3.852,7.675,3.852c3.023,0,5.868-1.428,7.676-3.852
  l57.514-77.129c2.164-2.902,2.507-6.779,0.883-10.017C212.938,202.767,209.627,200.723,206.004,200.723z`})})},ZR=()=>{const{state:{currentPage:r,numPages:t},dispatch:e}=z.useContext(Eo),{t:i}=Or();return I.jsxs(JR,{id:"pdf-pagination",children:[I.jsx(Ly,{id:"pdf-pagination-prev",onClick:()=>e(d0(r-1)),disabled:r===1,children:I.jsx(GR,{color:"#000",size:"50%"})}),I.jsx(tL,{id:"pdf-pagination-info",children:i("pdfPluginPageNumber",{currentPage:r,allPagesCount:t})}),I.jsx(QR,{id:"pdf-pagination-next",onClick:()=>e(d0(r+1)),disabled:r>=t,children:I.jsx(VR,{color:"#000",size:"50%"})})]})},JR=ht.div`
  display: flex;
  align-items: center;
`,Ly=ht(lf)`
  width: 30px;
  height: 30px;
  margin: 0 5px;

  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`,QR=ht(Ly)`
  margin: 0 20px 0 5px;
`,tL=ht.div`
  color: ${r=>r.theme.textPrimary};
  font-size: 14px;
  text-align: left;

  @media (max-width: 768px) {
    font-size: 10px;
  }
`,eL=()=>{const{t:r}=Or(),{state:{mainState:t,paginated:e,zoomLevel:i,numPages:n,zoomJump:s,defaultZoomLevel:a},dispatch:l}=z.useContext(Eo),c=(t==null?void 0:t.currentDocument)||null;return I.jsxs(iL,{id:"pdf-controls",children:[e&&n>1&&I.jsx(ZR,{}),(c==null?void 0:c.fileData)&&I.jsx(nL,{id:"pdf-download",href:c==null?void 0:c.fileData,download:(c==null?void 0:c.fileName)||(c==null?void 0:c.uri),title:r("downloadButtonLabel"),children:I.jsx(WR,{color:"#000",size:"75%"})}),I.jsx(Nh,{id:"pdf-zoom-out",onMouseDown:()=>l(rp(i-s)),children:I.jsx(XR,{color:"#000",size:"80%"})}),I.jsx(Nh,{id:"pdf-zoom-in",onMouseDown:()=>l(rp(i+s)),children:I.jsx(qR,{color:"#000",size:"80%"})}),I.jsx(Nh,{id:"pdf-zoom-reset",onMouseDown:()=>l(rp(a)),disabled:i===a,children:I.jsx(YR,{color:"#000",size:"70%"})}),n>1&&I.jsx(Nh,{id:"pdf-toggle-pagination",onMouseDown:()=>l(OR(!e)),children:I.jsx(KR,{color:"#000",size:"70%",reverse:e})})]})},iL=ht.div`
  display: flex;
  position: sticky;
  top: 0;
  left: 0;
  z-index: 1;
  justify-content: flex-end;
  padding: 8px;
  background-color: ${r=>r.theme.tertiary};
  box-shadow: 0px 2px 3px #00000033;

  @media (max-width: 768px) {
    padding: 6px;
  }
`,Nh=ht(lf)`
  width: 30px;
  height: 30px;
  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`,nL=ht(tv)`
  width: 30px;
  height: 30px;
  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`;am.workerSrc=new URL(`https://unpkg.com/pdfjs-dist@${ly}/build/pdf.worker.min.mjs`).toString();const Pf=({mainState:r})=>I.jsx(BR,{mainState:r,children:I.jsxs(sL,{id:"pdf-renderer","data-testid":"pdf-renderer",children:[I.jsx(eL,{}),I.jsx(HR,{})]})});Pf.fileTypes=["pdf","application/pdf"];Pf.weight=0;const sL=ht.div`
  display: flex;
  flex-direction: column;
  flex: 1;

  /* width */
  &::-webkit-scrollbar {
    ${r=>r.theme.disableThemeScrollbar?"":"width: 10px"};
  }
  /* Track */
  &::-webkit-scrollbar-track {
    /* background: ${r=>r.theme.secondary}; */
  }
  /* Handle */
  &::-webkit-scrollbar-thumb {
    background: ${r=>r.theme.tertiary};
  }
  /* Handle on hover */
  &::-webkit-scrollbar-thumb:hover {
    background: ${r=>r.theme.primary};
  }
`,rL=ht(Ln)`
  display: flex;
  flex: 1;
  align-items: center;
  justify-content: center;
  height: 100%;
  background-color: white;
  background-image: linear-gradient(45deg, #e0e0e0 25%, transparent 25%),
    linear-gradient(-45deg, #e0e0e0 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, #e0e0e0 75%),
    linear-gradient(-45deg, transparent 75%, #e0e0e0 75%);
  background-size: 20px 20px;
  background-position:
    0 0,
    0 10px,
    10px -10px,
    -10px 0px;
`,Rf=r=>I.jsx(rL,{...r});Rf.fileTypes=["png","image/png"];Rf.weight=0;let Tn,qe,xd=[];const aL=()=>{var r=De(2,0);if(r===18761)qe=!0;else if(r===19789)qe=!1;else throw TypeError("Invalid byte order value.");return qe},oL=()=>{if(De(2,2)!==42)throw RangeError("You forgot your towel!");return!0},lL=r=>{var t={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},e;return r in t?e=t[r]:e="Tag"+r,e},cL=r=>{var t={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"},e;return r in t&&(e=t[r]),e},hL=r=>{var t;return["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(r)!==-1?t=1:["SHORT","SSHORT"].indexOf(r)!==-1?t=2:["LONG","SLONG","FLOAT"].indexOf(r)!==-1?t=4:["RATIONAL","SRATIONAL","DOUBLE"].indexOf(r)!==-1&&(t=8),t},dL=(r,t,e)=>{e=e||0;var i=Math.floor(e/8),n=t+i,s=e+r,a=32-r;if(s<=0)throw RangeError("No bits requested");if(s<=8)var l=24+e,c=Tn.getUint8(n,qe);else if(s<=16)var l=16+e,c=Tn.getUint16(n,qe);else if(s<=32)var l=e,c=Tn.getUint32(n,qe);else throw RangeError("Too many bits requested");var d={bits:c<<l>>>a,byteOffset:n+Math.floor(s/8),bitOffset:s%8};return d},De=(r,t)=>{if(r<=0)throw RangeError("No bytes requested");if(r<=1)return Tn.getUint8(t,qe);if(r<=2)return Tn.getUint16(t,qe);if(r<=3)return Tn.getUint32(t,qe)>>>8;if(r<=4)return Tn.getUint32(t,qe);throw RangeError("Too many bytes requested")},uL=(r,t,e,i)=>{var n=[],s=hL(t),a=s*e;if(a<=4){if(qe===!1)var l=i>>>(4-s)*8;else var l=i;n.push(l)}else for(var c=0;c<e;c++){var d=s*c;if(s>=8)if(["RATIONAL","SRATIONAL"].indexOf(t)!==-1)n.push(De(4,i+d)),n.push(De(4,i+d+4));else throw TypeError("Can't handle this field type or size");else n.push(De(s,i+d))}return t==="ASCII"&&n.forEach(function(h,p,g){g[p]=String.fromCharCode(h)}),n},ms=(r,t)=>{var e=Math.pow(2,8-t);return Math.floor(r*e+(e-1))},u0=(r,t,e,i)=>(typeof i>"u"&&(i=1),"rgba("+r+", "+t+", "+e+", "+i+")"),ky=r=>{for(var t=De(2,r),e=[],i=r+2,n=0;n<t;i+=12,n++){var s=De(2,i),a=De(2,i+2),l=De(4,i+4),c=De(4,i+8),d=lL(s),h=cL(a),p=uL(d,h,l,c);e[d]={type:h,values:p}}xd.push(e);var g=De(4,i);return g===0?xd:ky(g)},fL=(r,t)=>{let e=t||document.createElement("canvas");if(r&&(Tn=new DataView(r),qe=aL(),!!oL())){var i=De(4,4);xd=ky(i);var n=xd[0],s=n.ImageWidth.values[0],a=n.ImageLength.values[0];e.width=s,e.height=a;var l=[],c=n.Compression?n.Compression.values[0]:1,d=n.SamplesPerPixel.values[0],h=[],p=0,g=!1;if(n.BitsPerSample.values.forEach(function(Ht,ot,Ee){h[ot]={bitsPerSample:Ht,hasBytesPerSample:!1,bytesPerSample:void 0},Ht%8===0&&(h[ot].hasBytesPerSample=!0,h[ot].bytesPerSample=Ht/8),p+=Ht},void 0),p%8===0){g=!0;var v=p/8}var b=n.StripOffsets.values,E=b.length;if(n.StripByteCounts)var C=n.StripByteCounts.values;else if(E===1)var C=[Math.ceil(s*a*p/8)];else throw Error("Cannot recover from missing StripByteCounts");for(var _=0;_<E;_++){var R=b[_];l[_]=[];for(var L=C[_],D=0,O=0,N=1,j=!0,S=[],T=0,F=0,k=0;D<L;D+=N)switch(c){case 1:for(var U=0,S=[];U<d;U++)if(h[U].hasBytesPerSample){var H=h[U].bytesPerSample*U;S.push(De(h[U].bytesPerSample,R+D+H))}else{var G=dL(h[U].bitsPerSample,R+D,O);throw S.push(G.bits),D=G.byteOffset-R,O=G.bitOffset,RangeError("Cannot handle sub-byte bits per sample")}if(l[_].push(S),g)N=v;else throw N=0,RangeError("Cannot handle sub-byte bits per pixel");break;case 2:break;case 3:break;case 4:break;case 5:break;case 6:break;case 7:break;case 32773:if(j){j=!1;var K=1,Z=1,B=Tn.getInt8(R+D,qe);B>=0&&B<=127?K=B+1:B>=-127&&B<=-1?Z=-B+1:j=!0}else{for(var W=De(1,R+D),U=0;U<Z;U++){if(h[F].hasBytesPerSample)k=k<<8*T|W,T++,T===h[F].bytesPerSample&&(S.push(k),k=T=0,F++);else throw RangeError("Cannot handle sub-byte bits per sample");F===d&&(l[_].push(S),S=[],F=0)}K--,K===0&&(j=!0)}N=1;break}}if(e.getContext){var q=e.getContext("2d");if(q.fillStyle=u0(255,255,255,0),n.RowsPerStrip)var xt=n.RowsPerStrip.values[0];else var xt=a;var vt=l.length,V=a%xt,it=V===0?xt:V,et=xt,nt=0,dt=n.PhotometricInterpretation.values[0],Q=[],_t=0;if(n.ExtraSamples&&(Q=n.ExtraSamples.values,_t=Q.length),n.ColorMap)var Y=n.ColorMap.values,tt=Math.pow(2,h[0].bitsPerSample);for(var _=0;_<vt;_++){_+1===vt&&(et=it);for(var ut=l[_].length,St=nt*_,at=0,wt=0;wt<ut;at++)for(var gt=0;gt<s;gt++,wt++){var X=l[_][wt],ft=0,Ct=0,Nt=0,Wt=1;if(_t>0){for(var Ut=0;Ut<_t;Ut++)if(Q[Ut]===1||Q[Ut]===2){Wt=X[3+Ut]/256;break}}switch(dt){case 0:if(h[0].hasBytesPerSample)var Tt=Math.pow(16,h[0].bytesPerSample*2);X.forEach(function(ot,Ee,_e){_e[Ee]=Tt-ot});case 1:ft=Ct=Nt=ms(X[0],h[0].bitsPerSample);break;case 2:ft=ms(X[0],h[0].bitsPerSample),Ct=ms(X[1],h[1].bitsPerSample),Nt=ms(X[2],h[2].bitsPerSample);break;case 3:if(Y===void 0)throw Error("Palette image missing color map");var Pt=X[0];ft=ms(Y[Pt],16),Ct=ms(Y[tt+Pt],16),Nt=ms(Y[2*tt+Pt],16);break;case 4:throw RangeError("Not Yet Implemented: Transparency mask");case 5:throw RangeError("Not Yet Implemented: CMYK");case 6:throw RangeError("Not Yet Implemented: YCbCr");case 8:throw RangeError("Not Yet Implemented: CIELab");default:throw RangeError("Unknown Photometric Interpretation:",dt)}q.fillStyle=u0(ft,Ct,Nt,Wt),q.fillRect(gt,St+at,1,1)}nt=et}}return e}},Sh=r=>{const{mainState:{currentDocument:t}}=r,{t:e}=Or(),[i,n]=z.useState(!1),[s,a]=z.useState(!1);return z.useEffect(()=>{if(!t||i)return;const l=document.getElementById("tiff-img");try{l&&fL(t.fileData,l),n(!0)}catch{a(!0)}},[t,i]),s?I.jsx(Ln,{...r,children:I.jsx("div",{children:e("brokenFile")})}):I.jsx(Ln,{...r,children:I.jsx(pL,{id:"tiff-img"})})};Sh.fileTypes=["tif","tiff","image/tif","image/tiff"];Sh.weight=0;Sh.fileLoader=sv;const pL=ht.canvas`
  max-width: 95%;
  max-height: 95%;
`,Ch=({mainState:{currentDocument:r}})=>I.jsx(gL,{id:"txt-renderer",children:r==null?void 0:r.fileData});Ch.fileTypes=["txt","text/plain"];Ch.weight=0;Ch.fileLoader=Xg;const gL=ht.div`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 30px;
`;var Iy={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(r,t){(function(e,i){r.exports=i()})(Xr,function e(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},n=!i.document&&!!i.postMessage,s=i.IS_PAPA_WORKER||!1,a={},l=0,c={parse:function(S,T){var F=(T=T||{}).dynamicTyping||!1;if(j(F)&&(T.dynamicTypingFunction=F,F={}),T.dynamicTyping=F,T.transform=!!j(T.transform)&&T.transform,T.worker&&c.WORKERS_SUPPORTED){var k=function(){if(!c.WORKERS_SUPPORTED)return!1;var H=(K=i.URL||i.webkitURL||null,Z=e.toString(),c.BLOB_URL||(c.BLOB_URL=K.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Z,")();"],{type:"text/javascript"})))),G=new i.Worker(H),K,Z;return G.onmessage=R,G.id=l++,a[G.id]=G}();return k.userStep=T.step,k.userChunk=T.chunk,k.userComplete=T.complete,k.userError=T.error,T.step=j(T.step),T.chunk=j(T.chunk),T.complete=j(T.complete),T.error=j(T.error),delete T.worker,void k.postMessage({input:S,config:T,workerId:k.id})}var U=null;return c.NODE_STREAM_INPUT,typeof S=="string"?(S=function(H){return H.charCodeAt(0)===65279?H.slice(1):H}(S),U=T.download?new p(T):new v(T)):S.readable===!0&&j(S.read)&&j(S.on)?U=new b(T):(i.File&&S instanceof File||S instanceof Object)&&(U=new g(T)),U.stream(S)},unparse:function(S,T){var F=!1,k=!0,U=",",H=`\r
`,G='"',K=G+G,Z=!1,B=null,W=!1;(function(){if(typeof T=="object"){if(typeof T.delimiter!="string"||c.BAD_DELIMITERS.filter(function(V){return T.delimiter.indexOf(V)!==-1}).length||(U=T.delimiter),(typeof T.quotes=="boolean"||typeof T.quotes=="function"||Array.isArray(T.quotes))&&(F=T.quotes),typeof T.skipEmptyLines!="boolean"&&typeof T.skipEmptyLines!="string"||(Z=T.skipEmptyLines),typeof T.newline=="string"&&(H=T.newline),typeof T.quoteChar=="string"&&(G=T.quoteChar),typeof T.header=="boolean"&&(k=T.header),Array.isArray(T.columns)){if(T.columns.length===0)throw new Error("Option columns is empty");B=T.columns}T.escapeChar!==void 0&&(K=T.escapeChar+G),(typeof T.escapeFormulae=="boolean"||T.escapeFormulae instanceof RegExp)&&(W=T.escapeFormulae instanceof RegExp?T.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var q=new RegExp(C(G),"g");if(typeof S=="string"&&(S=JSON.parse(S)),Array.isArray(S)){if(!S.length||Array.isArray(S[0]))return xt(null,S,Z);if(typeof S[0]=="object")return xt(B||Object.keys(S[0]),S,Z)}else if(typeof S=="object")return typeof S.data=="string"&&(S.data=JSON.parse(S.data)),Array.isArray(S.data)&&(S.fields||(S.fields=S.meta&&S.meta.fields||B),S.fields||(S.fields=Array.isArray(S.data[0])?S.fields:typeof S.data[0]=="object"?Object.keys(S.data[0]):[]),Array.isArray(S.data[0])||typeof S.data[0]=="object"||(S.data=[S.data])),xt(S.fields||[],S.data||[],Z);throw new Error("Unable to serialize unrecognized input");function xt(V,it,et){var nt="";typeof V=="string"&&(V=JSON.parse(V)),typeof it=="string"&&(it=JSON.parse(it));var dt=Array.isArray(V)&&0<V.length,Q=!Array.isArray(it[0]);if(dt&&k){for(var _t=0;_t<V.length;_t++)0<_t&&(nt+=U),nt+=vt(V[_t],_t);0<it.length&&(nt+=H)}for(var Y=0;Y<it.length;Y++){var tt=dt?V.length:it[Y].length,ut=!1,St=dt?Object.keys(it[Y]).length===0:it[Y].length===0;if(et&&!dt&&(ut=et==="greedy"?it[Y].join("").trim()==="":it[Y].length===1&&it[Y][0].length===0),et==="greedy"&&dt){for(var at=[],wt=0;wt<tt;wt++){var gt=Q?V[wt]:wt;at.push(it[Y][gt])}ut=at.join("").trim()===""}if(!ut){for(var X=0;X<tt;X++){0<X&&!St&&(nt+=U);var ft=dt&&Q?V[X]:X;nt+=vt(it[Y][ft],X)}Y<it.length-1&&(!et||0<tt&&!St)&&(nt+=H)}}return nt}function vt(V,it){if(V==null)return"";if(V.constructor===Date)return JSON.stringify(V).slice(1,25);var et=!1;W&&typeof V=="string"&&W.test(V)&&(V="'"+V,et=!0);var nt=V.toString().replace(q,K);return(et=et||F===!0||typeof F=="function"&&F(V,it)||Array.isArray(F)&&F[it]||function(dt,Q){for(var _t=0;_t<Q.length;_t++)if(-1<dt.indexOf(Q[_t]))return!0;return!1}(nt,c.BAD_DELIMITERS)||-1<nt.indexOf(U)||nt.charAt(0)===" "||nt.charAt(nt.length-1)===" ")?G+nt+G:nt}}};if(c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!n&&!!i.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=_,c.ParserHandle=E,c.NetworkStreamer=p,c.FileStreamer=g,c.StringStreamer=v,c.ReadableStreamStreamer=b,i.jQuery){var d=i.jQuery;d.fn.parse=function(S){var T=S.config||{},F=[];return this.each(function(H){if(!(d(this).prop("tagName").toUpperCase()==="INPUT"&&d(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var G=0;G<this.files.length;G++)F.push({file:this.files[G],inputElem:this,instanceConfig:d.extend({},T)})}),k(),this;function k(){if(F.length!==0){var H,G,K,Z,B=F[0];if(j(S.before)){var W=S.before(B.file,B.inputElem);if(typeof W=="object"){if(W.action==="abort")return H="AbortError",G=B.file,K=B.inputElem,Z=W.reason,void(j(S.error)&&S.error({name:H},G,K,Z));if(W.action==="skip")return void U();typeof W.config=="object"&&(B.instanceConfig=d.extend(B.instanceConfig,W.config))}else if(W==="skip")return void U()}var q=B.instanceConfig.complete;B.instanceConfig.complete=function(xt){j(q)&&q(xt,B.file,B.inputElem),U()},c.parse(B.file,B.instanceConfig)}else j(S.complete)&&S.complete()}function U(){F.splice(0,1),k()}}}function h(S){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(T){var F=O(T);F.chunkSize=parseInt(F.chunkSize),T.step||T.chunk||(F.chunkSize=null),this._handle=new E(F),(this._handle.streamer=this)._config=F}).call(this,S),this.parseChunk=function(T,F){if(this.isFirstChunk&&j(this._config.beforeFirstChunk)){var k=this._config.beforeFirstChunk(T);k!==void 0&&(T=k)}this.isFirstChunk=!1,this._halted=!1;var U=this._partialLine+T;this._partialLine="";var H=this._handle.parse(U,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var G=H.meta.cursor;this._finished||(this._partialLine=U.substring(G-this._baseIndex),this._baseIndex=G),H&&H.data&&(this._rowCount+=H.data.length);var K=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)i.postMessage({results:H,workerId:c.WORKER_ID,finished:K});else if(j(this._config.chunk)&&!F){if(this._config.chunk(H,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);H=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(H.data),this._completeResults.errors=this._completeResults.errors.concat(H.errors),this._completeResults.meta=H.meta),this._completed||!K||!j(this._config.complete)||H&&H.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),K||H&&H.meta.paused||this._nextChunk(),H}this._halted=!0},this._sendError=function(T){j(this._config.error)?this._config.error(T):s&&this._config.error&&i.postMessage({workerId:c.WORKER_ID,error:T,finished:!1})}}function p(S){var T;(S=S||{}).chunkSize||(S.chunkSize=c.RemoteChunkSize),h.call(this,S),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(F){this._input=F,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(T=new XMLHttpRequest,this._config.withCredentials&&(T.withCredentials=this._config.withCredentials),n||(T.onload=N(this._chunkLoaded,this),T.onerror=N(this._chunkError,this)),T.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var F=this._config.downloadRequestHeaders;for(var k in F)T.setRequestHeader(k,F[k])}if(this._config.chunkSize){var U=this._start+this._config.chunkSize-1;T.setRequestHeader("Range","bytes="+this._start+"-"+U)}try{T.send(this._config.downloadRequestBody)}catch(H){this._chunkError(H.message)}n&&T.status===0&&this._chunkError()}},this._chunkLoaded=function(){T.readyState===4&&(T.status<200||400<=T.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:T.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(F){var k=F.getResponseHeader("Content-Range");return k===null?-1:parseInt(k.substring(k.lastIndexOf("/")+1))}(T),this.parseChunk(T.responseText)))},this._chunkError=function(F){var k=T.statusText||F;this._sendError(new Error(k))}}function g(S){var T,F;(S=S||{}).chunkSize||(S.chunkSize=c.LocalChunkSize),h.call(this,S);var k=typeof FileReader<"u";this.stream=function(U){this._input=U,F=U.slice||U.webkitSlice||U.mozSlice,k?((T=new FileReader).onload=N(this._chunkLoaded,this),T.onerror=N(this._chunkError,this)):T=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var U=this._input;if(this._config.chunkSize){var H=Math.min(this._start+this._config.chunkSize,this._input.size);U=F.call(U,this._start,H)}var G=T.readAsText(U,this._config.encoding);k||this._chunkLoaded({target:{result:G}})},this._chunkLoaded=function(U){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(U.target.result)},this._chunkError=function(){this._sendError(T.error)}}function v(S){var T;h.call(this,S=S||{}),this.stream=function(F){return T=F,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var F,k=this._config.chunkSize;return k?(F=T.substring(0,k),T=T.substring(k)):(F=T,T=""),this._finished=!T,this.parseChunk(F)}}}function b(S){h.call(this,S=S||{});var T=[],F=!0,k=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(U){this._input=U,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){k&&T.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),T.length?this.parseChunk(T.shift()):F=!0},this._streamData=N(function(U){try{T.push(typeof U=="string"?U:U.toString(this._config.encoding)),F&&(F=!1,this._checkIsFinished(),this.parseChunk(T.shift()))}catch(H){this._streamError(H)}},this),this._streamError=N(function(U){this._streamCleanUp(),this._sendError(U)},this),this._streamEnd=N(function(){this._streamCleanUp(),k=!0,this._streamData("")},this),this._streamCleanUp=N(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function E(S){var T,F,k,U=Math.pow(2,53),H=-U,G=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,K=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Z=this,B=0,W=0,q=!1,xt=!1,vt=[],V={data:[],errors:[],meta:{}};if(j(S.step)){var it=S.step;S.step=function(Y){if(V=Y,dt())nt();else{if(nt(),V.data.length===0)return;B+=Y.data.length,S.preview&&B>S.preview?F.abort():(V.data=V.data[0],it(V,Z))}}}function et(Y){return S.skipEmptyLines==="greedy"?Y.join("").trim()==="":Y.length===1&&Y[0].length===0}function nt(){return V&&k&&(_t("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),k=!1),S.skipEmptyLines&&(V.data=V.data.filter(function(Y){return!et(Y)})),dt()&&function(){if(!V)return;function Y(ut,St){j(S.transformHeader)&&(ut=S.transformHeader(ut,St)),vt.push(ut)}if(Array.isArray(V.data[0])){for(var tt=0;dt()&&tt<V.data.length;tt++)V.data[tt].forEach(Y);V.data.splice(0,1)}else V.data.forEach(Y)}(),function(){if(!V||!S.header&&!S.dynamicTyping&&!S.transform)return V;function Y(ut,St){var at,wt=S.header?{}:[];for(at=0;at<ut.length;at++){var gt=at,X=ut[at];S.header&&(gt=at>=vt.length?"__parsed_extra":vt[at]),S.transform&&(X=S.transform(X,gt)),X=Q(gt,X),gt==="__parsed_extra"?(wt[gt]=wt[gt]||[],wt[gt].push(X)):wt[gt]=X}return S.header&&(at>vt.length?_t("FieldMismatch","TooManyFields","Too many fields: expected "+vt.length+" fields but parsed "+at,W+St):at<vt.length&&_t("FieldMismatch","TooFewFields","Too few fields: expected "+vt.length+" fields but parsed "+at,W+St)),wt}var tt=1;return!V.data.length||Array.isArray(V.data[0])?(V.data=V.data.map(Y),tt=V.data.length):V.data=Y(V.data,0),S.header&&V.meta&&(V.meta.fields=vt),W+=tt,V}()}function dt(){return S.header&&vt.length===0}function Q(Y,tt){return ut=Y,S.dynamicTypingFunction&&S.dynamicTyping[ut]===void 0&&(S.dynamicTyping[ut]=S.dynamicTypingFunction(ut)),(S.dynamicTyping[ut]||S.dynamicTyping)===!0?tt==="true"||tt==="TRUE"||tt!=="false"&&tt!=="FALSE"&&(function(St){if(G.test(St)){var at=parseFloat(St);if(H<at&&at<U)return!0}return!1}(tt)?parseFloat(tt):K.test(tt)?new Date(tt):tt===""?null:tt):tt;var ut}function _t(Y,tt,ut,St){var at={type:Y,code:tt,message:ut};St!==void 0&&(at.row=St),V.errors.push(at)}this.parse=function(Y,tt,ut){var St=S.quoteChar||'"';if(S.newline||(S.newline=function(gt,X){gt=gt.substring(0,1048576);var ft=new RegExp(C(X)+"([^]*?)"+C(X),"gm"),Ct=(gt=gt.replace(ft,"")).split("\r"),Nt=gt.split(`
`),Wt=1<Nt.length&&Nt[0].length<Ct[0].length;if(Ct.length===1||Wt)return`
`;for(var Ut=0,Tt=0;Tt<Ct.length;Tt++)Ct[Tt][0]===`
`&&Ut++;return Ut>=Ct.length/2?`\r
`:"\r"}(Y,St)),k=!1,S.delimiter)j(S.delimiter)&&(S.delimiter=S.delimiter(Y),V.meta.delimiter=S.delimiter);else{var at=function(gt,X,ft,Ct,Nt){var Wt,Ut,Tt,Pt;Nt=Nt||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var Ht=0;Ht<Nt.length;Ht++){var ot=Nt[Ht],Ee=0,_e=0,se=0;Tt=void 0;for(var Ye=new _({comments:Ct,delimiter:ot,newline:X,preview:10}).parse(gt),y=0;y<Ye.data.length;y++)if(ft&&et(Ye.data[y]))se++;else{var u=Ye.data[y].length;_e+=u,Tt!==void 0?0<u&&(Ee+=Math.abs(u-Tt),Tt=u):Tt=u}0<Ye.data.length&&(_e/=Ye.data.length-se),(Ut===void 0||Ee<=Ut)&&(Pt===void 0||Pt<_e)&&1.99<_e&&(Ut=Ee,Wt=ot,Pt=_e)}return{successful:!!(S.delimiter=Wt),bestDelimiter:Wt}}(Y,S.newline,S.skipEmptyLines,S.comments,S.delimitersToGuess);at.successful?S.delimiter=at.bestDelimiter:(k=!0,S.delimiter=c.DefaultDelimiter),V.meta.delimiter=S.delimiter}var wt=O(S);return S.preview&&S.header&&wt.preview++,T=Y,F=new _(wt),V=F.parse(T,tt,ut),nt(),q?{meta:{paused:!0}}:V||{meta:{paused:!1}}},this.paused=function(){return q},this.pause=function(){q=!0,F.abort(),T=j(S.chunk)?"":T.substring(F.getCharIndex())},this.resume=function(){Z.streamer._halted?(q=!1,Z.streamer.parseChunk(T,!0)):setTimeout(Z.resume,3)},this.aborted=function(){return xt},this.abort=function(){xt=!0,F.abort(),V.meta.aborted=!0,j(S.complete)&&S.complete(V),T=""}}function C(S){return S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function _(S){var T,F=(S=S||{}).delimiter,k=S.newline,U=S.comments,H=S.step,G=S.preview,K=S.fastMode,Z=T=S.quoteChar===void 0||S.quoteChar===null?'"':S.quoteChar;if(S.escapeChar!==void 0&&(Z=S.escapeChar),(typeof F!="string"||-1<c.BAD_DELIMITERS.indexOf(F))&&(F=","),U===F)throw new Error("Comment character same as delimiter");U===!0?U="#":(typeof U!="string"||-1<c.BAD_DELIMITERS.indexOf(U))&&(U=!1),k!==`
`&&k!=="\r"&&k!==`\r
`&&(k=`
`);var B=0,W=!1;this.parse=function(q,xt,vt){if(typeof q!="string")throw new Error("Input must be a string");var V=q.length,it=F.length,et=k.length,nt=U.length,dt=j(H),Q=[],_t=[],Y=[],tt=B=0;if(!q)return f();if(S.header&&!xt){var ut=q.split(k)[0].split(F),St=[],at={},wt=!1;for(var gt in ut){var X=ut[gt];j(S.transformHeader)&&(X=S.transformHeader(X,gt));var ft=X,Ct=at[X]||0;for(0<Ct&&(wt=!0,ft=X+"_"+Ct),at[X]=Ct+1;St.includes(ft);)ft=ft+"_"+Ct;St.push(ft)}if(wt){var Nt=q.split(k);Nt[0]=St.join(F),q=Nt.join(k)}}if(K||K!==!1&&q.indexOf(T)===-1){for(var Wt=q.split(k),Ut=0;Ut<Wt.length;Ut++){if(Y=Wt[Ut],B+=Y.length,Ut!==Wt.length-1)B+=k.length;else if(vt)return f();if(!U||Y.substring(0,nt)!==U){if(dt){if(Q=[],se(Y.split(F)),x(),W)return f()}else se(Y.split(F));if(G&&G<=Ut)return Q=Q.slice(0,G),f(!0)}}return f()}for(var Tt=q.indexOf(F,B),Pt=q.indexOf(k,B),Ht=new RegExp(C(Z)+C(T),"g"),ot=q.indexOf(T,B);;)if(q[B]!==T)if(U&&Y.length===0&&q.substring(B,B+nt)===U){if(Pt===-1)return f();B=Pt+et,Pt=q.indexOf(k,B),Tt=q.indexOf(F,B)}else if(Tt!==-1&&(Tt<Pt||Pt===-1))Y.push(q.substring(B,Tt)),B=Tt+it,Tt=q.indexOf(F,B);else{if(Pt===-1)break;if(Y.push(q.substring(B,Pt)),u(Pt+et),dt&&(x(),W))return f();if(G&&Q.length>=G)return f(!0)}else for(ot=B,B++;;){if((ot=q.indexOf(T,ot+1))===-1)return vt||_t.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Q.length,index:B}),y();if(ot===V-1)return y(q.substring(B,ot).replace(Ht,T));if(T!==Z||q[ot+1]!==Z){if(T===Z||ot===0||q[ot-1]!==Z){Tt!==-1&&Tt<ot+1&&(Tt=q.indexOf(F,ot+1)),Pt!==-1&&Pt<ot+1&&(Pt=q.indexOf(k,ot+1));var Ee=Ye(Pt===-1?Tt:Math.min(Tt,Pt));if(q.substr(ot+1+Ee,it)===F){Y.push(q.substring(B,ot).replace(Ht,T)),q[B=ot+1+Ee+it]!==T&&(ot=q.indexOf(T,B)),Tt=q.indexOf(F,B),Pt=q.indexOf(k,B);break}var _e=Ye(Pt);if(q.substring(ot+1+_e,ot+1+_e+et)===k){if(Y.push(q.substring(B,ot).replace(Ht,T)),u(ot+1+_e+et),Tt=q.indexOf(F,B),ot=q.indexOf(T,B),dt&&(x(),W))return f();if(G&&Q.length>=G)return f(!0);break}_t.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Q.length,index:B}),ot++}}else ot++}return y();function se(P){Q.push(P),tt=B}function Ye(P){var M=0;if(P!==-1){var $=q.substring(ot+1,P);$&&$.trim()===""&&(M=$.length)}return M}function y(P){return vt||(P===void 0&&(P=q.substring(B)),Y.push(P),B=V,se(Y),dt&&x()),f()}function u(P){B=P,se(Y),Y=[],Pt=q.indexOf(k,B)}function f(P){return{data:Q,errors:_t,meta:{delimiter:F,linebreak:k,aborted:W,truncated:!!P,cursor:tt+(xt||0)}}}function x(){H(f()),Q=[],_t=[]}},this.abort=function(){W=!0},this.getCharIndex=function(){return B}}function R(S){var T=S.data,F=a[T.workerId],k=!1;if(T.error)F.userError(T.error,T.file);else if(T.results&&T.results.data){var U={abort:function(){k=!0,L(T.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:D,resume:D};if(j(F.userStep)){for(var H=0;H<T.results.data.length&&(F.userStep({data:T.results.data[H],errors:T.results.errors,meta:T.results.meta},U),!k);H++);delete T.results}else j(F.userChunk)&&(F.userChunk(T.results,U,T.file),delete T.results)}T.finished&&!k&&L(T.workerId,T.results)}function L(S,T){var F=a[S];j(F.userComplete)&&F.userComplete(T),F.terminate(),delete a[S]}function D(){throw new Error("Not implemented.")}function O(S){if(typeof S!="object"||S===null)return S;var T=Array.isArray(S)?[]:{};for(var F in S)T[F]=O(S[F]);return T}function N(S,T){return function(){S.apply(T,arguments)}}function j(S){return typeof S=="function"}return s&&(i.onmessage=function(S){var T=S.data;if(c.WORKER_ID===void 0&&T&&(c.WORKER_ID=T.workerId),typeof T.input=="string")i.postMessage({workerId:c.WORKER_ID,results:c.parse(T.input,T.config),finished:!0});else if(i.File&&T.input instanceof File||T.input instanceof Object){var F=c.parse(T.input,T.config);F&&i.postMessage({workerId:c.WORKER_ID,results:F,finished:!0})}}),(p.prototype=Object.create(h.prototype)).constructor=p,(g.prototype=Object.create(h.prototype)).constructor=g,(v.prototype=Object.create(v.prototype)).constructor=v,(b.prototype=Object.create(h.prototype)).constructor=b,c})})(Iy);var mL=Iy.exports;const vL=Dg(mL),Th=({mainState:{currentDocument:r,config:t}})=>{const[e,i]=z.useState([]);return z.useEffect(()=>{var n;if(r!=null&&r.fileData){const s=vL.parse(r.fileData,{delimiter:(t==null?void 0:t.csvDelimiter)??","});!((n=s.errors)!=null&&n.length)&&s.data&&i(s.data)}},[r,t==null?void 0:t.csvDelimiter]),e.length?I.jsx(bL,{children:I.jsxs(yL,{children:[I.jsx("thead",{children:I.jsx("tr",{children:e[0].map(n=>I.jsx("th",{children:n},n))})}),I.jsx("tbody",{children:e.slice(1,e.length).map(n=>I.jsx("tr",{children:n.map(s=>I.jsx("td",{children:s},s))},n.join("")))})]})}):null};Th.fileTypes=["csv","text/csv"];Th.weight=0;Th.fileLoader=Xg;const bL=ht.div`
  width: 100%;
`,yL=ht.table`
  width: 100%;
  text-align: left;

  th,
  td {
    padding: 5px 10px;

    &:empty {
      display: none;
    }
  }
`,Lf=r=>I.jsx(Ln,{...r});Lf.fileTypes=["gif","image/gif"];Lf.weight=0;const kf=({mainState:{currentDocument:r}})=>r?I.jsx(wL,{id:"video-renderer",children:I.jsx(AL,{controls:!0,src:r.uri})}):null;kf.fileTypes=["video/mp4","video/quicktime","video/x-msvideo"];kf.weight=0;const wL=ht.div`
  width: 100%;
`,AL=ht.video`
  width: 100%;
  height: 100%;
  border: 0;
`,If=r=>I.jsx(Ln,{...r});If.fileTypes=["webp","image/webp"];If.weight=0;const Fy=[hf,bh,df,yh,Pf,Rf,Sh,Ch,Th,Lf,kf,If],EL=z.forwardRef((r,t)=>{const{documents:e,theme:i}=r;if(!e)throw new Error("Please provide an array of documents to DocViewer!");return I.jsx(Fx,{ref:t,pluginRenderers:Fy,...r,children:I.jsx(ht.ThemeProvider,{theme:i?{...Om,...i}:Om,children:I.jsxs(xL,{id:"react-doc-viewer","data-testid":"react-doc-viewer",className:r.className,style:r.style,children:[I.jsx(oS,{}),I.jsx(pS,{})]})})})}),_L=z.memo(EL),xL=ht.div`
  display: flex;
  flex-direction: column;
  background: #ffffff;
  width: 100%;
  height: 100%;
`;exports.BMPRenderer=hf;exports.Buffer=md;exports.CSVRenderer=Th;exports.DocViewer=_L;exports.DocViewerRenderers=Fy;exports.HTMLRenderer=bh;exports.JPGRenderer=df;exports.JPGRenderer$1=Lf;exports.MSDocRenderer=yh;exports.PDFRenderer=Pf;exports.PNGRenderer=Rf;exports.TIFFRenderer=Sh;exports.TXTRenderer=Ch;exports.VideoRenderer=kf;exports.WebPRenderer=If;exports.arrayBufferFileLoader=sv;exports.binaryStringFileLoader=cS;exports.commonjsGlobal=Xr;exports.dataURLFileLoader=qg;exports.defaultFileLoader=rv;exports.dist=tC;exports.getAugmentedNamespace=Oy;exports.getDefaultExportFromCjs=Dg;exports.process$1=Ki;exports.supportedLanguages=Px;exports.textFileLoader=Xg;
